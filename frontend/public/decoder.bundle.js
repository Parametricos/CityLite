(()=>{var __webpack_modules__={3187:function(e,t,r){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,r,i){void 0===i&&(i=r),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,i){void 0===i&&(i=r),e[i]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||i(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),n(r(4482),t),n(r(8937),t),n(r(7828),t),n(r(8212),t),n(r(172),t),n(r(6792),t),n(r(7487),t),n(r(2904),t),n(r(7299),t),n(r(2525),t),n(r(5253),t),n(r(7954),t),n(r(1460),t),n(r(84),t),n(r(7187),t),n(r(6665),t),n(r(8648),t),n(r(8783),t)},3139:function(e,t,r){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,r,i){void 0===i&&(i=r),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,i){void 0===i&&(i=r),e[i]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||i(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),n(r(2931),t),n(r(1754),t),n(r(7466),t),n(r(7073),t),n(r(6233),t),n(r(2553),t),n(r(2779),t),n(r(6373),t),n(r(9881),t),n(r(120),t),n(r(7746),t),n(r(8816),t),n(r(1404),t),n(r(115),t),n(r(8457),t),n(r(8053),t),n(r(4955),t),n(r(4276),t),n(r(730),t),n(r(5707),t),n(r(6368),t),n(r(20),t),n(r(3465),t),n(r(7511),t),n(r(1914),t),n(r(7821),t),n(r(1555),t),n(r(1498),t),n(r(8836),t),n(r(5644),t),n(r(4222),t),n(r(8909),t),n(r(2076),t),n(r(6256),t),n(r(463),t),n(r(8703),t)},249:function(e,t,r){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,r,i){void 0===i&&(i=r),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,i){void 0===i&&(i=r),e[i]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||i(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),n(r(6155),t),n(r(8655),t),n(r(1314),t),n(r(1274),t)},284:function(e,t,r){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,r,i){void 0===i&&(i=r),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,i){void 0===i&&(i=r),e[i]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||i(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),n(r(963),t),n(r(5083),t),n(r(3255),t),n(r(7833),t),n(r(5656),t),n(r(5172),t),n(r(884),t),n(r(2343),t),n(r(5930),t),n(r(8136),t),n(r(5722),t),n(r(8682),t),n(r(3993),t),n(r(5421),t),n(r(1420),t),n(r(7355),t),n(r(1703),t),n(r(9930),t)},3333:function(e,t,r){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,r,i){void 0===i&&(i=r),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,i){void 0===i&&(i=r),e[i]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||i(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),n(r(9826),t),n(r(1060),t)},4417:(e,t,r)=>{"use strict";var i,n,o,s=r(3737),a=s.Reader,l=s.util,u=s.roots.default||(s.roots.default={});u.com=((o={}).mapbox=((n={}).pb=((i={}).Tile=function(){function e(e){if(this.layers=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}var t,r;return e.prototype.layers=l.emptyArray,e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new u.com.mapbox.pb.Tile;e.pos<r;){var n=e.uint32();switch(n>>>3){case 3:i.layers&&i.layers.length||(i.layers=[]),i.layers.push(u.com.mapbox.pb.Tile.Layer.decode(e,e.uint32()));break;default:e.skipType(7&n)}}return i},e.decodeDelimited=function(e){return e instanceof a||(e=new a(e)),this.decode(e,e.uint32())},e.fromObject=function(e){if(e instanceof u.com.mapbox.pb.Tile)return e;var t=new u.com.mapbox.pb.Tile;if(e.layers){if(!Array.isArray(e.layers))throw TypeError(".com.mapbox.pb.Tile.layers: array expected");t.layers=[];for(var r=0;r<e.layers.length;++r){if("object"!=typeof e.layers[r])throw TypeError(".com.mapbox.pb.Tile.layers: object expected");t.layers[r]=u.com.mapbox.pb.Tile.Layer.fromObject(e.layers[r])}}return t},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.layers=[]),e.layers&&e.layers.length){r.layers=[];for(var i=0;i<e.layers.length;++i)r.layers[i]=u.com.mapbox.pb.Tile.Layer.toObject(e.layers[i],t)}return r},e.prototype.toJSON=function(){return this.constructor.toObject(this,s.util.toJSONOptions)},e.GeomType=(t={},(r=Object.create(t))[t[0]="UNKNOWN"]=0,r[t[1]="POINT"]=1,r[t[2]="LINESTRING"]=2,r[t[3]="POLYGON"]=3,r),e.Value=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.stringValue="",e.prototype.floatValue=0,e.prototype.doubleValue=0,e.prototype.intValue=l.Long?l.Long.fromBits(0,0,!1):0,e.prototype.uintValue=l.Long?l.Long.fromBits(0,0,!0):0,e.prototype.sintValue=l.Long?l.Long.fromBits(0,0,!1):0,e.prototype.boolValue=!1,e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new u.com.mapbox.pb.Tile.Value;e.pos<r;){var n=e.uint32();switch(n>>>3){case 1:i.stringValue=e.string();break;case 2:i.floatValue=e.float();break;case 3:i.doubleValue=e.double();break;case 4:i.intValue=e.int64();break;case 5:i.uintValue=e.uint64();break;case 6:i.sintValue=e.sint64();break;case 7:i.boolValue=e.bool();break;default:e.skipType(7&n)}}return i},e.decodeDelimited=function(e){return e instanceof a||(e=new a(e)),this.decode(e,e.uint32())},e.fromObject=function(e){if(e instanceof u.com.mapbox.pb.Tile.Value)return e;var t=new u.com.mapbox.pb.Tile.Value;return null!=e.stringValue&&(t.stringValue=String(e.stringValue)),null!=e.floatValue&&(t.floatValue=Number(e.floatValue)),null!=e.doubleValue&&(t.doubleValue=Number(e.doubleValue)),null!=e.intValue&&(l.Long?(t.intValue=l.Long.fromValue(e.intValue)).unsigned=!1:"string"==typeof e.intValue?t.intValue=parseInt(e.intValue,10):"number"==typeof e.intValue?t.intValue=e.intValue:"object"==typeof e.intValue&&(t.intValue=new l.LongBits(e.intValue.low>>>0,e.intValue.high>>>0).toNumber())),null!=e.uintValue&&(l.Long?(t.uintValue=l.Long.fromValue(e.uintValue)).unsigned=!0:"string"==typeof e.uintValue?t.uintValue=parseInt(e.uintValue,10):"number"==typeof e.uintValue?t.uintValue=e.uintValue:"object"==typeof e.uintValue&&(t.uintValue=new l.LongBits(e.uintValue.low>>>0,e.uintValue.high>>>0).toNumber(!0))),null!=e.sintValue&&(l.Long?(t.sintValue=l.Long.fromValue(e.sintValue)).unsigned=!1:"string"==typeof e.sintValue?t.sintValue=parseInt(e.sintValue,10):"number"==typeof e.sintValue?t.sintValue=e.sintValue:"object"==typeof e.sintValue&&(t.sintValue=new l.LongBits(e.sintValue.low>>>0,e.sintValue.high>>>0).toNumber())),null!=e.boolValue&&(t.boolValue=Boolean(e.boolValue)),t},e.toObject=function(e,t){t||(t={});var r={};if(t.defaults){if(r.stringValue="",r.floatValue=0,r.doubleValue=0,l.Long){var i=new l.Long(0,0,!1);r.intValue=t.longs===String?i.toString():t.longs===Number?i.toNumber():i}else r.intValue=t.longs===String?"0":0;l.Long?(i=new l.Long(0,0,!0),r.uintValue=t.longs===String?i.toString():t.longs===Number?i.toNumber():i):r.uintValue=t.longs===String?"0":0,l.Long?(i=new l.Long(0,0,!1),r.sintValue=t.longs===String?i.toString():t.longs===Number?i.toNumber():i):r.sintValue=t.longs===String?"0":0,r.boolValue=!1}return null!=e.stringValue&&e.hasOwnProperty("stringValue")&&(r.stringValue=e.stringValue),null!=e.floatValue&&e.hasOwnProperty("floatValue")&&(r.floatValue=t.json&&!isFinite(e.floatValue)?String(e.floatValue):e.floatValue),null!=e.doubleValue&&e.hasOwnProperty("doubleValue")&&(r.doubleValue=t.json&&!isFinite(e.doubleValue)?String(e.doubleValue):e.doubleValue),null!=e.intValue&&e.hasOwnProperty("intValue")&&("number"==typeof e.intValue?r.intValue=t.longs===String?String(e.intValue):e.intValue:r.intValue=t.longs===String?l.Long.prototype.toString.call(e.intValue):t.longs===Number?new l.LongBits(e.intValue.low>>>0,e.intValue.high>>>0).toNumber():e.intValue),null!=e.uintValue&&e.hasOwnProperty("uintValue")&&("number"==typeof e.uintValue?r.uintValue=t.longs===String?String(e.uintValue):e.uintValue:r.uintValue=t.longs===String?l.Long.prototype.toString.call(e.uintValue):t.longs===Number?new l.LongBits(e.uintValue.low>>>0,e.uintValue.high>>>0).toNumber(!0):e.uintValue),null!=e.sintValue&&e.hasOwnProperty("sintValue")&&("number"==typeof e.sintValue?r.sintValue=t.longs===String?String(e.sintValue):e.sintValue:r.sintValue=t.longs===String?l.Long.prototype.toString.call(e.sintValue):t.longs===Number?new l.LongBits(e.sintValue.low>>>0,e.sintValue.high>>>0).toNumber():e.sintValue),null!=e.boolValue&&e.hasOwnProperty("boolValue")&&(r.boolValue=e.boolValue),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,s.util.toJSONOptions)},e}(),e.Feature=function(){function e(e){if(this.tags=[],this.geometry=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.id=l.Long?l.Long.fromBits(0,0,!0):0,e.prototype.tags=l.emptyArray,e.prototype.type=0,e.prototype.geometry=l.emptyArray,e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new u.com.mapbox.pb.Tile.Feature;e.pos<r;){var n=e.uint32();switch(n>>>3){case 1:i.id=e.uint64();break;case 2:if(i.tags&&i.tags.length||(i.tags=[]),2==(7&n))for(var o=e.uint32()+e.pos;e.pos<o;)i.tags.push(e.uint32());else i.tags.push(e.uint32());break;case 3:i.type=e.int32();break;case 4:if(i.geometry&&i.geometry.length||(i.geometry=[]),2==(7&n))for(o=e.uint32()+e.pos;e.pos<o;)i.geometry.push(e.uint32());else i.geometry.push(e.uint32());break;default:e.skipType(7&n)}}return i},e.decodeDelimited=function(e){return e instanceof a||(e=new a(e)),this.decode(e,e.uint32())},e.fromObject=function(e){if(e instanceof u.com.mapbox.pb.Tile.Feature)return e;var t=new u.com.mapbox.pb.Tile.Feature;if(null!=e.id&&(l.Long?(t.id=l.Long.fromValue(e.id)).unsigned=!0:"string"==typeof e.id?t.id=parseInt(e.id,10):"number"==typeof e.id?t.id=e.id:"object"==typeof e.id&&(t.id=new l.LongBits(e.id.low>>>0,e.id.high>>>0).toNumber(!0))),e.tags){if(!Array.isArray(e.tags))throw TypeError(".com.mapbox.pb.Tile.Feature.tags: array expected");t.tags=[];for(var r=0;r<e.tags.length;++r)t.tags[r]=e.tags[r]>>>0}switch(e.type){case"UNKNOWN":case 0:t.type=0;break;case"POINT":case 1:t.type=1;break;case"LINESTRING":case 2:t.type=2;break;case"POLYGON":case 3:t.type=3}if(e.geometry){if(!Array.isArray(e.geometry))throw TypeError(".com.mapbox.pb.Tile.Feature.geometry: array expected");for(t.geometry=[],r=0;r<e.geometry.length;++r)t.geometry[r]=e.geometry[r]>>>0}return t},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.tags=[],r.geometry=[]),t.defaults){if(l.Long){var i=new l.Long(0,0,!0);r.id=t.longs===String?i.toString():t.longs===Number?i.toNumber():i}else r.id=t.longs===String?"0":0;r.type=t.enums===String?"UNKNOWN":0}if(null!=e.id&&e.hasOwnProperty("id")&&("number"==typeof e.id?r.id=t.longs===String?String(e.id):e.id:r.id=t.longs===String?l.Long.prototype.toString.call(e.id):t.longs===Number?new l.LongBits(e.id.low>>>0,e.id.high>>>0).toNumber(!0):e.id),e.tags&&e.tags.length){r.tags=[];for(var n=0;n<e.tags.length;++n)r.tags[n]=e.tags[n]}if(null!=e.type&&e.hasOwnProperty("type")&&(r.type=t.enums===String?u.com.mapbox.pb.Tile.GeomType[e.type]:e.type),e.geometry&&e.geometry.length)for(r.geometry=[],n=0;n<e.geometry.length;++n)r.geometry[n]=e.geometry[n];return r},e.prototype.toJSON=function(){return this.constructor.toObject(this,s.util.toJSONOptions)},e}(),e.Layer=function(){function e(e){if(this.features=[],this.keys=[],this.values=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.version=1,e.prototype.name="",e.prototype.features=l.emptyArray,e.prototype.keys=l.emptyArray,e.prototype.values=l.emptyArray,e.prototype.extent=4096,e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new u.com.mapbox.pb.Tile.Layer;e.pos<r;){var n=e.uint32();switch(n>>>3){case 15:i.version=e.uint32();break;case 1:i.name=e.string();break;case 2:i.features&&i.features.length||(i.features=[]),i.features.push(u.com.mapbox.pb.Tile.Feature.decode(e,e.uint32()));break;case 3:i.keys&&i.keys.length||(i.keys=[]),i.keys.push(e.string());break;case 4:i.values&&i.values.length||(i.values=[]),i.values.push(u.com.mapbox.pb.Tile.Value.decode(e,e.uint32()));break;case 5:i.extent=e.uint32();break;default:e.skipType(7&n)}}if(!i.hasOwnProperty("version"))throw l.ProtocolError("missing required 'version'",{instance:i});if(!i.hasOwnProperty("name"))throw l.ProtocolError("missing required 'name'",{instance:i});return i},e.decodeDelimited=function(e){return e instanceof a||(e=new a(e)),this.decode(e,e.uint32())},e.fromObject=function(e){if(e instanceof u.com.mapbox.pb.Tile.Layer)return e;var t=new u.com.mapbox.pb.Tile.Layer;if(null!=e.version&&(t.version=e.version>>>0),null!=e.name&&(t.name=String(e.name)),e.features){if(!Array.isArray(e.features))throw TypeError(".com.mapbox.pb.Tile.Layer.features: array expected");t.features=[];for(var r=0;r<e.features.length;++r){if("object"!=typeof e.features[r])throw TypeError(".com.mapbox.pb.Tile.Layer.features: object expected");t.features[r]=u.com.mapbox.pb.Tile.Feature.fromObject(e.features[r])}}if(e.keys){if(!Array.isArray(e.keys))throw TypeError(".com.mapbox.pb.Tile.Layer.keys: array expected");for(t.keys=[],r=0;r<e.keys.length;++r)t.keys[r]=String(e.keys[r])}if(e.values){if(!Array.isArray(e.values))throw TypeError(".com.mapbox.pb.Tile.Layer.values: array expected");for(t.values=[],r=0;r<e.values.length;++r){if("object"!=typeof e.values[r])throw TypeError(".com.mapbox.pb.Tile.Layer.values: object expected");t.values[r]=u.com.mapbox.pb.Tile.Value.fromObject(e.values[r])}}return null!=e.extent&&(t.extent=e.extent>>>0),t},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.features=[],r.keys=[],r.values=[]),t.defaults&&(r.name="",r.extent=4096,r.version=1),null!=e.name&&e.hasOwnProperty("name")&&(r.name=e.name),e.features&&e.features.length){r.features=[];for(var i=0;i<e.features.length;++i)r.features[i]=u.com.mapbox.pb.Tile.Feature.toObject(e.features[i],t)}if(e.keys&&e.keys.length)for(r.keys=[],i=0;i<e.keys.length;++i)r.keys[i]=e.keys[i];if(e.values&&e.values.length)for(r.values=[],i=0;i<e.values.length;++i)r.values[i]=u.com.mapbox.pb.Tile.Value.toObject(e.values[i],t);return null!=e.extent&&e.hasOwnProperty("extent")&&(r.extent=e.extent),null!=e.version&&e.hasOwnProperty("version")&&(r.version=e.version),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,s.util.toJSONOptions)},e}(),e}(),i),n),o),e.exports=u},6781:e=>{"use strict";e.exports=function(e,t){for(var r=new Array(arguments.length-1),i=0,n=2,o=!0;n<arguments.length;)r[i++]=arguments[n++];return new Promise((function(n,s){r[i]=function(e){if(o)if(o=!1,e)s(e);else{for(var t=new Array(arguments.length-1),r=0;r<t.length;)t[r++]=arguments[r];n.apply(null,t)}};try{e.apply(t||null,r)}catch(e){o&&(o=!1,s(e))}}))}},7026:(e,t)=>{"use strict";var r=t;r.length=function(e){var t=e.length;if(!t)return 0;for(var r=0;--t%4>1&&"="===e.charAt(t);)++r;return Math.ceil(3*e.length)/4-r};for(var i=new Array(64),n=new Array(123),o=0;o<64;)n[i[o]=o<26?o+65:o<52?o+71:o<62?o-4:o-59|43]=o++;r.encode=function(e,t,r){for(var n,o=null,s=[],a=0,l=0;t<r;){var u=e[t++];switch(l){case 0:s[a++]=i[u>>2],n=(3&u)<<4,l=1;break;case 1:s[a++]=i[n|u>>4],n=(15&u)<<2,l=2;break;case 2:s[a++]=i[n|u>>6],s[a++]=i[63&u],l=0}a>8191&&((o||(o=[])).push(String.fromCharCode.apply(String,s)),a=0)}return l&&(s[a++]=i[n],s[a++]=61,1===l&&(s[a++]=61)),o?(a&&o.push(String.fromCharCode.apply(String,s.slice(0,a))),o.join("")):String.fromCharCode.apply(String,s.slice(0,a))};var s="invalid encoding";r.decode=function(e,t,r){for(var i,o=r,a=0,l=0;l<e.length;){var u=e.charCodeAt(l++);if(61===u&&a>1)break;if(void 0===(u=n[u]))throw Error(s);switch(a){case 0:i=u,a=1;break;case 1:t[r++]=i<<2|(48&u)>>4,i=u,a=2;break;case 2:t[r++]=(15&i)<<4|(60&u)>>2,i=u,a=3;break;case 3:t[r++]=(3&i)<<6|u,a=0}}if(1===a)throw Error(s);return r-o},r.test=function(e){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)}},5570:e=>{"use strict";function t(){this._listeners={}}e.exports=t,t.prototype.on=function(e,t,r){return(this._listeners[e]||(this._listeners[e]=[])).push({fn:t,ctx:r||this}),this},t.prototype.off=function(e,t){if(void 0===e)this._listeners={};else if(void 0===t)this._listeners[e]=[];else for(var r=this._listeners[e],i=0;i<r.length;)r[i].fn===t?r.splice(i,1):++i;return this},t.prototype.emit=function(e){var t=this._listeners[e];if(t){for(var r=[],i=1;i<arguments.length;)r.push(arguments[i++]);for(i=0;i<t.length;)t[i].fn.apply(t[i++].ctx,r)}return this}},5298:e=>{"use strict";function t(e){return"undefined"!=typeof Float32Array?function(){var t=new Float32Array([-0]),r=new Uint8Array(t.buffer),i=128===r[3];function n(e,i,n){t[0]=e,i[n]=r[0],i[n+1]=r[1],i[n+2]=r[2],i[n+3]=r[3]}function o(e,i,n){t[0]=e,i[n]=r[3],i[n+1]=r[2],i[n+2]=r[1],i[n+3]=r[0]}function s(e,i){return r[0]=e[i],r[1]=e[i+1],r[2]=e[i+2],r[3]=e[i+3],t[0]}function a(e,i){return r[3]=e[i],r[2]=e[i+1],r[1]=e[i+2],r[0]=e[i+3],t[0]}e.writeFloatLE=i?n:o,e.writeFloatBE=i?o:n,e.readFloatLE=i?s:a,e.readFloatBE=i?a:s}():function(){function t(e,t,r,i){var n=t<0?1:0;if(n&&(t=-t),0===t)e(1/t>0?0:2147483648,r,i);else if(isNaN(t))e(2143289344,r,i);else if(t>34028234663852886e22)e((n<<31|2139095040)>>>0,r,i);else if(t<11754943508222875e-54)e((n<<31|Math.round(t/1401298464324817e-60))>>>0,r,i);else{var o=Math.floor(Math.log(t)/Math.LN2);e((n<<31|o+127<<23|8388607&Math.round(t*Math.pow(2,-o)*8388608))>>>0,r,i)}}function s(e,t,r){var i=e(t,r),n=2*(i>>31)+1,o=i>>>23&255,s=8388607&i;return 255===o?s?NaN:n*(1/0):0===o?1401298464324817e-60*n*s:n*Math.pow(2,o-150)*(s+8388608)}e.writeFloatLE=t.bind(null,r),e.writeFloatBE=t.bind(null,i),e.readFloatLE=s.bind(null,n),e.readFloatBE=s.bind(null,o)}(),"undefined"!=typeof Float64Array?function(){var t=new Float64Array([-0]),r=new Uint8Array(t.buffer),i=128===r[7];function n(e,i,n){t[0]=e,i[n]=r[0],i[n+1]=r[1],i[n+2]=r[2],i[n+3]=r[3],i[n+4]=r[4],i[n+5]=r[5],i[n+6]=r[6],i[n+7]=r[7]}function o(e,i,n){t[0]=e,i[n]=r[7],i[n+1]=r[6],i[n+2]=r[5],i[n+3]=r[4],i[n+4]=r[3],i[n+5]=r[2],i[n+6]=r[1],i[n+7]=r[0]}function s(e,i){return r[0]=e[i],r[1]=e[i+1],r[2]=e[i+2],r[3]=e[i+3],r[4]=e[i+4],r[5]=e[i+5],r[6]=e[i+6],r[7]=e[i+7],t[0]}function a(e,i){return r[7]=e[i],r[6]=e[i+1],r[5]=e[i+2],r[4]=e[i+3],r[3]=e[i+4],r[2]=e[i+5],r[1]=e[i+6],r[0]=e[i+7],t[0]}e.writeDoubleLE=i?n:o,e.writeDoubleBE=i?o:n,e.readDoubleLE=i?s:a,e.readDoubleBE=i?a:s}():function(){function t(e,t,r,i,n,o){var s=i<0?1:0;if(s&&(i=-i),0===i)e(0,n,o+t),e(1/i>0?0:2147483648,n,o+r);else if(isNaN(i))e(0,n,o+t),e(2146959360,n,o+r);else if(i>17976931348623157e292)e(0,n,o+t),e((s<<31|2146435072)>>>0,n,o+r);else{var a;if(i<22250738585072014e-324)e((a=i/5e-324)>>>0,n,o+t),e((s<<31|a/4294967296)>>>0,n,o+r);else{var l=Math.floor(Math.log(i)/Math.LN2);1024===l&&(l=1023),e(4503599627370496*(a=i*Math.pow(2,-l))>>>0,n,o+t),e((s<<31|l+1023<<20|1048576*a&1048575)>>>0,n,o+r)}}}function s(e,t,r,i,n){var o=e(i,n+t),s=e(i,n+r),a=2*(s>>31)+1,l=s>>>20&2047,u=4294967296*(1048575&s)+o;return 2047===l?u?NaN:a*(1/0):0===l?5e-324*a*u:a*Math.pow(2,l-1075)*(u+4503599627370496)}e.writeDoubleLE=t.bind(null,r,0,4),e.writeDoubleBE=t.bind(null,i,4,0),e.readDoubleLE=s.bind(null,n,0,4),e.readDoubleBE=s.bind(null,o,4,0)}(),e}function r(e,t,r){t[r]=255&e,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24}function i(e,t,r){t[r]=e>>>24,t[r+1]=e>>>16&255,t[r+2]=e>>>8&255,t[r+3]=255&e}function n(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24)>>>0}function o(e,t){return(e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3])>>>0}e.exports=t(t)},6116:module=>{"use strict";function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(e){}return null}module.exports=inquire},804:e=>{"use strict";e.exports=function(e,t,r){var i=r||8192,n=i>>>1,o=null,s=i;return function(r){if(r<1||r>n)return e(r);s+r>i&&(o=e(i),s=0);var a=t.call(o,s,s+=r);return 7&s&&(s=1+(7|s)),a}}},7958:(e,t)=>{"use strict";var r=t;r.length=function(e){for(var t=0,r=0,i=0;i<e.length;++i)(r=e.charCodeAt(i))<128?t+=1:r<2048?t+=2:55296==(64512&r)&&56320==(64512&e.charCodeAt(i+1))?(++i,t+=4):t+=3;return t},r.read=function(e,t,r){if(r-t<1)return"";for(var i,n=null,o=[],s=0;t<r;)(i=e[t++])<128?o[s++]=i:i>191&&i<224?o[s++]=(31&i)<<6|63&e[t++]:i>239&&i<365?(i=((7&i)<<18|(63&e[t++])<<12|(63&e[t++])<<6|63&e[t++])-65536,o[s++]=55296+(i>>10),o[s++]=56320+(1023&i)):o[s++]=(15&i)<<12|(63&e[t++])<<6|63&e[t++],s>8191&&((n||(n=[])).push(String.fromCharCode.apply(String,o)),s=0);return n?(s&&n.push(String.fromCharCode.apply(String,o.slice(0,s))),n.join("")):String.fromCharCode.apply(String,o.slice(0,s))},r.write=function(e,t,r){for(var i,n,o=r,s=0;s<e.length;++s)(i=e.charCodeAt(s))<128?t[r++]=i:i<2048?(t[r++]=i>>6|192,t[r++]=63&i|128):55296==(64512&i)&&56320==(64512&(n=e.charCodeAt(s+1)))?(i=65536+((1023&i)<<10)+(1023&n),++s,t[r++]=i>>18|240,t[r++]=i>>12&63|128,t[r++]=i>>6&63|128,t[r++]=63&i|128):(t[r++]=i>>12|224,t[r++]=i>>6&63|128,t[r++]=63&i|128);return r-o}},2058:(e,t)=>{var r={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function i(e){return(e=Math.round(e))<0?0:e>255?255:e}function n(e){return e<0?0:e>1?1:e}function o(e){return"%"===e[e.length-1]?i(parseFloat(e)/100*255):i(parseInt(e))}function s(e){return"%"===e[e.length-1]?n(parseFloat(e)/100):n(parseFloat(e))}function a(e,t,r){return r<0?r+=1:r>1&&(r-=1),6*r<1?e+(t-e)*r*6:2*r<1?t:3*r<2?e+(t-e)*(2/3-r)*6:e}try{t.parseCSSColor=function(e){var t,n=e.replace(/ /g,"").toLowerCase();if(n in r)return r[n].slice();if("#"===n[0])return 4===n.length?(t=parseInt(n.substr(1),16))>=0&&t<=4095?[(3840&t)>>4|(3840&t)>>8,240&t|(240&t)>>4,15&t|(15&t)<<4,1]:null:7===n.length&&(t=parseInt(n.substr(1),16))>=0&&t<=16777215?[(16711680&t)>>16,(65280&t)>>8,255&t,1]:null;var l=n.indexOf("("),u=n.indexOf(")");if(-1!==l&&u+1===n.length){var c=n.substr(0,l),h=n.substr(l+1,u-(l+1)).split(","),d=1;switch(c){case"rgba":if(4!==h.length)return null;d=s(h.pop());case"rgb":return 3!==h.length?null:[o(h[0]),o(h[1]),o(h[2]),d];case"hsla":if(4!==h.length)return null;d=s(h.pop());case"hsl":if(3!==h.length)return null;var f=(parseFloat(h[0])%360+360)%360/360,p=s(h[1]),m=s(h[2]),g=m<=.5?m*(p+1):m+p-m*p,v=2*m-g;return[i(255*a(v,g,f+1/3)),i(255*a(v,g,f)),i(255*a(v,g,f-1/3)),d];default:return null}}return null}}catch(e){}},9502:e=>{"use strict";function t(e,t,o){o=o||2;var s,a,l,h,d,p,m,g=t&&t.length,v=g?t[0]*o:e.length,y=r(e,0,v,o,!0),x=[];if(!y||y.next===y.prev)return x;if(g&&(y=function(e,t,n,o){var s,a,l,h=[];for(s=0,a=t.length;s<a;s++)(l=r(e,t[s]*o,s<a-1?t[s+1]*o:e.length,o,!1))===l.next&&(l.steiner=!0),h.push(f(l));for(h.sort(u),s=0;s<h.length;s++)c(h[s],n),n=i(n,n.next);return n}(e,t,y,o)),e.length>80*o){s=l=e[0],a=h=e[1];for(var _=o;_<v;_+=o)(d=e[_])<s&&(s=d),(p=e[_+1])<a&&(a=p),d>l&&(l=d),p>h&&(h=p);m=0!==(m=Math.max(l-s,h-a))?1/m:0}return n(y,x,o,s,a,m),x}function r(e,t,r,i,n){var o,s;if(n===T(e,t,r,i)>0)for(o=t;o<r;o+=i)s=E(o,e[o],e[o+1],s);else for(o=r-i;o>=t;o-=i)s=E(o,e[o],e[o+1],s);return s&&v(s,s.next)&&(S(s),s=s.next),s}function i(e,t){if(!e)return e;t||(t=e);var r,i=e;do{if(r=!1,i.steiner||!v(i,i.next)&&0!==g(i.prev,i,i.next))i=i.next;else{if(S(i),(i=t=i.prev)===i.next)break;r=!0}}while(r||i!==t);return t}function n(e,t,r,u,c,h,f){if(e){!f&&h&&function(e,t,r,i){var n=e;do{null===n.z&&(n.z=d(n.x,n.y,t,r,i)),n.prevZ=n.prev,n.nextZ=n.next,n=n.next}while(n!==e);n.prevZ.nextZ=null,n.prevZ=null,function(e){var t,r,i,n,o,s,a,l,u=1;do{for(r=e,e=null,o=null,s=0;r;){for(s++,i=r,a=0,t=0;t<u&&(a++,i=i.nextZ);t++);for(l=u;a>0||l>0&&i;)0!==a&&(0===l||!i||r.z<=i.z)?(n=r,r=r.nextZ,a--):(n=i,i=i.nextZ,l--),o?o.nextZ=n:e=n,n.prevZ=o,o=n;r=i}o.nextZ=null,u*=2}while(s>1)}(n)}(e,u,c,h);for(var p,m,g=e;e.prev!==e.next;)if(p=e.prev,m=e.next,h?s(e,u,c,h):o(e))t.push(p.i/r),t.push(e.i/r),t.push(m.i/r),S(e),e=m.next,g=m.next;else if((e=m)===g){f?1===f?n(e=a(i(e),t,r),t,r,u,c,h,2):2===f&&l(e,t,r,u,c,h):n(i(e),t,r,u,c,h,1);break}}}function o(e){var t=e.prev,r=e,i=e.next;if(g(t,r,i)>=0)return!1;for(var n=e.next.next;n!==e.prev;){if(p(t.x,t.y,r.x,r.y,i.x,i.y,n.x,n.y)&&g(n.prev,n,n.next)>=0)return!1;n=n.next}return!0}function s(e,t,r,i){var n=e.prev,o=e,s=e.next;if(g(n,o,s)>=0)return!1;for(var a=n.x<o.x?n.x<s.x?n.x:s.x:o.x<s.x?o.x:s.x,l=n.y<o.y?n.y<s.y?n.y:s.y:o.y<s.y?o.y:s.y,u=n.x>o.x?n.x>s.x?n.x:s.x:o.x>s.x?o.x:s.x,c=n.y>o.y?n.y>s.y?n.y:s.y:o.y>s.y?o.y:s.y,h=d(a,l,t,r,i),f=d(u,c,t,r,i),m=e.prevZ,v=e.nextZ;m&&m.z>=h&&v&&v.z<=f;){if(m!==e.prev&&m!==e.next&&p(n.x,n.y,o.x,o.y,s.x,s.y,m.x,m.y)&&g(m.prev,m,m.next)>=0)return!1;if(m=m.prevZ,v!==e.prev&&v!==e.next&&p(n.x,n.y,o.x,o.y,s.x,s.y,v.x,v.y)&&g(v.prev,v,v.next)>=0)return!1;v=v.nextZ}for(;m&&m.z>=h;){if(m!==e.prev&&m!==e.next&&p(n.x,n.y,o.x,o.y,s.x,s.y,m.x,m.y)&&g(m.prev,m,m.next)>=0)return!1;m=m.prevZ}for(;v&&v.z<=f;){if(v!==e.prev&&v!==e.next&&p(n.x,n.y,o.x,o.y,s.x,s.y,v.x,v.y)&&g(v.prev,v,v.next)>=0)return!1;v=v.nextZ}return!0}function a(e,t,r){var n=e;do{var o=n.prev,s=n.next.next;!v(o,s)&&y(o,n,n.next,s)&&b(o,s)&&b(s,o)&&(t.push(o.i/r),t.push(n.i/r),t.push(s.i/r),S(n),S(n.next),n=e=s),n=n.next}while(n!==e);return i(n)}function l(e,t,r,o,s,a){var l=e;do{for(var u=l.next.next;u!==l.prev;){if(l.i!==u.i&&m(l,u)){var c=w(l,u);return l=i(l,l.next),c=i(c,c.next),n(l,t,r,o,s,a),void n(c,t,r,o,s,a)}u=u.next}l=l.next}while(l!==e)}function u(e,t){return e.x-t.x}function c(e,t){if(t=function(e,t){var r,i=t,n=e.x,o=e.y,s=-1/0;do{if(o<=i.y&&o>=i.next.y&&i.next.y!==i.y){var a=i.x+(o-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(a<=n&&a>s){if(s=a,a===n){if(o===i.y)return i;if(o===i.next.y)return i.next}r=i.x<i.next.x?i:i.next}}i=i.next}while(i!==t);if(!r)return null;if(n===s)return r;var l,u=r,c=r.x,d=r.y,f=1/0;i=r;do{n>=i.x&&i.x>=c&&n!==i.x&&p(o<d?n:s,o,c,d,o<d?s:n,o,i.x,i.y)&&(l=Math.abs(o-i.y)/(n-i.x),b(i,e)&&(l<f||l===f&&(i.x>r.x||i.x===r.x&&h(r,i)))&&(r=i,f=l)),i=i.next}while(i!==u);return r}(e,t)){var r=w(t,e);i(t,t.next),i(r,r.next)}}function h(e,t){return g(e.prev,e,t.prev)<0&&g(t.next,e,e.next)<0}function d(e,t,r,i,n){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-r)*n)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-i)*n)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function f(e){var t=e,r=e;do{(t.x<r.x||t.x===r.x&&t.y<r.y)&&(r=t),t=t.next}while(t!==e);return r}function p(e,t,r,i,n,o,s,a){return(n-s)*(t-a)-(e-s)*(o-a)>=0&&(e-s)*(i-a)-(r-s)*(t-a)>=0&&(r-s)*(o-a)-(n-s)*(i-a)>=0}function m(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(e,t){var r=e;do{if(r.i!==e.i&&r.next.i!==e.i&&r.i!==t.i&&r.next.i!==t.i&&y(r,r.next,e,t))return!0;r=r.next}while(r!==e);return!1}(e,t)&&(b(e,t)&&b(t,e)&&function(e,t){var r=e,i=!1,n=(e.x+t.x)/2,o=(e.y+t.y)/2;do{r.y>o!=r.next.y>o&&r.next.y!==r.y&&n<(r.next.x-r.x)*(o-r.y)/(r.next.y-r.y)+r.x&&(i=!i),r=r.next}while(r!==e);return i}(e,t)&&(g(e.prev,e,t.prev)||g(e,t.prev,t))||v(e,t)&&g(e.prev,e,e.next)>0&&g(t.prev,t,t.next)>0)}function g(e,t,r){return(t.y-e.y)*(r.x-t.x)-(t.x-e.x)*(r.y-t.y)}function v(e,t){return e.x===t.x&&e.y===t.y}function y(e,t,r,i){var n=_(g(e,t,r)),o=_(g(e,t,i)),s=_(g(r,i,e)),a=_(g(r,i,t));return n!==o&&s!==a||!(0!==n||!x(e,r,t))||!(0!==o||!x(e,i,t))||!(0!==s||!x(r,e,i))||!(0!==a||!x(r,t,i))}function x(e,t,r){return t.x<=Math.max(e.x,r.x)&&t.x>=Math.min(e.x,r.x)&&t.y<=Math.max(e.y,r.y)&&t.y>=Math.min(e.y,r.y)}function _(e){return e>0?1:e<0?-1:0}function b(e,t){return g(e.prev,e,e.next)<0?g(e,t,e.next)>=0&&g(e,e.prev,t)>=0:g(e,t,e.prev)<0||g(e,e.next,t)<0}function w(e,t){var r=new M(e.i,e.x,e.y),i=new M(t.i,t.x,t.y),n=e.next,o=t.prev;return e.next=t,t.prev=e,r.next=n,n.prev=r,i.next=r,r.prev=i,o.next=i,i.prev=o,i}function E(e,t,r,i){var n=new M(e,t,r);return i?(n.next=i.next,n.prev=i,i.next.prev=n,i.next=n):(n.prev=n,n.next=n),n}function S(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function M(e,t,r){this.i=e,this.x=t,this.y=r,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function T(e,t,r,i){for(var n=0,o=t,s=r-i;o<r;o+=i)n+=(e[s]-e[o])*(e[o+1]+e[s+1]),s=o;return n}e.exports=t,e.exports.default=t,t.deviation=function(e,t,r,i){var n=t&&t.length,o=n?t[0]*r:e.length,s=Math.abs(T(e,0,o,r));if(n)for(var a=0,l=t.length;a<l;a++){var u=t[a]*r,c=a<l-1?t[a+1]*r:e.length;s-=Math.abs(T(e,u,c,r))}var h=0;for(a=0;a<i.length;a+=3){var d=i[a]*r,f=i[a+1]*r,p=i[a+2]*r;h+=Math.abs((e[d]-e[p])*(e[f+1]-e[d+1])-(e[d]-e[f])*(e[p+1]-e[d+1]))}return 0===s&&0===h?0:Math.abs((h-s)/s)},t.flatten=function(e){for(var t=e[0][0].length,r={vertices:[],holes:[],dimensions:t},i=0,n=0;n<e.length;n++){for(var o=0;o<e[n].length;o++)for(var s=0;s<t;s++)r.vertices.push(e[n][o][s]);n>0&&(i+=e[n-1].length,r.holes.push(i))}return r}},8721:(e,t,r)=>{"use strict";function i(e,t,r,o){for(var s,a=o,l=r-t>>1,u=r-t,c=e[t],h=e[t+1],d=e[r],f=e[r+1],p=t+3;p<r;p+=3){var m=n(e[p],e[p+1],c,h,d,f);if(m>a)s=p,a=m;else if(m===a){var g=Math.abs(p-l);g<u&&(s=p,u=g)}}a>o&&(s-t>3&&i(e,t,s,o),e[s+2]=a,r-s>3&&i(e,s,r,o))}function n(e,t,r,i,n,o){var s=n-r,a=o-i;if(0!==s||0!==a){var l=((e-r)*s+(t-i)*a)/(s*s+a*a);l>1?(r=n,i=o):l>0&&(r+=s*l,i+=a*l)}return(s=e-r)*s+(a=t-i)*a}function o(e,t,r,i){var n={id:void 0===e?null:e,type:t,geometry:r,tags:i,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(e){var t=e.geometry,r=e.type;if("Point"===r||"MultiPoint"===r||"LineString"===r)s(e,t);else if("Polygon"===r||"MultiLineString"===r)for(var i=0;i<t.length;i++)s(e,t[i]);else if("MultiPolygon"===r)for(i=0;i<t.length;i++)for(var n=0;n<t[i].length;n++)s(e,t[i][n])}(n),n}function s(e,t){for(var r=0;r<t.length;r+=3)e.minX=Math.min(e.minX,t[r]),e.minY=Math.min(e.minY,t[r+1]),e.maxX=Math.max(e.maxX,t[r]),e.maxY=Math.max(e.maxY,t[r+1])}function a(e,t,r,i){if(t.geometry){var n=t.geometry.coordinates,s=t.geometry.type,h=Math.pow(r.tolerance/((1<<r.maxZoom)*r.extent),2),d=[],f=t.id;if(r.promoteId?f=t.properties[r.promoteId]:r.generateId&&(f=i||0),"Point"===s)l(n,d);else if("MultiPoint"===s)for(var p=0;p<n.length;p++)l(n[p],d);else if("LineString"===s)u(n,d,h,!1);else if("MultiLineString"===s){if(r.lineMetrics){for(p=0;p<n.length;p++)d=[],u(n[p],d,h,!1),e.push(o(f,"LineString",d,t.properties));return}c(n,d,h,!1)}else if("Polygon"===s)c(n,d,h,!0);else{if("MultiPolygon"!==s){if("GeometryCollection"===s){for(p=0;p<t.geometry.geometries.length;p++)a(e,{id:f,geometry:t.geometry.geometries[p],properties:t.properties},r,i);return}throw new Error("Input data is not a valid GeoJSON object.")}for(p=0;p<n.length;p++){var m=[];c(n[p],m,h,!0),d.push(m)}}e.push(o(f,s,d,t.properties))}}function l(e,t){t.push(h(e[0])),t.push(d(e[1])),t.push(0)}function u(e,t,r,n){for(var o,s,a=0,l=0;l<e.length;l++){var u=h(e[l][0]),c=d(e[l][1]);t.push(u),t.push(c),t.push(0),l>0&&(a+=n?(o*c-u*s)/2:Math.sqrt(Math.pow(u-o,2)+Math.pow(c-s,2))),o=u,s=c}var f=t.length-3;t[2]=1,i(t,0,f,r),t[f+2]=1,t.size=Math.abs(a),t.start=0,t.end=t.size}function c(e,t,r,i){for(var n=0;n<e.length;n++){var o=[];u(e[n],o,r,i),t.push(o)}}function h(e){return e/360+.5}function d(e){var t=Math.sin(e*Math.PI/180),r=.5-.25*Math.log((1+t)/(1-t))/Math.PI;return r<0?0:r>1?1:r}function f(e,t,r,i,n,s,a,l){if(i/=t,s>=(r/=t)&&a<i)return e;if(a<r||s>=i)return null;for(var u=[],c=0;c<e.length;c++){var h=e[c],d=h.geometry,f=h.type,g=0===n?h.minX:h.minY,y=0===n?h.maxX:h.maxY;if(g>=r&&y<i)u.push(h);else if(!(y<r||g>=i)){var x=[];if("Point"===f||"MultiPoint"===f)p(d,x,r,i,n);else if("LineString"===f)m(d,x,r,i,n,!1,l.lineMetrics);else if("MultiLineString"===f)v(d,x,r,i,n,!1);else if("Polygon"===f)v(d,x,r,i,n,!0);else if("MultiPolygon"===f)for(var _=0;_<d.length;_++){var b=[];v(d[_],b,r,i,n,!0),b.length&&x.push(b)}if(x.length){if(l.lineMetrics&&"LineString"===f){for(_=0;_<x.length;_++)u.push(o(h.id,f,x[_],h.tags));continue}"LineString"!==f&&"MultiLineString"!==f||(1===x.length?(f="LineString",x=x[0]):f="MultiLineString"),"Point"!==f&&"MultiPoint"!==f||(f=3===x.length?"Point":"MultiPoint"),u.push(o(h.id,f,x,h.tags))}}}return u.length?u:null}function p(e,t,r,i,n){for(var o=0;o<e.length;o+=3){var s=e[o+n];s>=r&&s<=i&&(t.push(e[o]),t.push(e[o+1]),t.push(e[o+2]))}}function m(e,t,r,i,n,o,s){for(var a,l,u=g(e),c=0===n?x:_,h=e.start,d=0;d<e.length-3;d+=3){var f=e[d],p=e[d+1],m=e[d+2],v=e[d+3],b=e[d+4],w=0===n?f:p,E=0===n?v:b,S=!1;s&&(a=Math.sqrt(Math.pow(f-v,2)+Math.pow(p-b,2))),w<r?E>r&&(l=c(u,f,p,v,b,r),s&&(u.start=h+a*l)):w>i?E<i&&(l=c(u,f,p,v,b,i),s&&(u.start=h+a*l)):y(u,f,p,m),E<r&&w>=r&&(l=c(u,f,p,v,b,r),S=!0),E>i&&w<=i&&(l=c(u,f,p,v,b,i),S=!0),!o&&S&&(s&&(u.end=h+a*l),t.push(u),u=g(e)),s&&(h+=a)}var M=e.length-3;f=e[M],p=e[M+1],m=e[M+2],(w=0===n?f:p)>=r&&w<=i&&y(u,f,p,m),M=u.length-3,o&&M>=3&&(u[M]!==u[0]||u[M+1]!==u[1])&&y(u,u[0],u[1],u[2]),u.length&&t.push(u)}function g(e){var t=[];return t.size=e.size,t.start=e.start,t.end=e.end,t}function v(e,t,r,i,n,o){for(var s=0;s<e.length;s++)m(e[s],t,r,i,n,o,!1)}function y(e,t,r,i){e.push(t),e.push(r),e.push(i)}function x(e,t,r,i,n,o){var s=(o-t)/(i-t);return e.push(o),e.push(r+(n-r)*s),e.push(1),s}function _(e,t,r,i,n,o){var s=(o-r)/(n-r);return e.push(t+(i-t)*s),e.push(o),e.push(1),s}function b(e,t){for(var r=[],i=0;i<e.length;i++){var n,s=e[i],a=s.type;if("Point"===a||"MultiPoint"===a||"LineString"===a)n=w(s.geometry,t);else if("MultiLineString"===a||"Polygon"===a){n=[];for(var l=0;l<s.geometry.length;l++)n.push(w(s.geometry[l],t))}else if("MultiPolygon"===a)for(n=[],l=0;l<s.geometry.length;l++){for(var u=[],c=0;c<s.geometry[l].length;c++)u.push(w(s.geometry[l][c],t));n.push(u)}r.push(o(s.id,a,n,s.tags))}return r}function w(e,t){var r=[];r.size=e.size,void 0!==e.start&&(r.start=e.start,r.end=e.end);for(var i=0;i<e.length;i+=3)r.push(e[i]+t,e[i+1],e[i+2]);return r}function E(e,t){if(e.transformed)return e;var r,i,n,o=1<<e.z,s=e.x,a=e.y;for(r=0;r<e.features.length;r++){var l=e.features[r],u=l.geometry,c=l.type;if(l.geometry=[],1===c)for(i=0;i<u.length;i+=2)l.geometry.push(S(u[i],u[i+1],t,o,s,a));else for(i=0;i<u.length;i++){var h=[];for(n=0;n<u[i].length;n+=2)h.push(S(u[i][n],u[i][n+1],t,o,s,a));l.geometry.push(h)}}return e.transformed=!0,e}function S(e,t,r,i,n,o){return[Math.round(r*(e*i-n)),Math.round(r*(t*i-o))]}function M(e,t,r,i,n){for(var o=t===n.maxZoom?0:n.tolerance/((1<<t)*n.extent),s={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:r,y:i,z:t,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},a=0;a<e.length;a++){s.numFeatures++,T(s,e[a],o,n);var l=e[a].minX,u=e[a].minY,c=e[a].maxX,h=e[a].maxY;l<s.minX&&(s.minX=l),u<s.minY&&(s.minY=u),c>s.maxX&&(s.maxX=c),h>s.maxY&&(s.maxY=h)}return s}function T(e,t,r,i){var n=t.geometry,o=t.type,s=[];if("Point"===o||"MultiPoint"===o)for(var a=0;a<n.length;a+=3)s.push(n[a]),s.push(n[a+1]),e.numPoints++,e.numSimplified++;else if("LineString"===o)P(s,n,e,r,!1,!1);else if("MultiLineString"===o||"Polygon"===o)for(a=0;a<n.length;a++)P(s,n[a],e,r,"Polygon"===o,0===a);else if("MultiPolygon"===o)for(var l=0;l<n.length;l++){var u=n[l];for(a=0;a<u.length;a++)P(s,u[a],e,r,!0,0===a)}if(s.length){var c=t.tags||null;if("LineString"===o&&i.lineMetrics){for(var h in c={},t.tags)c[h]=t.tags[h];c.mapbox_clip_start=n.start/n.size,c.mapbox_clip_end=n.end/n.size}var d={geometry:s,type:"Polygon"===o||"MultiPolygon"===o?3:"LineString"===o||"MultiLineString"===o?2:1,tags:c};null!==t.id&&(d.id=t.id),e.features.push(d)}}function P(e,t,r,i,n,o){var s=i*i;if(i>0&&t.size<(n?s:i))r.numPoints+=t.length/3;else{for(var a=[],l=0;l<t.length;l+=3)(0===i||t[l+2]>s)&&(r.numSimplified++,a.push(t[l]),a.push(t[l+1])),r.numPoints++;n&&function(e,t){for(var r=0,i=0,n=e.length,o=n-2;i<n;o=i,i+=2)r+=(e[i]-e[o])*(e[i+1]+e[o+1]);if(r>0===t)for(i=0,n=e.length;i<n/2;i+=2){var s=e[i],a=e[i+1];e[i]=e[n-2-i],e[i+1]=e[n-1-i],e[n-2-i]=s,e[n-1-i]=a}}(a,o),e.push(a)}}function A(e,t){return new L(e,t)}function L(e,t){var r=(t=this.options=function(e,t){for(var r in t)e[r]=t[r];return e}(Object.create(this.options),t)).debug;if(r&&console.time("preprocess data"),t.maxZoom<0||t.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(t.promoteId&&t.generateId)throw new Error("promoteId and generateId cannot be used together.");var i=function(e,t){var r=[];if("FeatureCollection"===e.type)for(var i=0;i<e.features.length;i++)a(r,e.features[i],t,i);else"Feature"===e.type?a(r,e,t):a(r,{geometry:e},t);return r}(e,t);this.tiles={},this.tileCoords=[],r&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",t.indexMaxZoom,t.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(i=function(e,t){var r=t.buffer/t.extent,i=e,n=f(e,1,-1-r,r,0,-1,2,t),o=f(e,1,1-r,2+r,0,-1,2,t);return(n||o)&&(i=f(e,1,-r,1+r,0,-1,2,t)||[],n&&(i=b(n,1).concat(i)),o&&(i=i.concat(b(o,-1)))),i}(i,t)).length&&this.splitTile(i,0,0,0),r&&(i.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function C(e,t,r){return 32*((1<<e)*r+t)+e}r.r(t),r.d(t,{default:()=>A}),L.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},L.prototype.splitTile=function(e,t,r,i,n,o,s){for(var a=[e,t,r,i],l=this.options,u=l.debug;a.length;){i=a.pop(),r=a.pop(),t=a.pop(),e=a.pop();var c=1<<t,h=C(t,r,i),d=this.tiles[h];if(!d&&(u>1&&console.time("creation"),d=this.tiles[h]=M(e,t,r,i,l),this.tileCoords.push({z:t,x:r,y:i}),u)){u>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",t,r,i,d.numFeatures,d.numPoints,d.numSimplified),console.timeEnd("creation"));var p="z"+t;this.stats[p]=(this.stats[p]||0)+1,this.total++}if(d.source=e,n){if(t===l.maxZoom||t===n)continue;var m=1<<n-t;if(r!==Math.floor(o/m)||i!==Math.floor(s/m))continue}else if(t===l.indexMaxZoom||d.numPoints<=l.indexMaxPoints)continue;if(d.source=null,0!==e.length){u>1&&console.time("clipping");var g,v,y,x,_,b,w=.5*l.buffer/l.extent,E=.5-w,S=.5+w,T=1+w;g=v=y=x=null,_=f(e,c,r-w,r+S,0,d.minX,d.maxX,l),b=f(e,c,r+E,r+T,0,d.minX,d.maxX,l),e=null,_&&(g=f(_,c,i-w,i+S,1,d.minY,d.maxY,l),v=f(_,c,i+E,i+T,1,d.minY,d.maxY,l),_=null),b&&(y=f(b,c,i-w,i+S,1,d.minY,d.maxY,l),x=f(b,c,i+E,i+T,1,d.minY,d.maxY,l),b=null),u>1&&console.timeEnd("clipping"),a.push(g||[],t+1,2*r,2*i),a.push(v||[],t+1,2*r,2*i+1),a.push(y||[],t+1,2*r+1,2*i),a.push(x||[],t+1,2*r+1,2*i+1)}}},L.prototype.getTile=function(e,t,r){var i=this.options,n=i.extent,o=i.debug;if(e<0||e>24)return null;var s=1<<e,a=C(e,t=(t%s+s)%s,r);if(this.tiles[a])return E(this.tiles[a],n);o>1&&console.log("drilling down to z%d-%d-%d",e,t,r);for(var l,u=e,c=t,h=r;!l&&u>0;)u--,c=Math.floor(c/2),h=Math.floor(h/2),l=this.tiles[C(u,c,h)];return l&&l.source?(o>1&&console.log("found parent tile z%d-%d-%d",u,c,h),o>1&&console.time("drilling down"),this.splitTile(l.source,u,c,h,e,t,r),o>1&&console.timeEnd("drilling down"),this.tiles[a]?E(this.tiles[a],n):null):null}},7808:e=>{e.exports=r;var t=null;try{t=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch(e){}function r(e,t,r){this.low=0|e,this.high=0|t,this.unsigned=!!r}function i(e){return!0===(e&&e.__isLong__)}r.prototype.__isLong__,Object.defineProperty(r.prototype,"__isLong__",{value:!0}),r.isLong=i;var n={},o={};function s(e,t){var r,i,s;return t?(s=0<=(e>>>=0)&&e<256)&&(i=o[e])?i:(r=l(e,(0|e)<0?-1:0,!0),s&&(o[e]=r),r):(s=-128<=(e|=0)&&e<128)&&(i=n[e])?i:(r=l(e,e<0?-1:0,!1),s&&(n[e]=r),r)}function a(e,t){if(isNaN(e))return t?v:g;if(t){if(e<0)return v;if(e>=f)return w}else{if(e<=-p)return E;if(e+1>=p)return b}return e<0?a(-e,t).neg():l(e%d|0,e/d|0,t)}function l(e,t,i){return new r(e,t,i)}r.fromInt=s,r.fromNumber=a,r.fromBits=l;var u=Math.pow;function c(e,t,r){if(0===e.length)throw Error("empty string");if("NaN"===e||"Infinity"===e||"+Infinity"===e||"-Infinity"===e)return g;if("number"==typeof t?(r=t,t=!1):t=!!t,(r=r||10)<2||36<r)throw RangeError("radix");var i;if((i=e.indexOf("-"))>0)throw Error("interior hyphen");if(0===i)return c(e.substring(1),t,r).neg();for(var n=a(u(r,8)),o=g,s=0;s<e.length;s+=8){var l=Math.min(8,e.length-s),h=parseInt(e.substring(s,s+l),r);if(l<8){var d=a(u(r,l));o=o.mul(d).add(a(h))}else o=(o=o.mul(n)).add(a(h))}return o.unsigned=t,o}function h(e,t){return"number"==typeof e?a(e,t):"string"==typeof e?c(e,t):l(e.low,e.high,"boolean"==typeof t?t:e.unsigned)}r.fromString=c,r.fromValue=h;var d=4294967296,f=d*d,p=f/2,m=s(1<<24),g=s(0);r.ZERO=g;var v=s(0,!0);r.UZERO=v;var y=s(1);r.ONE=y;var x=s(1,!0);r.UONE=x;var _=s(-1);r.NEG_ONE=_;var b=l(-1,2147483647,!1);r.MAX_VALUE=b;var w=l(-1,-1,!0);r.MAX_UNSIGNED_VALUE=w;var E=l(0,-2147483648,!1);r.MIN_VALUE=E;var S=r.prototype;S.toInt=function(){return this.unsigned?this.low>>>0:this.low},S.toNumber=function(){return this.unsigned?(this.high>>>0)*d+(this.low>>>0):this.high*d+(this.low>>>0)},S.toString=function(e){if((e=e||10)<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(E)){var t=a(e),r=this.div(t),i=r.mul(t).sub(this);return r.toString(e)+i.toInt().toString(e)}return"-"+this.neg().toString(e)}for(var n=a(u(e,6),this.unsigned),o=this,s="";;){var l=o.div(n),c=(o.sub(l.mul(n)).toInt()>>>0).toString(e);if((o=l).isZero())return c+s;for(;c.length<6;)c="0"+c;s=""+c+s}},S.getHighBits=function(){return this.high},S.getHighBitsUnsigned=function(){return this.high>>>0},S.getLowBits=function(){return this.low},S.getLowBitsUnsigned=function(){return this.low>>>0},S.getNumBitsAbs=function(){if(this.isNegative())return this.eq(E)?64:this.neg().getNumBitsAbs();for(var e=0!=this.high?this.high:this.low,t=31;t>0&&0==(e&1<<t);t--);return 0!=this.high?t+33:t+1},S.isZero=function(){return 0===this.high&&0===this.low},S.eqz=S.isZero,S.isNegative=function(){return!this.unsigned&&this.high<0},S.isPositive=function(){return this.unsigned||this.high>=0},S.isOdd=function(){return 1==(1&this.low)},S.isEven=function(){return 0==(1&this.low)},S.equals=function(e){return i(e)||(e=h(e)),(this.unsigned===e.unsigned||this.high>>>31!=1||e.high>>>31!=1)&&this.high===e.high&&this.low===e.low},S.eq=S.equals,S.notEquals=function(e){return!this.eq(e)},S.neq=S.notEquals,S.ne=S.notEquals,S.lessThan=function(e){return this.comp(e)<0},S.lt=S.lessThan,S.lessThanOrEqual=function(e){return this.comp(e)<=0},S.lte=S.lessThanOrEqual,S.le=S.lessThanOrEqual,S.greaterThan=function(e){return this.comp(e)>0},S.gt=S.greaterThan,S.greaterThanOrEqual=function(e){return this.comp(e)>=0},S.gte=S.greaterThanOrEqual,S.ge=S.greaterThanOrEqual,S.compare=function(e){if(i(e)||(e=h(e)),this.eq(e))return 0;var t=this.isNegative(),r=e.isNegative();return t&&!r?-1:!t&&r?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1},S.comp=S.compare,S.negate=function(){return!this.unsigned&&this.eq(E)?E:this.not().add(y)},S.neg=S.negate,S.add=function(e){i(e)||(e=h(e));var t=this.high>>>16,r=65535&this.high,n=this.low>>>16,o=65535&this.low,s=e.high>>>16,a=65535&e.high,u=e.low>>>16,c=0,d=0,f=0,p=0;return f+=(p+=o+(65535&e.low))>>>16,d+=(f+=n+u)>>>16,c+=(d+=r+a)>>>16,c+=t+s,l((f&=65535)<<16|(p&=65535),(c&=65535)<<16|(d&=65535),this.unsigned)},S.subtract=function(e){return i(e)||(e=h(e)),this.add(e.neg())},S.sub=S.subtract,S.multiply=function(e){if(this.isZero())return g;if(i(e)||(e=h(e)),t)return l(t.mul(this.low,this.high,e.low,e.high),t.get_high(),this.unsigned);if(e.isZero())return g;if(this.eq(E))return e.isOdd()?E:g;if(e.eq(E))return this.isOdd()?E:g;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(m)&&e.lt(m))return a(this.toNumber()*e.toNumber(),this.unsigned);var r=this.high>>>16,n=65535&this.high,o=this.low>>>16,s=65535&this.low,u=e.high>>>16,c=65535&e.high,d=e.low>>>16,f=65535&e.low,p=0,v=0,y=0,x=0;return y+=(x+=s*f)>>>16,v+=(y+=o*f)>>>16,y&=65535,v+=(y+=s*d)>>>16,p+=(v+=n*f)>>>16,v&=65535,p+=(v+=o*d)>>>16,v&=65535,p+=(v+=s*c)>>>16,p+=r*f+n*d+o*c+s*u,l((y&=65535)<<16|(x&=65535),(p&=65535)<<16|(v&=65535),this.unsigned)},S.mul=S.multiply,S.divide=function(e){if(i(e)||(e=h(e)),e.isZero())throw Error("division by zero");var r,n,o;if(t)return this.unsigned||-2147483648!==this.high||-1!==e.low||-1!==e.high?l((this.unsigned?t.div_u:t.div_s)(this.low,this.high,e.low,e.high),t.get_high(),this.unsigned):this;if(this.isZero())return this.unsigned?v:g;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return v;if(e.gt(this.shru(1)))return x;o=v}else{if(this.eq(E))return e.eq(y)||e.eq(_)?E:e.eq(E)?y:(r=this.shr(1).div(e).shl(1)).eq(g)?e.isNegative()?y:_:(n=this.sub(e.mul(r)),o=r.add(n.div(e)));if(e.eq(E))return this.unsigned?v:g;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();o=g}for(n=this;n.gte(e);){r=Math.max(1,Math.floor(n.toNumber()/e.toNumber()));for(var s=Math.ceil(Math.log(r)/Math.LN2),c=s<=48?1:u(2,s-48),d=a(r),f=d.mul(e);f.isNegative()||f.gt(n);)f=(d=a(r-=c,this.unsigned)).mul(e);d.isZero()&&(d=y),o=o.add(d),n=n.sub(f)}return o},S.div=S.divide,S.modulo=function(e){return i(e)||(e=h(e)),t?l((this.unsigned?t.rem_u:t.rem_s)(this.low,this.high,e.low,e.high),t.get_high(),this.unsigned):this.sub(this.div(e).mul(e))},S.mod=S.modulo,S.rem=S.modulo,S.not=function(){return l(~this.low,~this.high,this.unsigned)},S.and=function(e){return i(e)||(e=h(e)),l(this.low&e.low,this.high&e.high,this.unsigned)},S.or=function(e){return i(e)||(e=h(e)),l(this.low|e.low,this.high|e.high,this.unsigned)},S.xor=function(e){return i(e)||(e=h(e)),l(this.low^e.low,this.high^e.high,this.unsigned)},S.shiftLeft=function(e){return i(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?l(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):l(0,this.low<<e-32,this.unsigned)},S.shl=S.shiftLeft,S.shiftRight=function(e){return i(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?l(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):l(this.high>>e-32,this.high>=0?0:-1,this.unsigned)},S.shr=S.shiftRight,S.shiftRightUnsigned=function(e){if(i(e)&&(e=e.toInt()),0==(e&=63))return this;var t=this.high;return e<32?l(this.low>>>e|t<<32-e,t>>>e,this.unsigned):l(32===e?t:t>>>e-32,0,this.unsigned)},S.shru=S.shiftRightUnsigned,S.shr_u=S.shiftRightUnsigned,S.toSigned=function(){return this.unsigned?l(this.low,this.high,!1):this},S.toUnsigned=function(){return this.unsigned?this:l(this.low,this.high,!0)},S.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()},S.toBytesLE=function(){var e=this.high,t=this.low;return[255&t,t>>>8&255,t>>>16&255,t>>>24,255&e,e>>>8&255,e>>>16&255,e>>>24]},S.toBytesBE=function(){var e=this.high,t=this.low;return[e>>>24,e>>>16&255,e>>>8&255,255&e,t>>>24,t>>>16&255,t>>>8&255,255&t]},r.fromBytes=function(e,t,i){return i?r.fromBytesLE(e,t):r.fromBytesBE(e,t)},r.fromBytesLE=function(e,t){return new r(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,t)},r.fromBytesBE=function(e,t){return new r(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],t)}},3737:(e,t,r)=>{"use strict";e.exports=r(536)},536:(e,t,r)=>{"use strict";var i=t;function n(){i.util._configure(),i.Writer._configure(i.BufferWriter),i.Reader._configure(i.BufferReader)}i.build="minimal",i.Writer=r(123),i.BufferWriter=r(6673),i.Reader=r(9799),i.BufferReader=r(7038),i.util=r(4165),i.rpc=r(4963),i.roots=r(9009),i.configure=n,n()},9799:(e,t,r)=>{"use strict";e.exports=l;var i,n=r(4165),o=n.LongBits,s=n.utf8;function a(e,t){return RangeError("index out of range: "+e.pos+" + "+(t||1)+" > "+e.len)}function l(e){this.buf=e,this.pos=0,this.len=e.length}var u,c="undefined"!=typeof Uint8Array?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new l(e);throw Error("illegal buffer")}:function(e){if(Array.isArray(e))return new l(e);throw Error("illegal buffer")},h=function(){return n.Buffer?function(e){return(l.create=function(e){return n.Buffer.isBuffer(e)?new i(e):c(e)})(e)}:c};function d(){var e=new o(0,0),t=0;if(!(this.len-this.pos>4)){for(;t<3;++t){if(this.pos>=this.len)throw a(this);if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e}return e.lo=(e.lo|(127&this.buf[this.pos++])<<7*t)>>>0,e}for(;t<4;++t)if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e;if(e.lo=(e.lo|(127&this.buf[this.pos])<<28)>>>0,e.hi=(e.hi|(127&this.buf[this.pos])>>4)>>>0,this.buf[this.pos++]<128)return e;if(t=0,this.len-this.pos>4){for(;t<5;++t)if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}else for(;t<5;++t){if(this.pos>=this.len)throw a(this);if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}throw Error("invalid varint encoding")}function f(e,t){return(e[t-4]|e[t-3]<<8|e[t-2]<<16|e[t-1]<<24)>>>0}function p(){if(this.pos+8>this.len)throw a(this,8);return new o(f(this.buf,this.pos+=4),f(this.buf,this.pos+=4))}l.create=h(),l.prototype._slice=n.Array.prototype.subarray||n.Array.prototype.slice,l.prototype.uint32=(u=4294967295,function(){if(u=(127&this.buf[this.pos])>>>0,this.buf[this.pos++]<128)return u;if(u=(u|(127&this.buf[this.pos])<<7)>>>0,this.buf[this.pos++]<128)return u;if(u=(u|(127&this.buf[this.pos])<<14)>>>0,this.buf[this.pos++]<128)return u;if(u=(u|(127&this.buf[this.pos])<<21)>>>0,this.buf[this.pos++]<128)return u;if(u=(u|(15&this.buf[this.pos])<<28)>>>0,this.buf[this.pos++]<128)return u;if((this.pos+=5)>this.len)throw this.pos=this.len,a(this,10);return u}),l.prototype.int32=function(){return 0|this.uint32()},l.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(1&e)|0},l.prototype.bool=function(){return 0!==this.uint32()},l.prototype.fixed32=function(){if(this.pos+4>this.len)throw a(this,4);return f(this.buf,this.pos+=4)},l.prototype.sfixed32=function(){if(this.pos+4>this.len)throw a(this,4);return 0|f(this.buf,this.pos+=4)},l.prototype.float=function(){if(this.pos+4>this.len)throw a(this,4);var e=n.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e},l.prototype.double=function(){if(this.pos+8>this.len)throw a(this,4);var e=n.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e},l.prototype.bytes=function(){var e=this.uint32(),t=this.pos,r=this.pos+e;if(r>this.len)throw a(this,e);return this.pos+=e,Array.isArray(this.buf)?this.buf.slice(t,r):t===r?new this.buf.constructor(0):this._slice.call(this.buf,t,r)},l.prototype.string=function(){var e=this.bytes();return s.read(e,0,e.length)},l.prototype.skip=function(e){if("number"==typeof e){if(this.pos+e>this.len)throw a(this,e);this.pos+=e}else do{if(this.pos>=this.len)throw a(this)}while(128&this.buf[this.pos++]);return this},l.prototype.skipType=function(e){switch(e){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;4!=(e=7&this.uint32());)this.skipType(e);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+e+" at offset "+this.pos)}return this},l._configure=function(e){i=e,l.create=h(),i._configure();var t=n.Long?"toLong":"toNumber";n.merge(l.prototype,{int64:function(){return d.call(this)[t](!1)},uint64:function(){return d.call(this)[t](!0)},sint64:function(){return d.call(this).zzDecode()[t](!1)},fixed64:function(){return p.call(this)[t](!0)},sfixed64:function(){return p.call(this)[t](!1)}})}},7038:(e,t,r)=>{"use strict";e.exports=o;var i=r(9799);(o.prototype=Object.create(i.prototype)).constructor=o;var n=r(4165);function o(e){i.call(this,e)}o._configure=function(){n.Buffer&&(o.prototype._slice=n.Buffer.prototype.slice)},o.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+e,this.len))},o._configure()},9009:e=>{"use strict";e.exports={}},4963:(e,t,r)=>{"use strict";t.Service=r(9548)},9548:(e,t,r)=>{"use strict";e.exports=n;var i=r(4165);function n(e,t,r){if("function"!=typeof e)throw TypeError("rpcImpl must be a function");i.EventEmitter.call(this),this.rpcImpl=e,this.requestDelimited=Boolean(t),this.responseDelimited=Boolean(r)}(n.prototype=Object.create(i.EventEmitter.prototype)).constructor=n,n.prototype.rpcCall=function e(t,r,n,o,s){if(!o)throw TypeError("request must be specified");var a=this;if(!s)return i.asPromise(e,a,t,r,n,o);if(a.rpcImpl)try{return a.rpcImpl(t,r[a.requestDelimited?"encodeDelimited":"encode"](o).finish(),(function(e,r){if(e)return a.emit("error",e,t),s(e);if(null!==r){if(!(r instanceof n))try{r=n[a.responseDelimited?"decodeDelimited":"decode"](r)}catch(e){return a.emit("error",e,t),s(e)}return a.emit("data",r,t),s(null,r)}a.end(!0)}))}catch(e){return a.emit("error",e,t),void setTimeout((function(){s(e)}),0)}else setTimeout((function(){s(Error("already ended"))}),0)},n.prototype.end=function(e){return this.rpcImpl&&(e||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}},1697:(e,t,r)=>{"use strict";e.exports=n;var i=r(4165);function n(e,t){this.lo=e>>>0,this.hi=t>>>0}var o=n.zero=new n(0,0);o.toNumber=function(){return 0},o.zzEncode=o.zzDecode=function(){return this},o.length=function(){return 1};var s=n.zeroHash="\0\0\0\0\0\0\0\0";n.fromNumber=function(e){if(0===e)return o;var t=e<0;t&&(e=-e);var r=e>>>0,i=(e-r)/4294967296>>>0;return t&&(i=~i>>>0,r=~r>>>0,++r>4294967295&&(r=0,++i>4294967295&&(i=0))),new n(r,i)},n.from=function(e){if("number"==typeof e)return n.fromNumber(e);if(i.isString(e)){if(!i.Long)return n.fromNumber(parseInt(e,10));e=i.Long.fromString(e)}return e.low||e.high?new n(e.low>>>0,e.high>>>0):o},n.prototype.toNumber=function(e){if(!e&&this.hi>>>31){var t=1+~this.lo>>>0,r=~this.hi>>>0;return t||(r=r+1>>>0),-(t+4294967296*r)}return this.lo+4294967296*this.hi},n.prototype.toLong=function(e){return i.Long?new i.Long(0|this.lo,0|this.hi,Boolean(e)):{low:0|this.lo,high:0|this.hi,unsigned:Boolean(e)}};var a=String.prototype.charCodeAt;n.fromHash=function(e){return e===s?o:new n((a.call(e,0)|a.call(e,1)<<8|a.call(e,2)<<16|a.call(e,3)<<24)>>>0,(a.call(e,4)|a.call(e,5)<<8|a.call(e,6)<<16|a.call(e,7)<<24)>>>0)},n.prototype.toHash=function(){return String.fromCharCode(255&this.lo,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,255&this.hi,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},n.prototype.zzEncode=function(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this},n.prototype.zzDecode=function(){var e=-(1&this.lo);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this},n.prototype.length=function(){var e=this.lo,t=(this.lo>>>28|this.hi<<4)>>>0,r=this.hi>>>24;return 0===r?0===t?e<16384?e<128?1:2:e<2097152?3:4:t<16384?t<128?5:6:t<2097152?7:8:r<128?9:10}},4165:function(e,t,r){"use strict";var i=t;function n(e,t,r){for(var i=Object.keys(t),n=0;n<i.length;++n)void 0!==e[i[n]]&&r||(e[i[n]]=t[i[n]]);return e}function o(e){function t(e,r){if(!(this instanceof t))return new t(e,r);Object.defineProperty(this,"message",{get:function(){return e}}),Error.captureStackTrace?Error.captureStackTrace(this,t):Object.defineProperty(this,"stack",{value:(new Error).stack||""}),r&&n(this,r)}return(t.prototype=Object.create(Error.prototype)).constructor=t,Object.defineProperty(t.prototype,"name",{get:function(){return e}}),t.prototype.toString=function(){return this.name+": "+this.message},t}i.asPromise=r(6781),i.base64=r(7026),i.EventEmitter=r(5570),i.float=r(5298),i.inquire=r(6116),i.utf8=r(7958),i.pool=r(804),i.LongBits=r(1697),i.isNode=Boolean(void 0!==r.g&&r.g&&r.g.process&&r.g.process.versions&&r.g.process.versions.node),i.global=i.isNode&&r.g||"undefined"!=typeof window&&window||"undefined"!=typeof self&&self||this,i.emptyArray=Object.freeze?Object.freeze([]):[],i.emptyObject=Object.freeze?Object.freeze({}):{},i.isInteger=Number.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e},i.isString=function(e){return"string"==typeof e||e instanceof String},i.isObject=function(e){return e&&"object"==typeof e},i.isset=i.isSet=function(e,t){var r=e[t];return!(null==r||!e.hasOwnProperty(t))&&("object"!=typeof r||(Array.isArray(r)?r.length:Object.keys(r).length)>0)},i.Buffer=function(){try{var e=i.inquire("buffer").Buffer;return e.prototype.utf8Write?e:null}catch(e){return null}}(),i._Buffer_from=null,i._Buffer_allocUnsafe=null,i.newBuffer=function(e){return"number"==typeof e?i.Buffer?i._Buffer_allocUnsafe(e):new i.Array(e):i.Buffer?i._Buffer_from(e):"undefined"==typeof Uint8Array?e:new Uint8Array(e)},i.Array="undefined"!=typeof Uint8Array?Uint8Array:Array,i.Long=i.global.dcodeIO&&i.global.dcodeIO.Long||i.global.Long||i.inquire("long"),i.key2Re=/^true|false|0|1$/,i.key32Re=/^-?(?:0|[1-9][0-9]*)$/,i.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,i.longToHash=function(e){return e?i.LongBits.from(e).toHash():i.LongBits.zeroHash},i.longFromHash=function(e,t){var r=i.LongBits.fromHash(e);return i.Long?i.Long.fromBits(r.lo,r.hi,t):r.toNumber(Boolean(t))},i.merge=n,i.lcFirst=function(e){return e.charAt(0).toLowerCase()+e.substring(1)},i.newError=o,i.ProtocolError=o("ProtocolError"),i.oneOfGetter=function(e){for(var t={},r=0;r<e.length;++r)t[e[r]]=1;return function(){for(var e=Object.keys(this),r=e.length-1;r>-1;--r)if(1===t[e[r]]&&void 0!==this[e[r]]&&null!==this[e[r]])return e[r]}},i.oneOfSetter=function(e){return function(t){for(var r=0;r<e.length;++r)e[r]!==t&&delete this[e[r]]}},i.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},i._configure=function(){var e=i.Buffer;e?(i._Buffer_from=e.from!==Uint8Array.from&&e.from||function(t,r){return new e(t,r)},i._Buffer_allocUnsafe=e.allocUnsafe||function(t){return new e(t)}):i._Buffer_from=i._Buffer_allocUnsafe=null}},123:(e,t,r)=>{"use strict";e.exports=h;var i,n=r(4165),o=n.LongBits,s=n.base64,a=n.utf8;function l(e,t,r){this.fn=e,this.len=t,this.next=void 0,this.val=r}function u(){}function c(e){this.head=e.head,this.tail=e.tail,this.len=e.len,this.next=e.states}function h(){this.len=0,this.head=new l(u,0,0),this.tail=this.head,this.states=null}var d=function(){return n.Buffer?function(){return(h.create=function(){return new i})()}:function(){return new h}};function f(e,t,r){t[r]=255&e}function p(e,t){this.len=e,this.next=void 0,this.val=t}function m(e,t,r){for(;e.hi;)t[r++]=127&e.lo|128,e.lo=(e.lo>>>7|e.hi<<25)>>>0,e.hi>>>=7;for(;e.lo>127;)t[r++]=127&e.lo|128,e.lo=e.lo>>>7;t[r++]=e.lo}function g(e,t,r){t[r]=255&e,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24}h.create=d(),h.alloc=function(e){return new n.Array(e)},n.Array!==Array&&(h.alloc=n.pool(h.alloc,n.Array.prototype.subarray)),h.prototype._push=function(e,t,r){return this.tail=this.tail.next=new l(e,t,r),this.len+=t,this},p.prototype=Object.create(l.prototype),p.prototype.fn=function(e,t,r){for(;e>127;)t[r++]=127&e|128,e>>>=7;t[r]=e},h.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new p((e>>>=0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this},h.prototype.int32=function(e){return e<0?this._push(m,10,o.fromNumber(e)):this.uint32(e)},h.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)},h.prototype.uint64=function(e){var t=o.from(e);return this._push(m,t.length(),t)},h.prototype.int64=h.prototype.uint64,h.prototype.sint64=function(e){var t=o.from(e).zzEncode();return this._push(m,t.length(),t)},h.prototype.bool=function(e){return this._push(f,1,e?1:0)},h.prototype.fixed32=function(e){return this._push(g,4,e>>>0)},h.prototype.sfixed32=h.prototype.fixed32,h.prototype.fixed64=function(e){var t=o.from(e);return this._push(g,4,t.lo)._push(g,4,t.hi)},h.prototype.sfixed64=h.prototype.fixed64,h.prototype.float=function(e){return this._push(n.float.writeFloatLE,4,e)},h.prototype.double=function(e){return this._push(n.float.writeDoubleLE,8,e)};var v=n.Array.prototype.set?function(e,t,r){t.set(e,r)}:function(e,t,r){for(var i=0;i<e.length;++i)t[r+i]=e[i]};h.prototype.bytes=function(e){var t=e.length>>>0;if(!t)return this._push(f,1,0);if(n.isString(e)){var r=h.alloc(t=s.length(e));s.decode(e,r,0),e=r}return this.uint32(t)._push(v,t,e)},h.prototype.string=function(e){var t=a.length(e);return t?this.uint32(t)._push(a.write,t,e):this._push(f,1,0)},h.prototype.fork=function(){return this.states=new c(this),this.head=this.tail=new l(u,0,0),this.len=0,this},h.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new l(u,0,0),this.len=0),this},h.prototype.ldelim=function(){var e=this.head,t=this.tail,r=this.len;return this.reset().uint32(r),r&&(this.tail.next=e.next,this.tail=t,this.len+=r),this},h.prototype.finish=function(){for(var e=this.head.next,t=this.constructor.alloc(this.len),r=0;e;)e.fn(e.val,t,r),r+=e.len,e=e.next;return t},h._configure=function(e){i=e,h.create=d(),i._configure()}},6673:(e,t,r)=>{"use strict";e.exports=o;var i=r(123);(o.prototype=Object.create(i.prototype)).constructor=o;var n=r(4165);function o(){i.call(this)}function s(e,t,r){e.length<40?n.utf8.write(e,t,r):t.utf8Write?t.utf8Write(e,r):t.write(e,r)}o._configure=function(){o.alloc=n._Buffer_allocUnsafe,o.writeBytesBuffer=n.Buffer&&n.Buffer.prototype instanceof Uint8Array&&"set"===n.Buffer.prototype.set.name?function(e,t,r){t.set(e,r)}:function(e,t,r){if(e.copy)e.copy(t,r,0,e.length);else for(var i=0;i<e.length;)t[r++]=e[i++]}},o.prototype.bytes=function(e){n.isString(e)&&(e=n._Buffer_from(e,"base64"));var t=e.length>>>0;return this.uint32(t),t&&this._push(o.writeBytesBuffer,t,e),this},o.prototype.string=function(e){var t=n.Buffer.byteLength(e);return this.uint32(t),t&&this._push(s,t,e),this},o._configure()},5263:function(e,t,r){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,r,i){void 0===i&&(i=r),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,i){void 0===i&&(i=r),e[i]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||i(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),n(r(5257),t),n(r(1470),t),n(r(9416),t),n(r(8937),t),n(r(1549),t),n(r(6665),t)},4482:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ColorUtils=void 0;const i=r(3333),n=r(4428),o=r(5795),s=255,a=new n.Color;var l;(l=t.ColorUtils||(t.ColorUtils={})).getHexFromRgba=function(e,t,r,n){return i.assert(n>=0&&n<=1),s-Math.floor(n*s)<<24^e*s<<16^t*s<<8^r*s<<0},l.getHexFromRgb=function(e,t,r){return i.assert(e>=0&&e<=1),i.assert(t>=0&&t<=1),i.assert(r>=0&&r<=1),e*s<<16^t*s<<8^r*s<<0},l.getHexFromHsl=function(e,t,r){return i.assert(e>=0&&e<=1),i.assert(t>=0&&t<=1),i.assert(r>=0&&r<=1),a.setHSL(e,t,r).getHex()},l.getRgbaFromHex=function(e,t=new o.RGBA){return i.assert(0==(0&e),"Wrong hex format"),t.r=(e>>16&s)/s,t.g=(e>>8&s)/s,t.b=(e>>0&s)/s,t.a=(s-(e>>24&s))/s,t},l.hasAlphaInHex=function(e){return i.assert(0==(0&e),"Wrong hex format"),e>>24!=0},l.getAlphaFromHex=function(e){return i.assert(0==(0&e),"Wrong hex format"),(s-(e>>24)&s)/s},l.removeAlphaFromHex=function(e){return i.assert(0==(0&e),"Wrong hex format"),16777215&e}},84:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.scaleHeight=t.getFeatureText=t.getFeatureName=t.getFeatureId=t.getProjectionName=t.getProjection=t.GeometryType=t.getArrayConstructor=void 0;const i=r(3139),n=r(8937),o=r(3024),s=r(7828);function a(e,t,r,i,n){var o;let s;if(void 0===t&&(t="name"),r){const r=e.lookup(`${t}:short`);if("string"==typeof r&&r.length>0)return r}if(i){const t=e.lookup("iso_code");if("string"==typeof t&&t.length>0)return t}if(void 0!==n)for(const r of n)if(s=null!==(o=e.lookup(`${t}:${r}`))&&void 0!==o?o:e.lookup(`${t}_${r}`),"string"==typeof s&&s.length>0)return s;if(s=e.lookup(t),"string"==typeof s)return s}var l;t.getArrayConstructor=function(e){switch(e){case"float":return Float32Array;case"uint8":return Uint8Array;case"uint16":return Uint16Array;case"uint32":return Uint32Array;case"int8":return Int8Array;case"int16":return Int16Array;case"int32":return Int32Array}},(l=t.GeometryType||(t.GeometryType={}))[l.Unspecified=0]="Unspecified",l[l.Point=1]="Point",l[l.Line=2]="Line",l[l.SolidLine=3]="SolidLine",l[l.Text=4]="Text",l[l.TextPath=5]="TextPath",l[l.ExtrudedLine=6]="ExtrudedLine",l[l.Polygon=7]="Polygon",l[l.ExtrudedPolygon=8]="ExtrudedPolygon",l[l.Object3D=9]="Object3D",l[l.Other=1e3]="Other",t.getProjection=function(e){switch(e){case"mercator":return i.mercatorProjection;case"webMercator":return i.webMercatorProjection;case"sphere":return i.sphereProjection;case"normalizedEquirectangular":return i.normalizedEquirectangularProjection;case"equirectangular":return i.equirectangularProjection;default:throw new Error(`Unknown projection ${e}`)}},t.getProjectionName=function(e){if(e===i.mercatorProjection)return"mercator";if(e===i.webMercatorProjection)return"webMercator";if(e===i.sphereProjection)return"sphere";if(e===i.normalizedEquirectangularProjection)return"normalizedEquirectangular";if(e===i.equirectangularProjection)return"equirectangular";throw new Error("Unknown projection")},t.getFeatureId=function(e){if(void 0===e)return 0;if("string"==typeof e||"number"==typeof e)return e;if(e.hasOwnProperty("$id")){const t=e.$id;if("string"==typeof t||"number"==typeof t)return t}return 0},t.getFeatureName=a,t.getFeatureText=function(e,t,r){let i,l;const u=e instanceof n.Env?e:e.env;let c="name";if(s.isTextTechnique(t)||s.isPoiTechnique(t)||s.isLineMarkerTechnique(t)){if(void 0!==t.text)return o.evaluateTechniqueAttr(e,t.text);if(void 0!==t.label&&(c=o.evaluateTechniqueAttr(e,t.label),"string"!=typeof c))return;i=t.useAbbreviation,l=t.useIsoCode}return a(u,c,i,l,r)},t.scaleHeight=function(e,t,r){return!o.evaluateTechniqueAttr(e,t.constantHeight,r<12)}},9415:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MapEnv=t.Env=void 0;class r{static isEnv(e){return e instanceof r}lookup(e){}unmap(){return{}}}t.Env=r,t.MapEnv=class extends r{constructor(e,t){super(),this.entries=e,this.parent=t}lookup(e){if(this.entries.hasOwnProperty(e)){const t=this.entries[e];if(void 0!==t)return t}return this.parent?this.parent.lookup(e):void 0}unmap(){const e=this.parent?this.parent.unmap():{};for(const t in this.entries)this.entries.hasOwnProperty(t)&&(e[t]=this.entries[t]);return e}}},8937:function(e,t,r){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,r,i){void 0===i&&(i=r),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,i){void 0===i&&(i=r),e[i]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||i(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),t.InterpolateExpr=t.StepExpr=t.CaseExpr=t.MatchExpr=t.CallExpr=t.HasAttributeExpr=t.ObjectLiteralExpr=t.StringLiteralExpr=t.NumberLiteralExpr=t.BooleanLiteralExpr=t.NullLiteralExpr=t.LiteralExpr=t.VarExpr=t.Expr=t.ExprScope=t.isJsonExpr=t.ExprDependencies=void 0;const o=r(4428),s=r(2344),a=r(5318),l=r(4973),u=r(2904),c=r(5997),h=r(5795);n(r(9415),t);const d=new s.ExprEvaluator,f=new a.ExprInstantiator;class p{constructor(){this.properties=new Set}}t.ExprDependencies=p;class m{static of(e){const t=new p;return e.accept(this.instance,t),t}visitNullLiteralExpr(e,t){}visitBooleanLiteralExpr(e,t){}visitNumberLiteralExpr(e,t){}visitStringLiteralExpr(e,t){}visitObjectLiteralExpr(e,t){}visitVarExpr(e,t){t.properties.add(e.name)}visitHasAttributeExpr(e,t){t.properties.add(e.name)}visitCallExpr(e,t){switch(e.args.forEach((e=>e.accept(this,t))),e.op){case"dynamic-properties":t.volatile=!0;break;case"feature-state":t.featureState=!0,t.properties.add("$state"),t.properties.add("$id");break;case"id":t.properties.add("$id");break;case"zoom":case"world-ppi-scale":case"world-discrete-ppi-scale":t.properties.add("$zoom");break;case"geometry-type":t.properties.add("$geometryType")}}visitMatchExpr(e,t){e.value.accept(this,t),e.branches.forEach((([e,r])=>r.accept(this,t))),e.fallback.accept(this,t)}visitCaseExpr(e,t){e.branches.forEach((([e,r])=>{e.accept(this,t),r.accept(this,t)})),e.fallback.accept(this,t)}visitStepExpr(e,t){e.input.accept(this,t),e.defaultValue.accept(this,t),e.stops.forEach((([e,r])=>r.accept(this,t)))}visitInterpolateExpr(e,t){e.input.accept(this,t),e.stops.forEach((([e,r])=>r.accept(this,t)))}}function g(e){return Array.isArray(e)&&e.length>0&&"string"==typeof e[0]}var v;m.instance=new m,t.isJsonExpr=g,function(e){e[e.Value=0]="Value",e[e.Condition=1]="Condition",e[e.Dynamic=2]="Dynamic"}(v=t.ExprScope||(t.ExprScope={}));class y{static isExpr(e){return e instanceof y}static parse(e){return new l.ExprParser(e).parse()}static fromJSON(e,t,r){return D(e,void 0!==t?{definitions:t,lockedNames:new Set,cache:null!=r?r:new Map}:void 0)}evaluate(e,t=v.Value,r){return this.accept(d,new s.ExprEvaluatorContext(d,e,t,r))}instantiate(e){return this.accept(f,e)}dependencies(){return this.m_dependencies||(this.m_dependencies=m.of(this)),this.m_dependencies}intern(e){return e.add(this)}toJSON(){return(new R).serialize(this)}isDynamic(){return void 0===this.m_isDynamic&&(this.m_isDynamic=this.exprIsDynamic()),this.m_isDynamic}}t.Expr=y;class x extends y{constructor(e){super(),this.name=e}accept(e,t){return e.visitVarExpr(this,t)}exprIsDynamic(){return!1}}t.VarExpr=x;class _ extends y{static fromValue(e){switch(typeof e){case"boolean":return new w(e);case"number":return new E(e);case"string":return new S(e);case"object":return null===e?b.instance:new M(e);default:throw new Error(`failed to create a literal from '${e}'`)}}exprIsDynamic(){return!1}}t.LiteralExpr=_;class b extends _{constructor(){super(),this.value=null}accept(e,t){return e.visitNullLiteralExpr(this,t)}exprIsDynamic(){return!1}}t.NullLiteralExpr=b,b.instance=new b;class w extends _{constructor(e){super(),this.value=e}accept(e,t){return e.visitBooleanLiteralExpr(this,t)}}t.BooleanLiteralExpr=w;class E extends _{constructor(e){super(),this.value=e}accept(e,t){return e.visitNumberLiteralExpr(this,t)}}t.NumberLiteralExpr=E;class S extends _{constructor(e){super(),this.value=e}get promotedValue(){var e,t,r;return void 0===this.m_promotedValue&&(this.m_promotedValue=null!==(t=null!==(e=h.RGBA.parse(this.value))&&void 0!==e?e:c.Pixels.parse(this.value))&&void 0!==t?t:null),null!==(r=this.m_promotedValue)&&void 0!==r?r:void 0}accept(e,t){return e.visitStringLiteralExpr(this,t)}}t.StringLiteralExpr=S;class M extends _{constructor(e){super(),this.value=e}get isArrayLiteral(){return Array.isArray(this.value)}accept(e,t){return e.visitObjectLiteralExpr(this,t)}}t.ObjectLiteralExpr=M;class T extends y{constructor(e){super(),this.name=e}accept(e,t){return e.visitHasAttributeExpr(this,t)}exprIsDynamic(){return!1}}t.HasAttributeExpr=T;class P extends y{constructor(e,t){super(),this.op=e,this.args=t}get children(){return this.args}accept(e,t){return e.visitCallExpr(this,t)}exprIsDynamic(){var e;const t=null!==(e=this.descriptor)&&void 0!==e?e:s.ExprEvaluator.getOperator(this.op);return!!(t&&t.isDynamicOperator&&t.isDynamicOperator(this))||this.args.some((e=>e.isDynamic()))}}t.CallExpr=P;class A extends y{constructor(e,t,r){super(),this.value=e,this.branches=t,this.fallback=r}static isValidMatchLabel(e){switch(typeof e){case"number":case"string":return!0;case"object":if(!Array.isArray(e)||0===e.length)return!1;const t=typeof e[0];return("number"===t||"string"===t)&&e.every((e=>typeof e===t));default:return!1}}accept(e,t){return e.visitMatchExpr(this,t)}exprIsDynamic(){return this.value.isDynamic()||this.branches.some((([e,t])=>t.isDynamic()))||this.fallback.isDynamic()}}t.MatchExpr=A;class L extends y{constructor(e,t){super(),this.branches=e,this.fallback=t}accept(e,t){return e.visitCaseExpr(this,t)}exprIsDynamic(){return this.branches.some((([e,t])=>e.isDynamic()||t.isDynamic()))||this.fallback.isDynamic()}}t.CaseExpr=L;class C extends y{constructor(e,t,r){super(),this.input=e,this.defaultValue=t,this.stops=r}accept(e,t){return e.visitStepExpr(this,t)}exprIsDynamic(){return this.input.isDynamic()||this.defaultValue.isDynamic()||this.stops.some((([e,t])=>t.isDynamic()))}}t.StepExpr=C;class O extends y{constructor(e,t,r){super(),this.mode=e,this.input=t,this.stops=r}accept(e,t){return e.visitInterpolateExpr(this,t)}exprIsDynamic(){return this.input.isDynamic()||this.stops.some((([e,t])=>t.isDynamic()))}}t.InterpolateExpr=O;class R{serialize(e){return e.accept(this,void 0)}visitNullLiteralExpr(e,t){return null}visitBooleanLiteralExpr(e,t){return e.value}visitNumberLiteralExpr(e,t){return e.value}visitStringLiteralExpr(e,t){return e.value}visitObjectLiteralExpr(e,t){return e.value instanceof o.Vector2?["make-vector",e.value.x,e.value.y]:e.value instanceof o.Vector3?["make-vector",e.value.x,e.value.y,e.value.z]:e.value instanceof o.Vector4?["make-vector",e.value.x,e.value.y,e.value.z,e.value.w]:["literal",e.value]}visitVarExpr(e,t){return["get",e.name]}visitHasAttributeExpr(e,t){return["has",e.name]}visitCallExpr(e,t){return[e.op,...e.args.map((e=>this.serialize(e)))]}visitMatchExpr(e,t){const r=[];for(const[t,i]of e.branches)r.push(t,this.serialize(i));return["match",this.serialize(e.value),...r,this.serialize(e.fallback)]}visitCaseExpr(e,t){const r=[];for(const[t,i]of e.branches)r.push(this.serialize(t),this.serialize(i));return["case",...r,this.serialize(e.fallback)]}visitStepExpr(e,t){const r=["step"];return r.push(this.serialize(e.input)),r.push(this.serialize(e.defaultValue)),e.stops.forEach((([e,t])=>{r.push(e),r.push(this.serialize(t))})),r}visitInterpolateExpr(e,t){const r=["interpolate",e.mode];return r.push(this.serialize(e.input)),e.stops.forEach((([e,t])=>{r.push(e),r.push(this.serialize(t))})),r}}function D(e,t){if(Array.isArray(e))return I(e,t);if(null===e)return b.instance;if("boolean"==typeof e)return new w(e);if("number"==typeof e)return new E(e);if("string"==typeof e)return new S(e);throw new Error(`failed to create expression from: ${JSON.stringify(e)}`)}function I(e,t){const r=e[0];if("string"!=typeof r)throw new Error("expected a builtin function name");switch(r){case"!has":case"!in":return new P("!",[I([r.slice(1),...e.slice(1)])]);case"ref":return function(e,t){if("string"!=typeof e[1])throw new Error("expected the name of an attribute");if(void 0===t)throw new Error("ref used with no definitions");const r=e[1];if(t.lockedNames.has(r))throw new Error(`circular referene to '${r}'`);if(!(r in t.definitions))throw new Error(`definition '${r}' not found`);const i=t.cache.get(r);if(void 0!==i)return i;let n,o=t.definitions[r];if(u.isInterpolatedPropertyDefinition(o.value))return y.fromJSON(u.interpolatedPropertyDefinitionToJsonExpr(o.value));if(!g(o.value))return y.fromJSON(o.value);if(o=o.value,!g(o))throw new Error(`unsupported definition ${r}`);t.lockedNames.add(r);try{n=D(o,t)}finally{t.lockedNames.delete(r)}return t.cache.set(r,n),n}(e,t);case"get":return function(e,t){if(void 0!==e[2])return F("get",e,t);const r=e[1];if("string"!=typeof r)throw new Error("expected the name of an attribute");return new x(r)}(e,t);case"has":return function(e,t){if(void 0!==e[2])return F("has",e,t);const r=e[1];if("string"!=typeof r)throw new Error("expected the name of an attribute");return new T(r)}(e,t);case"literal":return function(e){const t=e[1];if(null===t||"object"!=typeof t)throw new Error("expected an object or array literal");return new M(t)}(e);case"match":return function(e,t){if(e.length<4)throw new Error("not enough arguments");if(!(e.length%2))throw new Error("fallback is missing in 'match' expression");const r=D(e[1],t),i=[];for(let r=2;r<e.length-1;r+=2){const n=e[r];if(!A.isValidMatchLabel(n))throw new Error(`'${JSON.stringify(n)}' is not a valid label for 'match'`);const o=D(e[r+1],t);i.push([n,o])}const n=D(e[e.length-1],t);return new A(r,i,n)}(e,t);case"case":return function(e,t){if(e.length<3)throw new Error("not enough arguments");if(e.length%2)throw new Error("fallback is missing in 'case' expression");const r=[];for(let i=1;i<e.length-1;i+=2){const n=D(e[i],t),o=D(e[i+1],t);r.push([n,o])}const i=D(e[e.length-1],t);return new L(r,i)}(e,t);case"interpolate":return function(e,t){const r=e[1];if(!function(e){if(!Array.isArray(e))return!1;switch(e[0]){case"discrete":case"linear":case"cubic":case"exponential":return!0;default:return!1}}(r))throw new Error("expected an interpolation type");if("exponential"===r[0]&&"number"!=typeof r[1])throw new Error("expected the base of the exponential interpolation");const i=void 0!==e[2]?D(e[2],t):void 0;if(!y.isExpr(i))throw new Error("expected the input of the interpolation");if(3===e.length||!(e.length%2))throw new Error("invalid number of samples");const n=[];for(let r=3;r<e.length-1;r+=2){const i=e[r],o=D(e[r+1],t);n.push([i,o])}return new O(r,i,n)}(e,t);case"step":return function(e,t){if(e.length<2)throw new Error("expected the input of the 'step' operator");if(e.length<3||!(e.length%2))throw new Error("not enough arguments");const r=D(e[1],t),i=D(e[2],t),n=[];for(let r=3;r<e.length;r+=2){const i=e[r],o=D(e[r+1],t);n.push([i,o])}return new C(r,i,n)}(e,t);default:return F(r,e,t)}}function F(e,t,r){return new P(e,t.slice(1).map((e=>D(e,r))))}},2344:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ExprEvaluator=t.ExprEvaluatorContext=void 0;const i=r(4428),n=r(8937),o=r(6075),s=r(2099),a=r(8210),l=r(7922),u=r(7877),c=r(8146),h=r(1139),d=r(1701),f=r(4292),p=r(9156),m=r(9388),g=r(8992),v=r(2273),y=r(5997),x=r(5795),_=new Map;function b(e,t){var r,i,o;if(t instanceof n.StringLiteralExpr)return null!==(r=t.promotedValue)&&void 0!==r?r:t.value;const s=e.evaluate(t);return"string"==typeof s&&null!==(o=null!==(i=x.RGBA.parse(s))&&void 0!==i?i:y.Pixels.parse(s))&&void 0!==o?o:s}t.ExprEvaluatorContext=class{constructor(e,t,r,i){this.evaluator=e,this.env=t,this.scope=r,this.cache=i}evaluate(e){var t,r;if(void 0===e)throw new Error("Failed to evaluate expression");const i=null===(t=this.cache)||void 0===t?void 0:t.get(e);if(void 0!==i)return i;const n=e.accept(this.evaluator,this);return null===(r=this.cache)||void 0===r||r.set(e,n),n}wrapValue(e){return n.Expr.isExpr(e)?e:n.LiteralExpr.fromValue(e)}};class w{static defineOperator(e,t){_.set(e,t)}static defineOperators(e){Object.getOwnPropertyNames(e).forEach((t=>{this.defineOperator(t,e[t])}))}static getOperator(e){return _.get(e)}visitVarExpr(e,t){const r=t.env.lookup(e.name);return void 0!==r?r:null}visitNullLiteralExpr(e,t){return null}visitBooleanLiteralExpr(e,t){return e.value}visitNumberLiteralExpr(e,t){return e.value}visitStringLiteralExpr(e,t){return e.value}visitObjectLiteralExpr(e,t){return e.value}visitHasAttributeExpr(e,t){return void 0!==t.env.lookup(e.name)}visitMatchExpr(e,t){const r=t.evaluate(e.value);for(const[i,n]of e.branches){if(Array.isArray(i)&&i.includes(r))return t.evaluate(n);if(i===r)return t.evaluate(n)}return t.evaluate(e.fallback)}visitCaseExpr(e,t){if(t.scope===n.ExprScope.Value){const r=e.branches.findIndex((([e,t])=>e.isDynamic()));if(-1!==r){let i;for(let o=0;o<e.branches.length;++o){const[s,a]=e.branches[o],l=t.evaluate(s),u=t.evaluate(a);if(o<r&&Boolean(l))return u;if((n.Expr.isExpr(l)||Boolean(l))&&(void 0===i&&(i=[]),null==i||i.push([t.wrapValue(l),t.wrapValue(u)]),!n.Expr.isExpr(l)&&Boolean(l)))return new n.CaseExpr(i,n.LiteralExpr.fromValue(null))}const o=t.evaluate(e.fallback);return void 0===i?o:new n.CaseExpr(i,t.wrapValue(o))}}for(const[r,i]of e.branches)if(t.evaluate(r))return t.evaluate(i);return t.evaluate(e.fallback)}visitCallExpr(e,t){var r;const i=null!==(r=e.descriptor)&&void 0!==r?r:_.get(e.op);if(i){let r;if(e.descriptor=i,t.scope===n.ExprScope.Value&&e.isDynamic()){if(e.descriptor.partialEvaluate)return e.descriptor.partialEvaluate(t,e);const i=e.args.map((e=>t.wrapValue(t.evaluate(e))));if(i.every(((t,r)=>t===e.args[r])))return e;r=new n.CallExpr(e.op,i)}else r=i.call(t,e);return r}throw new Error(`undefined operator '${e.op}'`)}visitStepExpr(e,t){if(t.scope===n.ExprScope.Value){const r=t.evaluate(e.input),i=t.evaluate(e.defaultValue);return new n.StepExpr(t.wrapValue(r),t.wrapValue(i),e.stops.map((([e,r])=>{const i=t.evaluate(r);return[e,t.wrapValue(i)]})))}{const r=t.evaluate(e.input);if("number"!=typeof r)throw new Error(`input '${r}' must be a number`);if(r<e.stops[0][0])return t.evaluate(e.defaultValue);let i=e.stops.findIndex((e=>e[0]>r));return-1===i&&(i=e.stops.length),t.evaluate(e.stops[i-1][1])}}visitInterpolateExpr(e,t){if(t.scope===n.ExprScope.Value){const r=t.evaluate(e.input);return new n.InterpolateExpr(e.mode,t.wrapValue(r),e.stops.map((([e,r])=>{const i=t.evaluate(r);return[e,t.wrapValue(i)]})))}{const r=t.evaluate(e.input);if("number"!=typeof r)throw new Error("input must be a number");if("cubic"===e.mode[0])return function(e,t,r){if(r<t.stops[0][0])return b(e,t.stops[0][1]);if(r>=t.stops[t.stops.length-1][0])return b(e,t.stops[t.stops.length-1][1]);const n=t.stops.findIndex((e=>e[0]>r)),o=Math.max(0,n-1),s=0===o?n:o-1,a=n<t.stops.length-1?n+1:n-1,l=t.stops[s][0],u=t.stops[o][0],c=t.stops[n][0],h=.5*(c-u),d=h/(u-l),f=h/(t.stops[a][0]-c),p=(r-u)/(c-u),m=p*p,g=m*p,v=-d*g+2*d*m-d*p,_=(1+d)*g+(-1.5-2*d)*m+(-.5+d)*p+1,w=(-1-f)*g+(1.5+f)*m+.5*p,E=f*g-f*m,S=b(e,t.stops[s][1]),M=b(e,t.stops[o][1]),T=b(e,t.stops[n][1]),P=b(e,t.stops[a][1]);if("number"==typeof S&&"number"==typeof M&&"number"==typeof T&&"number"==typeof P)return v*S+_*M+w*T+E*P;if(S instanceof x.RGBA&&M instanceof x.RGBA&&T instanceof x.RGBA&&P instanceof x.RGBA)return new x.RGBA(i.MathUtils.clamp(v*S.r+_*M.r+w*T.r+E*P.r,0,1),i.MathUtils.clamp(v*S.g+_*M.g+w*T.g+E*P.g,0,1),i.MathUtils.clamp(v*S.b+_*M.b+w*T.b+E*P.b,0,1),i.MathUtils.clamp(v*S.a+_*M.a+w*T.a+E*P.a,0,1));if(S instanceof y.Pixels&&M instanceof y.Pixels&&T instanceof y.Pixels&&P instanceof y.Pixels)return new y.Pixels(v*S.value+_*M.value+w*T.value+E*P.value);if(S instanceof i.Color&&M instanceof i.Color&&T instanceof i.Color&&P instanceof i.Color)return new i.Color(v*S.r+_*M.r+w*T.r+E*P.r,v*S.g+_*M.g+w*T.g+E*P.g,v*S.b+_*M.b+w*T.b+E*P.b);if(S instanceof i.Vector2&&M instanceof i.Vector2&&T instanceof i.Vector2&&P instanceof i.Vector2)return new i.Vector2(v*S.x+_*M.x+w*T.x+E*P.x,v*S.y+_*M.y+w*T.y+E*P.y);if(S instanceof i.Vector3&&M instanceof i.Vector3&&T instanceof i.Vector3&&P instanceof i.Vector3)return new i.Vector3(v*S.x+_*M.x+w*T.x+E*P.x,v*S.y+_*M.y+w*T.y+E*P.y,v*S.z+_*M.z+w*T.z+E*P.z);if(S instanceof i.Vector4&&M instanceof i.Vector4&&T instanceof i.Vector4&&P instanceof i.Vector4)return new i.Vector4(v*S.x+_*M.x+w*T.x+E*P.x,v*S.y+_*M.y+w*T.y+E*P.y,v*S.z+_*M.z+w*T.z+E*P.z,v*S.w+_*M.w+w*T.w+E*P.w);if(Array.isArray(S)&&Array.isArray(M)&&Array.isArray(T)&&Array.isArray(P)){const e=S.length,t=[];for(let r=0;r<e;++r)t[r]=v*S[r]+_*M[r]+w*T[r]+E*P[r];return t}throw new Error("failed to interpolate values")}(t,e,r);const n=e.stops.findIndex((e=>e[0]>r));if(-1===n)return t.evaluate(e.stops[e.stops.length-1][1]);if(0===n)return t.evaluate(e.stops[0][1]);const[o,s]=e.stops[n],[a,l]=e.stops[n-1],u=b(t,l);let c=0;switch(e.mode[0]){case"discrete":return u;case"linear":c=(r-a)/(o-a);break;case"exponential":{const t=e.mode[1];c=1===t?(r-a)/(o-a):(Math.pow(t,r-a)-1)/(Math.pow(t,o-a)-1);break}default:throw new Error(`interpolation mode ${JSON.stringify(e.mode)} is not supported`)}const h=b(t,s);if("number"==typeof u&&"number"==typeof h)return i.MathUtils.lerp(u,h,c);if(u instanceof x.RGBA&&h instanceof x.RGBA)return u.clone().lerp(h,c);if(u instanceof y.Pixels&&h instanceof y.Pixels)return new y.Pixels(i.MathUtils.lerp(u.value,h.value,c));if(u instanceof i.Color&&h instanceof i.Color)return u.clone().lerp(h,c);if(u instanceof i.Vector2&&h instanceof i.Vector2)return u.clone().lerp(h,c);if(u instanceof i.Vector3&&h instanceof i.Vector3)return u.clone().lerp(h,c);if(u instanceof i.Vector4&&h instanceof i.Vector4)return u.clone().lerp(h,c);if(Array.isArray(u)&&Array.isArray(h)&&u.length===h.length)return u.map(((e,t)=>i.MathUtils.lerp(e,h[t],c)));throw new Error(`todo: mix(${JSON.stringify(u)}, ${JSON.stringify(h)}, ${c})`)}}}t.ExprEvaluator=w,w.defineOperators(s.CastOperators),w.defineOperators(l.ComparisonOperators),w.defineOperators(d.MathOperators),w.defineOperators(m.StringOperators),w.defineOperators(a.ColorOperators),w.defineOperators(g.TypeOperators),w.defineOperators(f.MiscOperators),w.defineOperators(c.FlowOperators),w.defineOperators(o.ArrayOperators),w.defineOperators(p.ObjectOperators),w.defineOperators(u.FeatureOperators),w.defineOperators(h.MapOperators),w.defineOperators(v.VectorOperators)},5318:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ExprInstantiator=void 0;const i=r(9415),n=r(8937),o=new i.Env;t.ExprInstantiator=class{visitNullLiteralExpr(e,t){return e}visitBooleanLiteralExpr(e,t){return e}visitNumberLiteralExpr(e,t){return e}visitStringLiteralExpr(e,t){return e}visitObjectLiteralExpr(e,t){return e}visitVarExpr(e,t){if(t.preserve&&t.preserve.has(e.name))return e;const r=t.env.lookup(e.name);return n.LiteralExpr.fromValue(void 0!==r?r:null)}visitHasAttributeExpr(e,t){if(t.preserve&&t.preserve.has(e.name))return e;const r=void 0!==t.env.lookup(e.name);return n.LiteralExpr.fromValue(r)}visitCallExpr(e,t){const r=e.args.map((e=>e.accept(this,t)));return r.some(((t,r)=>t!==e.args[r]))?new n.CallExpr(e.op,r):e}visitMatchExpr(e,t){const r=e.value.accept(this,t);if(r instanceof n.LiteralExpr){const i=r.value;for(const[r,n]of e.branches){if(Array.isArray(r)&&r.includes(i))return n.accept(this,t);if(r===i)return n.accept(this,t)}return e.fallback.accept(this,t)}let i=e.value!==r;const o=e.branches.map((([e,r])=>{const n=r.accept(this,t);return n!==r&&(i=!0),[e,n]})),s=e.fallback.accept(this,t);return s!==e.fallback&&(i=!0),i?new n.MatchExpr(r,o,s):e}visitCaseExpr(e,t){const r=[];let i=!1;for(const[s,a]of e.branches){const e=s.accept(this,t),l=e.dependencies();if(s.isDynamic()||0!==l.properties.size)e!==s&&(i=!0),r.push([e,a]);else if(Boolean(e.evaluate(o,n.ExprScope.Condition)))return a.accept(this,t)}if(0===r.length)return e.fallback.accept(this,t);r.length!==e.branches.length&&(i=!0),r.forEach((e=>{const r=e[1].accept(this,t);r!==e[1]&&(i=!0),e[1]=r}));const s=e.fallback.accept(this,t);return s!==e.fallback&&(i=!0),i?new n.CaseExpr(r,s):e}visitStepExpr(e,t){const r=e.input.accept(this,t),i=e.defaultValue.accept(this,t),o=e.stops.map((([e,r])=>[e,r.accept(this,t)]));return new n.StepExpr(r,i,o)}visitInterpolateExpr(e,t){const r=e.input.accept(this,t),i=e.stops.map((([e,r])=>[e,r.accept(this,t)]));return new n.InterpolateExpr(e.mode,r,i)}}},4973:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ExprParser=void 0;const i=r(8937);var n,o;function s(e){switch(e){case n.Tab:case n.Lf:case n.Cr:case n.Space:return!0;default:return!1}}function a(e){return e>=n._0&&e<=n._9}function l(e){return e>=n.a&&e<=n.z||e>=n.A&&e<=n.Z}function u(e){return function(e){return l(e)||a(e)}(e)||e===n._||e===n.Dollar||e===n.Dot||e===n.LBracket||e===n.RBracket}function c(e){switch(e){case o.Eof:return"eof";case o.Error:return"error";case o.Identifier:return"identifier";case o.Number:return"number";case o.String:return"string";case o.Comma:return",";case o.LParen:return"(";case o.RParen:return")";case o.LBracket:return"[";case o.RBracket:return"]";case o.Exclaim:return"!";case o.TildeEqual:return"~=";case o.CaretEqual:return"^=";case o.DollarEqual:return"$=";case o.EqualEqual:return"==";case o.ExclaimEqual:return"!=";case o.Less:return"<";case o.Greater:return">";case o.LessEqual:return"<=";case o.GreaterEqual:return">=";case o.BarBar:return"||";case o.AmpAmp:return"&&";default:throw new Error(`invalid token ${e}`)}}!function(e){e[e.Tab=9]="Tab",e[e.Lf=10]="Lf",e[e.Cr=13]="Cr",e[e.Space=32]="Space",e[e.LParen=40]="LParen",e[e.RParen=41]="RParen",e[e.Comma=44]="Comma",e[e.Dot=46]="Dot",e[e.LBracket=91]="LBracket",e[e.Backslash=92]="Backslash",e[e.RBracket=93]="RBracket",e[e._0=48]="_0",e[e._9=57]="_9",e[e._=95]="_",e[e.A=64]="A",e[e.Z=90]="Z",e[e.a=97]="a",e[e.z=122]="z",e[e.DoubleQuote=34]="DoubleQuote",e[e.SingleQuote=39]="SingleQuote",e[e.Exclaim=33]="Exclaim",e[e.Equal=61]="Equal",e[e.Caret=94]="Caret",e[e.Tilde=126]="Tilde",e[e.Dollar=36]="Dollar",e[e.Less=60]="Less",e[e.Greater=62]="Greater",e[e.Bar=124]="Bar",e[e.Amp=38]="Amp"}(n||(n={})),function(e){e[e.Eof=0]="Eof",e[e.Error=1]="Error",e[e.Identifier=2]="Identifier",e[e.Number=3]="Number",e[e.String=4]="String",e[e.Comma=5]="Comma",e[e.LParen=6]="LParen",e[e.RParen=7]="RParen",e[e.LBracket=8]="LBracket",e[e.RBracket=9]="RBracket",e[e.Exclaim=10]="Exclaim",e[e.TildeEqual=11]="TildeEqual",e[e.CaretEqual=12]="CaretEqual",e[e.DollarEqual=13]="DollarEqual",e[e.EqualEqual=14]="EqualEqual",e[e.ExclaimEqual=15]="ExclaimEqual",e[e.Less=16]="Less",e[e.Greater=17]="Greater",e[e.LessEqual=18]="LessEqual",e[e.GreaterEqual=19]="GreaterEqual",e[e.BarBar=20]="BarBar",e[e.AmpAmp=21]="AmpAmp"}(o||(o={}));class h{constructor(e){this.code=e,this.m_token=o.Error,this.m_index=0,this.m_char=n.Lf}token(){return this.m_token}text(){var e;return null!==(e=this.m_text)&&void 0!==e?e:""}next(){if(this.m_token=this.yylex(),this.m_token===o.Error)throw new Error(`unexpected character ${this.m_char}`);return this.m_token}yyinp(){var e;this.m_char=null!==(e=this.code.codePointAt(this.m_index++))&&void 0!==e?e:0}yylex(){for(this.m_text=void 0;s(this.m_char);)this.yyinp();if(0===this.m_char)return o.Eof;const e=this.m_char;switch(this.yyinp(),e){case n.LParen:return o.LParen;case n.RParen:return o.RParen;case n.LBracket:return o.LBracket;case n.RBracket:return o.RBracket;case n.Comma:return o.Comma;case n.SingleQuote:case n.DoubleQuote:{const t=this.m_index-1;for(;this.m_char&&this.m_char!==e;)this.yyinp();if(this.m_char!==e)throw new Error("Unfinished string literal");return this.yyinp(),this.m_text=this.code.substring(t,this.m_index-2),o.String}case n.Exclaim:return this.m_char===n.Equal?(this.yyinp(),o.ExclaimEqual):o.Exclaim;case n.Caret:return this.m_char===n.Equal?(this.yyinp(),o.CaretEqual):o.Error;case n.Tilde:return this.m_char===n.Equal?(this.yyinp(),o.TildeEqual):o.Error;case n.Equal:return this.m_char===n.Equal?(this.yyinp(),o.EqualEqual):o.Error;case n.Less:return this.m_char===n.Equal?(this.yyinp(),o.LessEqual):o.Less;case n.Greater:return this.m_char===n.Equal?(this.yyinp(),o.GreaterEqual):o.Greater;case n.Bar:return this.m_char===n.Bar?(this.yyinp(),o.BarBar):o.Error;case n.Amp:return this.m_char===n.Amp?(this.yyinp(),o.AmpAmp):o.Error;default:{const t=this.m_index-2;if(l(e)||e===n._||e===n.Dollar&&u(this.m_char)){for(;u(this.m_char);)this.yyinp();return this.m_text=this.code.substring(t,this.m_index-1),o.Identifier}if(a(e)){for(;a(this.m_char);)this.yyinp();if(this.m_char===n.Dot)for(this.yyinp();a(this.m_char);)this.yyinp();return this.m_text=this.code.substring(t,this.m_index-1),o.Number}if(e===n.Dollar)return this.m_char===n.Equal?(this.yyinp(),o.DollarEqual):o.Error}}return o.Error}}function d(e){switch(e){case o.TildeEqual:return"~=";case o.CaretEqual:return"^=";case o.DollarEqual:return"$=";case o.EqualEqual:return"==";case o.ExclaimEqual:return"!=";default:return}}function f(e){switch(e){case o.Less:return"<";case o.Greater:return">";case o.LessEqual:return"<=";case o.GreaterEqual:return">=";default:return}}t.ExprParser=class{constructor(e){this.lex=new h(e),this.lex.next()}parse(){return this.parseLogicalOr()}yyexpect(e){if(this.lex.token()!==e)throw new Error(`Syntax error: Expected token '${c(e)}' but found '${c(this.lex.token())}'`);this.lex.next()}parsePrimary(){switch(this.lex.token()){case o.Identifier:{const e=this.lex.text();switch(e){case"has":this.lex.next(),this.yyexpect(o.LParen);const t=this.lex.text();return this.yyexpect(o.Identifier),this.yyexpect(o.RParen),new i.HasAttributeExpr(t);case"length":this.lex.next(),this.yyexpect(o.LParen);const r=this.parseLogicalOr();return this.yyexpect(o.RParen),new i.CallExpr("length",[r]);default:const n=new i.VarExpr(e);return this.lex.next(),n}}case o.LParen:{this.lex.next();const e=this.parseLogicalOr();return this.yyexpect(o.RParen),e}default:return this.parseLiteral()}}parseLiteral(){switch(this.lex.token()){case o.Number:{const e=new i.NumberLiteralExpr(parseFloat(this.lex.text()));return this.lex.next(),e}case o.String:{const e=new i.StringLiteralExpr(this.lex.text());return this.lex.next(),e}default:throw new Error("Syntax error")}}parseUnary(){return this.lex.token()===o.Exclaim?(this.lex.next(),new i.CallExpr("!",[this.parseUnary()])):this.parsePrimary()}parseRelational(){let e=this.parseUnary();for(;;)if(this.lex.token()===o.Identifier&&"in"===this.lex.text()){this.lex.next(),this.yyexpect(o.LBracket);const t=[this.parseLiteral()];for(;this.lex.token()===o.Comma;)this.lex.next(),t.push(this.parseLiteral());this.yyexpect(o.RBracket),e=new i.CallExpr("in",[e,i.LiteralExpr.fromValue(t.map((({value:e})=>e)))])}else{const t=f(this.lex.token());if(void 0===t)break;this.lex.next();const r=this.parseUnary();e=new i.CallExpr(t,[e,r])}return e}parseEquality(){let e=this.parseRelational();for(;;){let t=d(this.lex.token());if(void 0===t)break;"~="===t&&(t="in"),this.lex.next();const r=this.parseRelational();e=new i.CallExpr(t,[e,r])}return e}parseLogicalAnd(){const e=this.parseEquality();if(this.lex.token()!==o.AmpAmp)return e;const t=[e];do{this.lex.next(),t.push(this.parseEquality())}while(this.lex.token()===o.AmpAmp);return new i.CallExpr("all",t)}parseLogicalOr(){const e=this.parseLogicalAnd();if(this.lex.token()!==o.BarBar)return e;const t=[e];do{this.lex.next(),t.push(this.parseLogicalAnd())}while(this.lex.token()===o.BarBar);return new i.CallExpr("any",t)}}},2475:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ExprPool=void 0;const i=r(8937);t.ExprPool=class{constructor(){this.m_booleanLiterals=new Map,this.m_numberLiterals=new Map,this.m_stringLiterals=new Map,this.m_objectLiterals=new Map,this.m_arrayLiterals=[],this.m_varExprs=new Map,this.m_hasAttributeExprs=new Map,this.m_matchExprs=[],this.m_caseExprs=[],this.m_interpolateExprs=[],this.m_stepExprs=[],this.m_callExprs=new Map}add(e){return e.accept(this,void 0)}visitNullLiteralExpr(e,t){return i.NullLiteralExpr.instance}visitBooleanLiteralExpr(e,t){return this.m_booleanLiterals.get(e.value)||(this.m_booleanLiterals.set(e.value,e),e)}visitNumberLiteralExpr(e,t){return this.m_numberLiterals.get(e.value)||(this.m_numberLiterals.set(e.value,e),e)}visitStringLiteralExpr(e,t){return this.m_stringLiterals.get(e.value)||(this.m_stringLiterals.set(e.value,e),e)}visitObjectLiteralExpr(e,t){const r=this.m_objectLiterals.get(e.value);if(r)return r;if(Array.isArray(e.value)){const t=e.value,r=this.m_arrayLiterals.find((e=>{const r=e.value;return r.length===t.length&&t.every(((e,t)=>e===r[t]))}));if(void 0!==r)return r;this.m_arrayLiterals.push(e)}return this.m_objectLiterals.set(e.value,e),e}visitVarExpr(e,t){return this.m_varExprs.get(e.name)||(this.m_varExprs.set(e.name,e),e)}visitHasAttributeExpr(e,t){return this.m_hasAttributeExprs.get(e.name)||(this.m_hasAttributeExprs.set(e.name,e),e)}visitMatchExpr(e,t){const r=e.value.accept(this,t),n=e.branches.map((([e,r])=>[e,r.accept(this,t)])),o=e.fallback.accept(this,t);for(const e of this.m_matchExprs){if(e.value!==r)continue;if(e.fallback!==o)continue;if(e.branches.length!==n.length)continue;let t=!0;for(let r=0;r<n.length;r++)if(n[r][0]!==e.branches[r][0]||n[r][1]!==e.branches[r][1]){t=!1;break}if(t)return e}const s=new i.MatchExpr(r,n,o);return this.m_matchExprs.push(s),s}visitCaseExpr(e,t){const r=e.branches.map((([e,r])=>[e.accept(this,t),r.accept(this,t)])),n=e.fallback.accept(this,t);for(const e of this.m_caseExprs){if(e.fallback!==n)continue;if(e.branches.length!==r.length)continue;let t=!0;for(let i=0;i<r.length;i++)if(r[i][0]!==e.branches[i][0]||r[i][1]!==e.branches[i][1]){t=!1;break}if(t)return e}const o=new i.CaseExpr(r,n);return this.m_caseExprs.push(o),o}visitCallExpr(e,t){const r=e.args.map((e=>e.accept(this,t)));this.m_callExprs.has(e.op)||this.m_callExprs.set(e.op,[]);const n=this.m_callExprs.get(e.op);for(const e of n){if(e.args.length!==r.length)continue;let t=0;for(;t<e.args.length&&e.args[t]===r[t];++t);if(t===e.args.length)return e}const o=new i.CallExpr(e.op,r);return o.descriptor=e.descriptor,n.push(o),o}visitStepExpr(e,t){if(this.m_stepExprs.includes(e))return e;const r=e.input.accept(this,t),n=e.defaultValue.accept(this,t),o=e.stops.map((e=>{const r=e[0],i=e[1].accept(this,t);return i===e[1]?e:[r,i]}));for(const e of this.m_stepExprs)if(e.input===r&&e.defaultValue===n&&o.length===e.stops.length&&o.every((([t,r],i)=>t===e.stops[i][0]&&r===e.stops[i][1])))return e;const s=new i.StepExpr(r,n,o);return this.m_stepExprs.push(s),s}visitInterpolateExpr(e,t){if(this.m_interpolateExprs.includes(e))return e;const r=e.input.accept(this,t),n=e.stops.map((e=>{const r=e[0],i=e[1].accept(this,t);return i===e[1]?e:[r,i]}));for(const t of this.m_interpolateExprs)if(t.input===r&&t.mode[0]===e.mode[0]&&t.mode[1]===e.mode[1]&&n.length===t.stops.length&&n.every((([e,r],i)=>e===t.stops[i][0]&&r===t.stops[i][1])))return t;const o=new i.InterpolateExpr(e.mode,r,n);return this.m_interpolateExprs.push(o),o}}},6665:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isFeatureGeometry=void 0,t.isFeatureGeometry=function(e){const t=e.type;return"Point"===t||"MultiPoint"===t||"LineString"===t||"MultiLineString"===t||"Polygon"===t||"MultiPolygon"===t}},1470:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},7954:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},1460:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},2904:(e,t)=>{"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.interpolatedPropertyDefinitionToJsonExpr=t.isInterpolatedPropertyDefinition=t.InterpolationMode=void 0,(r=t.InterpolationMode||(t.InterpolationMode={}))[r.Discrete=0]="Discrete",r[r.Linear=1]="Linear",r[r.Cubic=2]="Cubic",r[r.Exponential=3]="Exponential",t.isInterpolatedPropertyDefinition=function(e){return!!(e&&void 0===e.interpolationMode&&Array.isArray(e.values)&&e.values.length>0&&void 0!==e.values[0]&&Array.isArray(e.zoomLevels)&&e.zoomLevels.length>0&&void 0!==e.zoomLevels[0]&&e.values.length===e.zoomLevels.length)},t.interpolatedPropertyDefinitionToJsonExpr=function(e){if(void 0===e.interpolation||"Discrete"===e.interpolation){const t=["step",["zoom"],e.values[0]];for(let r=1;r<e.zoomLevels.length;++r)t.push(e.zoomLevels[r],e.values[r]);return t}const t=["interpolate"];switch(e.interpolation){case"Linear":t.push(["linear"]);break;case"Cubic":t.push(["cubic"]);break;case"Exponential":t.push(["exponential",void 0!==e.exponent?e.exponent:2]);break;default:throw new Error(`interpolation mode '${e.interpolation}' is not supported`)}t.push(["zoom"]);for(let r=0;r<e.zoomLevels.length;++r)t.push(e.zoomLevels[r],e.values[r]);return t}},9416:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.addPolygonEdges=void 0;const i=r(4428),n=new i.Vector2,o=new i.Vector2,s=new i.Vector2,a=new i.Vector2;t.addPolygonEdges=function(e,t,r,i,l,u,c,h){for(let d=0;d<l.length;++d)if(l[d])if(!0===u){const u=t+2*d,f=u+1,p=t+(d+1)%l.length*2,m=p+1;!0===c&&e.push(u,p),e.push(f,m);const g=(0===d?l.length:d)-1;if(l[g])if(void 0!==h){const t=i[d*r],c=i[d*r+1],p=i[(d+1)%l.length*r],m=i[(d+1)%l.length*r+1];n.set(t,c),o.set(p,m),s.set(i[g*r],i[g*r+1]),a.set(n.x,n.y),a.sub(s).normalize().dot(o.sub(n).normalize())<=h&&e.push(u,f)}else e.push(u,f)}else{const r=t+d,i=t+(d+1)%l.length;e.push(r,i)}}},5997:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Pixels=void 0;const r=/^((?=\.\d|\d)(?:\d+)?(?:\.?\d*))px$/;class i{constructor(e){this.value=e}static parse(e){const t=r.exec(e);if(null!==t)return new i(Number(t[1]))}toJSON(){return`${this.value}px`}}t.Pixels=i},6792:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},7487:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getPropertyValue=void 0;const i=r(3333),n=r(8937),o=r(5997),s=r(5795),a=r(8783),l=i.LoggerManager.instance.create("PropertyValue");t.getPropertyValue=function(e,t,r){var i,u,c;if(n.Expr.isExpr(e))try{let a=e.evaluate(t,n.ExprScope.Dynamic,r);return"string"==typeof a&&(a=null!==(u=null!==(i=s.RGBA.parse(a))&&void 0!==i?i:o.Pixels.parse(a))&&void 0!==u?u:a),a instanceof s.RGBA?a.getHex():a instanceof o.Pixels?a.value*(null!==(c=Number(t.lookup("$pixelToMeters")))&&void 0!==c?c:1):a}catch(t){return l.error("failed to evaluate expression",JSON.stringify(e),"error",String(t)),null}if(null==e)return null;if("string"!=typeof e)return e;{const r=t.lookup("$pixelToMeters")||1,i=a.parseStringEncodedNumeral(e,r);return void 0!==i?i:e}}},5795:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RGBA=void 0;const i=r(4428),n=r(4482),o=r(8783);class s{constructor(e=1,t=1,r=1,i=1){this.r=e,this.g=t,this.b=r,this.a=i}static parse(e){const t=o.parseStringEncodedColor(e);if(void 0!==t)return n.ColorUtils.getRgbaFromHex(t)}clone(){return new s(this.r,this.g,this.b,this.a)}getHex(){return n.ColorUtils.getHexFromRgba(this.r,this.g,this.b,this.a)}lerp(e,t){return this.r=i.MathUtils.lerp(this.r,e.r,t),this.g=i.MathUtils.lerp(this.g,e.g,t),this.b=i.MathUtils.lerp(this.b,e.b,t),this.a=i.MathUtils.lerp(this.a,e.a,t),this}toJSON(){return`rgba(${255*this.r<<0}, ${255*this.g<<0}, ${255*this.b<<0}, ${this.a})`}}t.RGBA=s},8783:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseStringEncodedColor=t.parseStringEncodedNumeral=t.StringEncodedNumeralFormatMaxSize=t.StringEncodedNumeralFormats=t.StringEncodedColorFormats=t.StringEncodedMetricFormats=t.StringEncodedNumeralType=void 0;const i=r(3333),n=r(2058),o=r(4482);var s;!function(e){e[e.Meters=0]="Meters",e[e.Pixels=1]="Pixels",e[e.Hex=2]="Hex"}(s=t.StringEncodedNumeralType||(t.StringEncodedNumeralType={}));const a={type:s.Meters,size:1,regExp:/^((?=\.\d|\d)(?:\d+)?(?:\.?\d*))m$/,decoder:(e,t)=>{const r=a.regExp.exec(e);return!!r&&void 0!==(t[0]=Number(r[1]))}},l={type:s.Pixels,size:1,mask:1,regExp:/^((?=\.\d|\d)(?:\d+)?(?:\.?\d*))px$/,decoder:(e,t)=>{const r=l.regExp.exec(e);return null!==r&&(t[0]=Number(r[1]),!0)}},u={type:s.Hex,size:4,regExp:/^\#((?:[0-9A-Fa-f][0-9A-Fa-f]){4}|[0-9A-Fa-f]{4})$/,decoder:(e,t)=>{const r=u.regExp.exec(e);if(null===r)return!1;const n=r[1],o=n.length;return i.assert(4===o||8===o,"Matched incorrect hex color format"),4===o?(t[0]=parseInt(n.charAt(0)+n.charAt(0),16)/255,t[1]=parseInt(n.charAt(1)+n.charAt(1),16)/255,t[2]=parseInt(n.charAt(2)+n.charAt(2),16)/255,t[3]=4===o?parseInt(n.charAt(3)+n.charAt(3),16)/255:1):8===o&&(t[0]=parseInt(n.charAt(0)+n.charAt(1),16)/255,t[1]=parseInt(n.charAt(2)+n.charAt(3),16)/255,t[2]=parseInt(n.charAt(4)+n.charAt(5),16)/255,t[3]=8===o?parseInt(n.charAt(6)+n.charAt(7),16)/255:1),!0}};t.StringEncodedMetricFormats=[a,l];const c=t.StringEncodedMetricFormats.reduce(((e,t)=>Math.max(e,t.size)),0);t.StringEncodedColorFormats=[u];const h=t.StringEncodedColorFormats.reduce(((e,t)=>Math.max(e,t.size)),0);t.StringEncodedNumeralFormats=[...t.StringEncodedMetricFormats,...t.StringEncodedColorFormats],t.StringEncodedNumeralFormatMaxSize=Math.max(h,c);const d=new Array(t.StringEncodedNumeralFormatMaxSize);function f(e,t,r=1){const i=t.find((t=>!!t.decoder(e,d)));if(void 0===i){const t=n.parseCSSColor(e);return Array.isArray(t)&&!t.some((e=>isNaN(e)))?o.ColorUtils.getHexFromRgba(t[0]/255,t[1]/255,t[2]/255,t[3]):void 0}switch(null==i?void 0:i.type){case s.Pixels:return d[0]*r;case s.Hex:return o.ColorUtils.getHexFromRgba(d[0],d[1],d[2],d[3]);default:return d[0]}}t.parseStringEncodedNumeral=function(e,r=1){return f(e,t.StringEncodedNumeralFormats,r)},t.parseStringEncodedColor=function(e){return f(e,t.StringEncodedColorFormats)}},5257:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeDecodedTechnique=t.StyleSetEvaluator=void 0;const i=r(3333),n=r(8937),o=r(2475),s=r(2904),a=r(6671),l=r(7828),u=i.LoggerManager.instance.create("StyleSetEvaluator"),c=a.AttrScope.TechniqueGeometry;class h{classify(e){if(e._whenExpr){const t=this.switchStyle(e);e._whenExpr=e._whenExpr.accept(this,void 0),this._style=t}}visitNullLiteralExpr(e,t){return e}visitBooleanLiteralExpr(e,t){return e}visitNumberLiteralExpr(e,t){return e}visitStringLiteralExpr(e,t){return e}visitObjectLiteralExpr(e,t){return e}visitVarExpr(e,t){return e}visitHasAttributeExpr(e,t){return e}visitMatchExpr(e,t){return e}visitCaseExpr(e,t){return e}visitCallExpr(e,t){if("all"===e.op){const t=e.args.map((t=>t.accept(this,e))).filter((e=>void 0!==e));return new n.CallExpr(e.op,t)}if(t){const t=this.matchVarStringComparison(e);if(t){if(void 0===this._style.layer&&"$layer"===t.name)return void(this._style.layer=t.value);if(void 0===this._style._geometryType&&"$geometryType"===t.name)return void(this._style._geometryType=t.value)}}return e}visitStepExpr(e,t){return e}visitInterpolateExpr(e,t){return e}matchVarStringComparison(e){if("=="===e.op){const t=e.args[0],r=e.args[1];if(t instanceof n.VarExpr&&r instanceof n.StringLiteralExpr)return{name:t.name,value:r.value};if(r instanceof n.VarExpr&&t instanceof n.StringLiteralExpr)return{name:r.name,value:t.value}}}switchStyle(e){const t=this._style;return this._style=e,t}}class d{constructor(e,t){this.key="",this.set(e,t)}set(e,t,r){let i=!1;if(void 0===e){const t=void 0!==r?r.lookup("$layer"):void 0;e="string"==typeof t?t:void 0}if(this.layer!==e&&(this.layer=e,i=!0),void 0===t){const e=void 0!==r?r.lookup("$geometryType"):void 0;t="string"==typeof e?e:void 0}return this.geometryType!==t&&(this.geometryType=t,i=!0),i&&this.updateKey(),this}updateKey(){void 0!==this.layer?void 0!==this.geometryType?this.key=`${this.layer}:${this.geometryType}`:this.key=`${this.layer}:`:void 0!==this.geometryType?this.key=`:${this.geometryType}`:this.key="all",this.cachedStyleSet=void 0}}function f(e){const t={};for(const r in e){if(!e.hasOwnProperty(r))continue;let i=e[r];"object"==typeof i&&(i.isVector2||i.isVector3||i.isVector4)&&(i=n.LiteralExpr.fromValue(i)),n.Expr.isExpr(i)&&(i=i.toJSON()),t[r]=i}return t}t.StyleSetEvaluator=class{constructor(e){var t;this.m_options=e,this.m_techniques=[],this.m_exprPool=new o.ExprPool,this.m_cachedResults=new Map,this.m_styleConditionClassifier=new h,this.m_subStyleSetCache=new Map,this.m_definitionExprCache=new Map,this.m_tmpOptimizedSubSetKey=new d,this.m_emptyEnv=new n.Env,this.m_featureDependencies=[],this.m_nextArrayBufferId=0,this.m_definitions=this.m_options.definitions,this.styleSet=(t=this.m_options.styleSet,this.m_definitions,t.map((e=>function(e,t){return Object.assign({},e)}(e)))),function(e){let t=0,r=0;for(const i of e)i._styleSetIndex=r++,void 0!==i.technique&&void 0===i.renderOrder&&(i.renderOrder=t++)}(this.styleSet),this.compileStyleSet()}getMatchingTechniques(e,t,r){if(this.m_previousResult&&this.m_previousEnv&&this.m_featureDependencies.every((t=>{var r;return(null===(r=this.m_previousEnv)||void 0===r?void 0:r.lookup(t))===e.lookup(t)})))return this.m_previousResult;const i=[];this.m_cachedResults.clear();const n=this.m_tmpOptimizedSubSetKey;n.set(t,r,e),this.m_layer=n.layer,this.m_geometryType=n.geometryType,this.m_zoomLevel=e.lookup("$zoom");const o=this.getOptimizedStyleSet(n);for(const t of o)if(this.processStyle(e,t,i))break;return this.m_previousResult=i,this.m_previousEnv=e,i}wantsLayer(e){return this.getOptimizedStyleSet(this.m_tmpOptimizedSubSetKey.set(e,void 0)).length>0}wantsFeature(e,t){return this.getOptimizedStyleSet(this.m_tmpOptimizedSubSetKey.set(e,t)).length>0}get expressionEvaluatorCache(){return this.m_cachedResults}resetTechniques(){for(const e of this.m_techniques)e._index=void 0;this.m_techniques.length=0,this.m_previousResult=void 0,this.m_previousEnv=void 0}get techniques(){return this.m_techniques}get decodedTechniques(){return this.m_techniques.map(f)}getOptimizedStyleSet(e){if(void 0!==e.cachedStyleSet)return e.cachedStyleSet;let t=this.m_subStyleSetCache.get(e.key);return void 0!==t?(e.cachedStyleSet=t,t):(t=this.createPreFilteredStyleSet(e),this.m_subStyleSetCache.set(e.key,t),e.cachedStyleSet=t,t)}createPreFilteredStyleSet(e){const{layer:t,geometryType:r}=e;return this.styleSet.filter((e=>!(void 0!==t&&void 0!==e.layer&&e.layer!==t||void 0!==r&&void 0!==e._geometryType&&e._geometryType!==r)))}compileStyleSet(){this.m_featureDependencies=["$layer","$geometryType","$zoom"],this.styleSet.forEach((e=>this.compileStyle(e))),this.styleSet.forEach((e=>{this.getOptimizedStyleSet(this.m_tmpOptimizedSubSetKey.set(e.layer,e._geometryType))}))}compileStyle(e){if(this.checkStyleDynamicAttributes(e),void 0!==e.when)try{e._whenExpr=Array.isArray(e.when)?n.Expr.fromJSON(e.when,this.m_definitions,this.m_definitionExprCache):n.Expr.parse(e.when),this.m_styleConditionClassifier.classify(e),void 0!==e._whenExpr&&(e._whenExpr=e._whenExpr.intern(this.m_exprPool));const t=e._whenExpr.dependencies();null==t||t.properties.forEach((e=>{this.m_featureDependencies.includes(e)||this.m_featureDependencies.push(e)})),n.isJsonExpr(e.minZoomLevel)&&(e._minZoomLevelExpr=n.Expr.fromJSON(e.minZoomLevel).intern(this.m_exprPool)),n.isJsonExpr(e.maxZoomLevel)&&(e._maxZoomLevelExpr=n.Expr.fromJSON(e.maxZoomLevel).intern(this.m_exprPool))}catch(t){u.log("failed to evaluate expression",JSON.stringify(e.when),"error",String(t))}}processStyle(e,t,r){if(!this.checkZoomLevel(e,t))return!1;if(void 0!==this.m_layer&&void 0!==t.layer&&t.layer!==this.m_layer)return!1;if(void 0!==this.m_geometryType&&void 0!==t._geometryType&&t._geometryType!==this.m_geometryType)return!1;if(t._whenExpr)try{if(!t._whenExpr.evaluate(e,n.ExprScope.Condition,this.m_cachedResults))return!1}catch(e){return u.error(`failed to evaluate expression '${JSON.stringify(t.when)}': ${e}`),!1}return void 0!==t.technique&&("none"!==t.technique&&r.push(this.getTechniqueForStyleMatch(e,t)),!0===t.final)}checkZoomLevel(e,t){var r,i;if(void 0===t.minZoomLevel&&void 0===t.maxZoomLevel)return!0;const o=this.m_zoomLevel;if(void 0===o)return!0;if(void 0!==t.minZoomLevel){let i=t.minZoomLevel;if(!1===(null===(r=t._minZoomLevelExpr)||void 0===r?void 0:r.isDynamic()))try{i=t._minZoomLevelExpr.evaluate(e,n.ExprScope.Condition,this.m_cachedResults)}catch(e){u.error(`failed to evaluate expression '${JSON.stringify(t._minZoomLevelExpr)}': ${e}`)}if("number"==typeof i&&o<i)return!1}if(void 0!==t.maxZoomLevel){let r=t.maxZoomLevel;if(!1===(null===(i=t._maxZoomLevelExpr)||void 0===i?void 0:i.isDynamic()))try{r=t._maxZoomLevelExpr.evaluate(e,n.ExprScope.Condition,this.m_cachedResults)}catch(e){u.error(`failed to evaluate expression '${JSON.stringify(t._maxZoomLevelExpr)}': ${e}`)}if("number"==typeof r&&o>=r)return!1}return!0}getTechniqueForStyleMatch(e,t){let r;if(void 0!==t._dynamicTechniques){const i=this.evaluateTechniqueProperties(t,e),n=this.getDynamicTechniqueKey(t,i);r=t._dynamicTechniques.get(n),void 0===r&&(r=this.createTechnique(t,n,i),t._dynamicTechniques.set(n,r))}else r=t._staticTechnique,void 0===r&&(t._staticTechnique=r=this.createTechnique(t,`${t._styleSetIndex}`,[]));return void 0===r._index&&(r._index=this.m_techniques.length,this.m_techniques.push(r)),r}getDynamicTechniqueKey(e,t){const r=t.map((([e,t])=>void 0===t?"U":"object"==typeof t?JSON.stringify(t,((e,t)=>{if(t instanceof ArrayBuffer){let e=t.id;return void 0===e&&(e=t.id=this.m_nextArrayBufferId++),e}return t})):JSON.stringify(t))).join(":");return`${e._styleSetIndex}:${r}`}checkStyleDynamicAttributes(e){var t;if(void 0!==e._dynamicTechniqueAttributes||"none"===e.technique)return;e._dynamicTechniqueAttributes=[],e._dynamicFeatureAttributes=[],e._dynamicForwardedAttributes=[],e._staticAttributes=[];const r=e._dynamicFeatureAttributes,i=e._dynamicTechniqueAttributes,o=e._dynamicForwardedAttributes,l=e._staticAttributes,h=(t,h)=>{if(void 0!==h){if(n.isJsonExpr(h)?h=n.Expr.fromJSON(h,this.m_definitions,this.m_definitionExprCache).intern(this.m_exprPool):s.isInterpolatedPropertyDefinition(h)&&(h=n.Expr.fromJSON(s.interpolatedPropertyDefinitionToJsonExpr(h)).intern(this.m_exprPool)),n.Expr.isExpr(h)){const r=h.dependencies();r.featureState&&("enabled"!==t?u.log("feature-state is not supported in this context"):e._usesFeatureState=!0),0!==r.properties.size||h.isDynamic()||(h=h.evaluate(this.m_emptyEnv))}if(n.Expr.isExpr(h)){const n=function(e,t){var r,i;return"extruded-polygon"===e.technique&&"color"===t&&!1!==e.vertexColors?c:null!==(i=null===(r=a.getTechniqueAttributeDescriptor(e.technique,t))||void 0===r?void 0:r.scope)&&void 0!==i?i:c}(e,t),s=h.dependencies();switch(s.properties.forEach((e=>{this.m_featureDependencies.includes(e)||this.m_featureDependencies.push(e)})),n){case a.AttrScope.FeatureGeometry:r.push([t,h]);break;case a.AttrScope.TechniqueGeometry:i.push([t,h]);break;case a.AttrScope.TechniqueRendering:0===s.properties.size?o.push([t,h]):i.push([t,h])}}else null!=h&&l.push([t,h])}},d=new Map([["category","_category"],["secondaryCategory","_secondaryCategory"]]);for(const r in e)e.hasOwnProperty(r)&&(r.startsWith("_")||["when","technique","layer","attr","description"].includes(r)||h(null!==(t=d.get(r))&&void 0!==t?t:r,e[r]));if(void 0!==e.attr)for(const t in e.attr)e.attr.hasOwnProperty(t)&&h(t,e.attr[t]);i.length>0&&(e._dynamicTechniques=new Map)}evaluateTechniqueProperties(e,t){return void 0===e._dynamicTechniqueAttributes?[]:e._dynamicTechniqueAttributes.map((([e,r])=>{try{return[e,r.evaluate(t,n.ExprScope.Value,this.m_cachedResults)]}catch(t){return u.error(`failed to evaluate expression '${r.toJSON()}': ${t}`),[e,null]}}))}createTechnique(e,t,r){var i,n;const o={};if(o.name=e.technique,void 0!==e._staticAttributes)for(const[t,r]of e._staticAttributes)null!==r&&(o[t]=r);for(const[e,t]of r)null!==t&&(o[e]=t);if(void 0!==e._dynamicFeatureAttributes)for(const[t,r]of e._dynamicFeatureAttributes)o[t]=r;if(void 0!==e._dynamicForwardedAttributes)for(const[t,r]of e._dynamicForwardedAttributes)o[t]=r;return o._index=this.m_techniques.length,o._styleSetIndex=e._styleSetIndex,void 0!==e.styleSet&&(o._styleSet=e.styleSet),void 0!==e._usesFeatureState&&(o._usesFeatureState=e._usesFeatureState),l.setTechniqueRenderOrderOrPriority(o,null!==(i=this.m_options.priorities)&&void 0!==i?i:[],null!==(n=this.m_options.labelPriorities)&&void 0!==n?n:[]),this.m_techniques.push(o),o}},t.makeDecodedTechnique=f},3024:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.evaluateTechniqueAttr=void 0;const i=r(8937),n=r(7487);t.evaluateTechniqueAttr=function(e,t,r){if(void 0===t)return r;const o=i.Env.isEnv(e)?n.getPropertyValue(t,e):n.getPropertyValue(t,e.env,e.cachedExprResults);return null!=o?o:r}},6671:(e,t)=>{"use strict";var r;function i(...e){const t={attrDescriptors:{}};for(const r of e)void 0!==r.attrTransparencyColor&&(t.attrTransparencyColor=r.attrTransparencyColor),void 0!==r.attrDescriptors&&(t.attrDescriptors=Object.assign(Object.assign({},t.attrDescriptors),r.attrDescriptors));return t}Object.defineProperty(t,"__esModule",{value:!0}),t.getTechniqueAutomaticAttrs=t.getTechniqueAttributeDescriptor=t.getTechniqueDescriptor=t.AttrScope=void 0,function(e){e[e.FeatureGeometry=0]="FeatureGeometry",e[e.TechniqueGeometry=1]="TechniqueGeometry",e[e.TechniqueRendering=2]="TechniqueRendering"}(r=t.AttrScope||(t.AttrScope={}));const n={attrTransparencyColor:"color",attrDescriptors:{constantHeight:r.FeatureGeometry,enabled:r.FeatureGeometry,fadeFar:r.TechniqueRendering,fadeNear:r.TechniqueRendering,transparent:{scope:r.TechniqueRendering,automatic:!0},side:{scope:r.TechniqueRendering,automatic:!0}}},o=i(n,{attrDescriptors:{color:{scope:r.TechniqueRendering,automatic:!0},size:{scope:r.TechniqueRendering,automatic:!0},opacity:{scope:r.TechniqueRendering,automatic:!0}}}),s=i(n,o),a=i(n,o),l=i(n,{attrDescriptors:{text:r.FeatureGeometry,label:r.FeatureGeometry,useAbbreviation:r.FeatureGeometry,useIsoCode:r.FeatureGeometry,poiName:r.FeatureGeometry,imageTexture:r.FeatureGeometry,iconColor:r.TechniqueRendering,iconBrightness:r.TechniqueRendering,backgroundColor:r.TechniqueRendering,backgroundSize:r.TechniqueRendering,backgroundOpacity:r.TechniqueRendering,color:r.TechniqueRendering,opacity:r.TechniqueRendering,size:r.TechniqueRendering}}),u={attrDescriptors:{polygonOffset:{scope:r.TechniqueRendering,automatic:!0},polygonOffsetFactor:{scope:r.TechniqueRendering,automatic:!0},polygonOffsetUnits:{scope:r.TechniqueRendering,automatic:!0},depthTest:{scope:r.TechniqueRendering,automatic:!0},transparent:{scope:r.TechniqueRendering,automatic:!0},opacity:{scope:r.TechniqueRendering,automatic:!0},color:{scope:r.TechniqueRendering,automatic:!0},lineColor:r.TechniqueRendering,lineFadeFar:r.TechniqueRendering,lineFadeNear:r.TechniqueRendering}},c=i(n,u,{attrDescriptors:{lineWidth:r.TechniqueRendering,secondaryWidth:r.TechniqueRendering,secondaryColor:r.TechniqueRendering,dashSize:r.TechniqueRendering,gapSize:r.TechniqueRendering,outlineColor:{scope:r.TechniqueRendering,automatic:!0},caps:{scope:r.TechniqueRendering,automatic:!0},drawRangeStart:{scope:r.TechniqueRendering,automatic:!0},drawRangeEnd:{scope:r.TechniqueRendering,automatic:!0},dashes:{scope:r.TechniqueRendering,automatic:!0},dashColor:{scope:r.TechniqueRendering,automatic:!0}}}),h=i(n,{attrDescriptors:{color:{scope:r.TechniqueRendering,automatic:!0},opacity:{scope:r.TechniqueRendering,automatic:!0},lineWidth:r.FeatureGeometry}}),d=i(n,u,{attrDescriptors:{wireframe:{scope:r.TechniqueRendering,automatic:!0},color:{scope:r.TechniqueRendering,automatic:!0},opacity:{scope:r.TechniqueRendering,automatic:!0},transparent:{scope:r.TechniqueRendering,automatic:!0},lineWidth:r.TechniqueRendering,map:{scope:r.TechniqueRendering,automatic:!0}}}),f=i(n,{attrDescriptors:{color:{scope:r.TechniqueRendering,automatic:!0},vertexColors:{scope:r.TechniqueRendering,automatic:!0},wireframe:{scope:r.TechniqueRendering,automatic:!0},roughness:{scope:r.TechniqueRendering,automatic:!0},metalness:{scope:r.TechniqueRendering,automatic:!0},alphaTest:{scope:r.TechniqueRendering,automatic:!0},depthTest:{scope:r.TechniqueRendering,automatic:!0},transparent:{scope:r.TechniqueRendering,automatic:!0},opacity:{scope:r.TechniqueRendering,automatic:!0},emissive:{scope:r.TechniqueRendering,automatic:!0},emissiveIntensity:{scope:r.TechniqueRendering,automatic:!0},refractionRatio:{scope:r.TechniqueRendering,automatic:!0},normalMapType:{scope:r.TechniqueRendering,automatic:!0},map:{scope:r.TechniqueRendering,automatic:!0},normalMap:{scope:r.TechniqueRendering,automatic:!0},displacementMap:{scope:r.TechniqueRendering,automatic:!0},roughnessMap:{scope:r.TechniqueRendering,automatic:!0},emissiveMap:{scope:r.TechniqueRendering,automatic:!0},bumpMap:{scope:r.TechniqueRendering,automatic:!0},metalnessMap:{scope:r.TechniqueRendering,automatic:!0},alphaMap:{scope:r.TechniqueRendering,automatic:!0}}}),p={"extruded-polygon":i(n,f,{attrDescriptors:{height:r.FeatureGeometry,floorHeight:r.FeatureGeometry,color:r.FeatureGeometry,defaultColor:r.FeatureGeometry,defaultHeight:r.FeatureGeometry,boundaryWalls:r.FeatureGeometry,footprint:r.FeatureGeometry,maxSlope:r.FeatureGeometry,animateExtrusion:r.TechniqueRendering,lineWidth:r.TechniqueRendering,lineFadeNear:r.TechniqueRendering,lineFadeFar:r.TechniqueRendering,lineColor:r.TechniqueRendering}}),"line-marker":l,"labeled-icon":l,"solid-line":c,"dashed-line":c,terrain:f,standard:f,squares:s,circles:a,line:h,segments:h,fill:d,text:i(n,{attrDescriptors:{text:r.FeatureGeometry,label:r.FeatureGeometry,useAbbreviation:r.FeatureGeometry,useIsoCode:r.FeatureGeometry,backgroundColor:r.TechniqueRendering,backgroundSize:r.TechniqueRendering,backgroundOpacity:r.TechniqueRendering,color:r.TechniqueRendering,opacity:r.TechniqueRendering,priority:r.TechniqueRendering,size:r.TechniqueRendering}}),shader:i(n,{attrDescriptors:{params:r.TechniqueRendering}})};function m(e){return"string"!=typeof e&&(e=e.name),p[e]}t.getTechniqueDescriptor=m,t.getTechniqueAttributeDescriptor=function(e,t){const r=m(e),i=null==r?void 0:r.attrDescriptors,n=null==i?void 0:i[t];if(void 0!==typeof n)return"object"==typeof n?n:{scope:n}};const g=new Map;t.getTechniqueAutomaticAttrs=function(e){var t;if("string"!=typeof e&&(e=e.name),g.has(e))return g.get(e);const r=[],i=null===(t=m(e))||void 0===t?void 0:t.attrDescriptors;if(void 0===i)return r;for(const e in i){if(!i.hasOwnProperty(e))continue;const t=i[e];void 0!==t&&"number"!=typeof t&&!0===t.automatic&&r.push(e)}return g.set(e,r),r}},8212:(e,t)=>{"use strict";var r,i,n,o,s;Object.defineProperty(t,"__esModule",{value:!0}),t.isTextureBuffer=t.PlacementToken=t.transientToPickability=t.Pickability=t.PoiStackMode=t.TextureCoordinateType=t.GeometryKindSet=t.GeometryKind=t.StandardGeometryKind=void 0,function(e){e.All="_all_",e.Background="background",e.Terrain="terrain",e.Area="area",e.Line="line",e.Water="water",e.Border="border",e.Road="road",e.Building="building",e.Label="label",e.Detail="detail"}(r=t.StandardGeometryKind||(t.StandardGeometryKind={})),t.GeometryKind=r;class a extends Set{isSuperset(e){for(const t of e)if(!this.has(t))return!1;return!0}hasIntersection(e){for(const t of e)if(this.has(t))return!0;return!1}hasOrIntersects(e){return e instanceof Set?this.hasIntersection(e):this.has(e)}hasOrIntersectsArray(e){for(const t of e)if(this.has(t))return!0;return!1}}t.GeometryKindSet=a,(s=t.TextureCoordinateType||(t.TextureCoordinateType={})).TileSpace="tile-space",s.EquirectangularSpace="equirectangular-space",s.FeatureSpace="feature-space",(o=t.PoiStackMode||(t.PoiStackMode={})).Show="show-in-stack",o.Hide="hide-in-stack",o.ShowParent="show-parent",function(e){e.onlyVisible="only-visible",e.transient="transient",e.all="all"}(i=t.Pickability||(t.Pickability={})),t.transientToPickability=function(e){let t=i.onlyVisible;return null!=e&&(t="string"==typeof e?e:!0===e?i.transient:i.onlyVisible),t},(n=t.PlacementToken||(t.PlacementToken={})).TopLeft="TL",n.Top="T",n.TopRight="TR",n.Right="R",n.BottomRight="BR",n.Bottom="B",n.BottomLeft="BL",n.Left="L",n.Center="C",n.NorthWest="NW",n.North="N",n.NorthEast="NE",n.East="E",n.SouthEast="SE",n.South="S",n.SouthWest="SW",n.West="W",t.isTextureBuffer=function(e){return e&&e.buffer&&"string"==typeof e.type}},7828:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setTechniqueRenderOrderOrPriority=t.composeTechniqueTextureName=t.addBuffersToTransferList=t.textureCoordinateType=t.supportsTextures=t.needsVertexNormals=t.isLabelRejectionLineTechnique=t.isShaderTechnique=t.isTextTechnique=t.isTerrainTechnique=t.isStandardTechnique=t.isExtrudedPolygonTechnique=t.isFillTechnique=t.isStandardExtrudedLineTechnique=t.isBasicExtrudedLineTechnique=t.isExtrudedLineTechnique=t.isSegmentsTechnique=t.isSpecialDashesLineTechnique=t.isSolidLineTechnique=t.isLineTechnique=t.isLineMarkerTechnique=t.isPoiTechnique=t.isSquaresTechnique=t.isCirclesTechnique=t.TRANSPARENCY_PROPERTY_KEYS=t.TEXTURE_PROPERTY_KEYS=void 0;const i=r(8212);function n(e){return"labeled-icon"===e.name}function o(e){return"line-marker"===e.name}function s(e){return"extruded-line"===e.name}function a(e){return s(e)&&"standard"===e.shading}function l(e){return"fill"===e.name}function u(e){return"extruded-polygon"===e.name}function c(e){return"standard"===e.name}function h(e){return"terrain"===e.name}function d(e){return"text"===e.name}function f(e){return"shader"===e.name}function p(e){return l(e)||c(e)||u(e)||h(e)}t.TEXTURE_PROPERTY_KEYS=["map","normalMap","displacementMap","roughnessMap","emissiveMap","alphaMap","metalnessMap","bumpMap"],t.TRANSPARENCY_PROPERTY_KEYS=["opacity","transparent"],t.isCirclesTechnique=function(e){return"circles"===e.name},t.isSquaresTechnique=function(e){return"squares"===e.name},t.isPoiTechnique=n,t.isLineMarkerTechnique=o,t.isLineTechnique=function(e){return"line"===e.name},t.isSolidLineTechnique=function(e){return"solid-line"===e.name||"dashed-line"===e.name},t.isSpecialDashesLineTechnique=function(e){return("solid-line"===e.name||"dashed-line"===e.name)&&void 0!==e.dashes&&"Square"!==e.dashes},t.isSegmentsTechnique=function(e){return"segments"===e.name},t.isExtrudedLineTechnique=s,t.isBasicExtrudedLineTechnique=function(e){return s(e)&&"basic"===e.shading},t.isStandardExtrudedLineTechnique=a,t.isFillTechnique=l,t.isExtrudedPolygonTechnique=u,t.isStandardTechnique=c,t.isTerrainTechnique=h,t.isTextTechnique=d,t.isShaderTechnique=f,t.isLabelRejectionLineTechnique=function(e){return"label-rejection-line"===e.name},t.needsVertexNormals=function(e){return u(e)||l(e)||c(e)||h(e)||a(e)},t.supportsTextures=p,t.textureCoordinateType=function(e){return p(e)||f(e)?e.textureCoordinateType:void 0},t.addBuffersToTransferList=function(e,r){if(c(e)||u(e)||h(e))for(const n of t.TEXTURE_PROPERTY_KEYS){const t=e[n];i.isTextureBuffer(t)&&t.buffer instanceof ArrayBuffer&&r.push(t.buffer)}},t.composeTechniqueTextureName=function(e,t){let r=e;return"string"==typeof t.imageTexturePrefix&&(r=t.imageTexturePrefix+r),"string"==typeof t.imageTexturePostfix&&(r+=t.imageTexturePostfix),r},t.setTechniqueRenderOrderOrPriority=function(e,t,r){if(d(e)||n(e)||o(e)){if(r&&"string"==typeof e._category){const t=r.indexOf(e._category);-1!==t&&(e.priority=r.length-t)}}else if(t&&void 0!==e._styleSet){const r=r=>{const i=null==t?void 0:t.findIndex((t=>t.group===e._styleSet&&t.category===r));return void 0!==i&&-1!==i?10*(i+1):void 0};if("string"==typeof e._category){const t=r(e._category);void 0!==t&&(e.renderOrder=t)}if("string"==typeof e._secondaryCategory){const t=r(e._secondaryCategory);void 0!==t&&(e.secondaryRenderOrder=t)}}}},172:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isJsonExprReference=void 0,t.isJsonExprReference=function(e){return Array.isArray(e)&&2===e.length&&"ref"===e[0]&&"string"==typeof e[1]}},8648:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ThemeVisitor=void 0;const i=r(8937);t.ThemeVisitor=class{constructor(e){this.theme=e}visitStyles(e){const t=t=>!i.isJsonExpr(t)&&!!e(t);if(void 0!==this.theme.styles)for(const e in this.theme.styles)if(void 0!==this.theme.styles[e])for(const r of this.theme.styles[e])if(t(r))return!0;return!1}}},1549:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ThreeBufferUtils=void 0;const i=r(84);!function(e){function t(e){if(e instanceof Int8Array)return"int8";if(e instanceof Uint8Array)return"uint8";if(e instanceof Int16Array)return"int16";if(e instanceof Uint16Array)return"uint16";if(e instanceof Int32Array)return"int32";if(e instanceof Uint32Array)return"uint32";if(e instanceof Float32Array)return"float";throw new Error(`Unsupported buffer type ${name}`)}function r(e){const r=e.array;return{name:e.name,buffer:r.buffer,type:t(r),itemCount:e.itemSize,normalized:e.normalized}}e.getBufferElementType=t,e.fromThreeBufferAttribute=r,e.fromThreeInterleavedBufferAttribute=function(e){throw new Error("Not implemented yet")},e.fromThreeBufferGeometry=function(e,t){const n=[],o=Object.getOwnPropertyNames(e.attributes);for(const t of o){const i=r(e.attributes[t]);i.name=t,n.push(i)}const s=null!==e.index?r(e.index):void 0;let a=0;if(void 0!==s)a=null===e.index?0:e.index.count;else{const t=e.attributes.position;if(void 0===t)throw new Error("Missing position attibute to deduce item count");a=t.count}return{type:i.GeometryType.Unspecified,vertexAttributes:n,index:s,groups:[{start:0,count:a,technique:t}]}}}(t.ThreeBufferUtils||(t.ThreeBufferUtils={}))},7187:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},5253:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WorkerDecoderProtocol=t.RequestController=void 0,t.RequestController=class{constructor(e=0,t=new AbortController){this.priority=e,this.abortController=t}get signal(){return this.abortController.signal}abort(){this.abortController.abort()}},function(e){let t,r;!function(e){e.Configuration="configuration"}(t=e.DecoderMessageName||(e.DecoderMessageName={})),e.isConfigurationMessage=function(e){return e&&"string"==typeof e.service&&"string"==typeof e.type&&e.type===t.Configuration},function(e){e.DecodeTileRequest="decode-tile-request",e.TileInfoRequest="tile-info-request"}(r=e.Requests||(e.Requests={})),e.isDecodeTileRequest=function(e){return e&&"string"==typeof e.type&&e.type===r.DecodeTileRequest},e.isTileInfoRequest=function(e){return e&&"string"==typeof e.type&&e.type===r.TileInfoRequest}}(t.WorkerDecoderProtocol||(t.WorkerDecoderProtocol={}))},7299:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WorkerServiceProtocol=void 0,function(e){let t,r;e.WORKER_SERVICE_MANAGER_SERVICE_ID="worker-service-manager",function(e){e.Initialized="initialized",e.Request="request",e.Response="response"}(t=e.ServiceMessageName||(e.ServiceMessageName={})),e.isInitializedMessage=function(e){return e&&"string"==typeof e.service&&"string"==typeof e.type&&e.type===t.Initialized},function(e){e.CreateService="create-service",e.DestroyService="destroy-service"}(r=e.Requests||(e.Requests={})),e.isUnknownServiceError=function(e){return e.message.includes("unknown targetServiceType requested: ")},e.isRequestMessage=function(e){return e&&"string"==typeof e.service&&"string"==typeof e.type&&e.type===t.Request},e.isResponseMessage=function(e){return e&&"string"==typeof e.service&&"string"==typeof e.type&&e.type===t.Response}}(t.WorkerServiceProtocol||(t.WorkerServiceProtocol={}))},2525:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WorkerTilerProtocol=void 0,function(e){let t;!function(e){e.RegisterIndex="register-index",e.UpdateIndex="update-index",e.TileRequest="tile-request"}(t=e.Requests||(e.Requests={})),e.isRegisterIndexRequest=function(e){return e&&"string"==typeof e.type&&e.type===t.RegisterIndex},e.isUpdateIndexRequest=function(e){return e&&"string"==typeof e.type&&e.type===t.UpdateIndex},e.isTileRequest=function(e){return e&&"string"==typeof e.type&&e.type===t.TileRequest}}(t.WorkerTilerProtocol||(t.WorkerTilerProtocol={}))},6075:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ArrayOperators=void 0;const i=r(8937),n=["boolean","number","string"];function o(e,t){if(!(e instanceof i.StringLiteralExpr&&n.includes(e.value)))throw new Error(`expected "boolean", "number" or "string" instead of '${JSON.stringify(e)}'`);const r=e.value;t.forEach(((e,t)=>{if(typeof e!==r)throw new Error(`expected array element at index ${t} to have type '${r}'`)}))}function s(e,t){const r=e.evaluate(t);if(!Array.isArray(r))throw new Error(`'${r}' is not an array`);return r}const a={array:{call:(e,t)=>{switch(t.args.length){case 0:throw new Error("not enough arguments");case 1:return s(e,t.args[0]);case 2:{const r=s(e,t.args[1]);return o(t.args[0],r),r}case 3:{const r=s(e,t.args[2]);return function(e,t){if(!(e instanceof i.NumberLiteralExpr))throw new Error("missing expected number of elements");const r=e.value;if(t.length!==r)throw new Error(`the array must have ${r} element(s)`)}(t.args[1],r),o(t.args[0],r),r}default:throw new Error("too many arguments")}}},"make-array":{call:(e,t)=>{if(0===t.args.length)throw new Error("not enough arguments");return[...t.args.map((t=>e.evaluate(t)))]}},at:{call:(e,t)=>{const r=t.args,i=e.evaluate(r[0]);if("number"!=typeof i)throw new Error("expected the index of the element to retrieve");const n=e.evaluate(r[1]);if(!Array.isArray(n))throw new Error("expected an array");return i>=0&&i<n.length?n[i]:null}},slice:{call:(e,t)=>{if(t.args.length<2)throw new Error("not enough arguments");const r=e.evaluate(t.args[0]);if("string"!=typeof r&&!Array.isArray(r))throw new Error("input must be a string or an array");const i=e.evaluate(t.args[1]);if("number"!=typeof i)throw new Error("expected an index");let n;if(t.args.length>2&&(n=e.evaluate(t.args[2]),"number"!=typeof n))throw new Error("expected an index");return r.slice(i,n)}}};t.ArrayOperators=a},2099:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CastOperators=void 0;const r={"to-boolean":{call:(e,t)=>Boolean(e.evaluate(t.args[0]))},"to-string":{call:(e,t)=>String(e.evaluate(t.args[0]))},"to-number":{call:(e,t)=>{for(const r of t.args){const t=Number(e.evaluate(r));if(!isNaN(t))return t}throw new Error("cannot convert the value to a number")}}};t.CastOperators=r},8210:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ColorOperators=void 0;const i=r(4428),n=r(4482),o=r(8783),s={alpha:{call:(e,t)=>{let r=e.evaluate(t.args[0]);return"string"==typeof r&&(r=o.parseStringEncodedColor(r)),"number"==typeof r?n.ColorUtils.getAlphaFromHex(r):1}},rgba:{call:(e,t)=>{const r=e.evaluate(t.args[0]),o=e.evaluate(t.args[1]),s=e.evaluate(t.args[2]),a=e.evaluate(t.args[3]);if("number"==typeof r&&"number"==typeof o&&"number"==typeof s&&"number"==typeof a&&r>=0&&o>=0&&s>=0&&a>=0&&a<=1)return function(e,t,r,o){return n.ColorUtils.getHexFromRgba(i.MathUtils.clamp(e,0,255)/255,i.MathUtils.clamp(t,0,255)/255,i.MathUtils.clamp(r,0,255)/255,i.MathUtils.clamp(o,0,1))}(r,o,s,a);throw new Error(`unknown color 'rgba(${r},${o},${s},${a})'`)}},rgb:{call:(e,t)=>{const r=e.evaluate(t.args[0]),o=e.evaluate(t.args[1]),s=e.evaluate(t.args[2]);if("number"==typeof r&&"number"==typeof o&&"number"==typeof s&&r>=0&&o>=0&&s>=0)return function(e,t,r){return n.ColorUtils.getHexFromRgb(i.MathUtils.clamp(e,0,255)/255,i.MathUtils.clamp(t,0,255)/255,i.MathUtils.clamp(r,0,255)/255)}(r,o,s);throw new Error(`unknown color 'rgb(${r},${o},${s})'`)}},hsl:{call:(e,t)=>{const r=e.evaluate(t.args[0]),o=e.evaluate(t.args[1]),s=e.evaluate(t.args[2]);if("number"==typeof r&&"number"==typeof o&&"number"==typeof s&&r>=0&&o>=0&&s>=0)return function(e,t,r){return n.ColorUtils.getHexFromHsl(i.MathUtils.euclideanModulo(e,360)/360,i.MathUtils.clamp(t,0,100)/100,i.MathUtils.clamp(r,0,100)/100)}(r,o,s);throw new Error(`unknown color 'hsl(${r},${o}%,${s}%)'`)}}};t.ColorOperators=s},7922:(e,t)=>{"use strict";function r(e,t,r=!1){const i=e.evaluate(t.args[0]),n=e.evaluate(t.args[1]);if(!("number"==typeof i&&"number"==typeof n||"string"==typeof i&&"string"==typeof n)&&r)throw new Error(`invalid operands '${i}' and '${n}' for operator '${t.op}'`);switch(t.op){case"<":return i<n;case">":return i>n;case"<=":return i<=n;case">=":return i>=n;default:throw new Error(`invalid comparison operator '${t.op}'`)}}Object.defineProperty(t,"__esModule",{value:!0}),t.ComparisonOperators=void 0;const i={"!":{call:(e,t)=>!e.evaluate(t.args[0])},"==":{call:(e,t)=>e.evaluate(t.args[0])===e.evaluate(t.args[1])},"!=":{call:(e,t)=>e.evaluate(t.args[0])!==e.evaluate(t.args[1])},"<":{call:(e,t)=>r(e,t)},">":{call:(e,t)=>r(e,t)},"<=":{call:(e,t)=>r(e,t)},">=":{call:(e,t)=>r(e,t)}};t.ComparisonOperators=i},7877:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FeatureOperators=void 0;const i=r(9415),n=r(8937),o={"geometry-type":{call:(e,t)=>{switch(e.env.lookup("$geometryType")){case"point":return"Point";case"line":return"LineString";case"polygon":return"Polygon";default:return null}}},"feature-state":{isDynamicOperator:()=>!0,call:(e,t)=>{var r,o;if(e.scope!==n.ExprScope.Dynamic)throw new Error("feature-state cannot be used in this context");const s=e.evaluate(t.args[0]);if("string"!=typeof s)throw new Error("expected the name of the property of the feature state");const a=e.env.lookup("$state");return i.Env.isEnv(a)?null!==(r=a.lookup(s))&&void 0!==r?r:null:a instanceof Map&&null!==(o=a.get(s))&&void 0!==o?o:null}},id:{call:(e,t)=>{var r;return null!==(r=e.env.lookup("$id"))&&void 0!==r?r:null}}};t.FeatureOperators=o},8146:(e,t)=>{"use strict";function r(e,t,r){switch(t){case"boolean":case"number":case"string":for(const i of r){const r=e.evaluate(i);if(typeof r===t)return r}throw new Error(`expected a '${t}'`);default:throw new Error(`invalid type '${t}'`)}}Object.defineProperty(t,"__esModule",{value:!0}),t.FlowOperators=void 0;const i={all:{call:(e,t)=>{for(const r of t.args)if(!e.evaluate(r))return!1;return!0}},any:{call:(e,t)=>{for(const r of t.args)if(e.evaluate(r))return!0;return!1}},none:{call:(e,t)=>{for(const r of t.args)if(e.evaluate(r))return!1;return!0}},boolean:{call:(e,t)=>r(e,"boolean",t.args)},number:{call:(e,t)=>r(e,"number",t.args)},string:{call:(e,t)=>r(e,"string",t.args)}};t.FlowOperators=i},1139:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MapOperators=void 0;const i=r(8937),n={"ppi-scale":{call:(e,t)=>e.evaluate(t.args[0])*(t.args[1]?e.evaluate(t.args[1]):1)},"world-ppi-scale":{isDynamicOperator:()=>!0,call:(e,t)=>{const r=e.evaluate(t.args[0]),i=t.args[1]?e.evaluate(t.args[1]):1,n=e.env.lookup("$zoom");return r*(Math.pow(2,17)/Math.pow(2,n))*i}},"world-discrete-ppi-scale":{isDynamicOperator:()=>!0,call:(e,t)=>{const r=e.evaluate(t.args[0]),i=t.args[1]?e.evaluate(t.args[1]):1,n=e.env.lookup("$zoom");return r*(Math.pow(2,17)/Math.pow(2,Math.floor(n)))*i}},ppi:{call:e=>{const t=e.env.lookup("$ppi");return"number"==typeof t?t:72}},zoom:{isDynamicOperator:()=>!0,call:(e,t)=>{var r;return e.scope===i.ExprScope.Value?t:null!==(r=e.env.lookup("$zoom"))&&void 0!==r?r:null}}};t.MapOperators=n},1701:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MathOperators=void 0;const i=r(4428),n={"^":{call:(e,t)=>{const r=e.evaluate(t.args[0]),i=e.evaluate(t.args[1]);if("number"!=typeof r||"number"!=typeof i)throw new Error(`invalid operands '${typeof r}' and '${typeof i}' for operator '^'`);return Math.pow(r,i)}},"-":{call:(e,t)=>{if(1===t.args.length){const r=e.evaluate(t.args[0]);if("number"!=typeof r)throw new Error(`nvalid operand '${typeof r} for operator '-'`);return-r}const r=e.evaluate(t.args[0]),i=e.evaluate(t.args[1]);if("number"!=typeof r||"number"!=typeof i)throw new Error(`invalid operands '${typeof r}' and '${typeof i}' for operator '-'`);return r-i}},"/":{call:(e,t)=>{const r=e.evaluate(t.args[0]),i=e.evaluate(t.args[1]);if("number"!=typeof r||"number"!=typeof i)throw new Error(`invalid operands '${typeof r}' and '${typeof i}' for operator '/'`);return r/i}},"%":{call:(e,t)=>{const r=e.evaluate(t.args[0]),i=e.evaluate(t.args[1]);if("number"!=typeof r||"number"!=typeof i)throw new Error(`invalid operands '${typeof r}' and '${typeof i}' for operator '%'`);return r%i}},"+":{call:(e,t)=>t.args.reduce(((t,r)=>Number(t)+Number(e.evaluate(r))),0)},"*":{call:(e,t)=>t.args.reduce(((t,r)=>Number(t)*Number(e.evaluate(r))),1)},abs:{call:(e,t)=>{const r=e.evaluate(t.args[0]);if("number"!=typeof r)throw new Error(`invalid operand '${r}' for operator 'abs'`);return Math.abs(r)}},acos:{call:(e,t)=>{const r=e.evaluate(t.args[0]);if("number"!=typeof r)throw new Error(`invalid operand '${r}' for operator 'acos'`);return Math.acos(r)}},asin:{call:(e,t)=>{const r=e.evaluate(t.args[0]);if("number"!=typeof r)throw new Error(`invalid operand '${r}' for operator 'asin'`);return Math.asin(r)}},atan:{call:(e,t)=>{const r=e.evaluate(t.args[0]);if("number"!=typeof r)throw new Error(`invalid operand '${r}' for operator 'atan'`);return Math.atan(r)}},ceil:{call:(e,t)=>{const r=e.evaluate(t.args[0]);if("number"!=typeof r)throw new Error(`invalid operand '${r}' for operator 'ceil'`);return Math.ceil(r)}},cos:{call:(e,t)=>{const r=e.evaluate(t.args[0]);if("number"!=typeof r)throw new Error(`invalid operand '${r}' for operator 'cos'`);return Math.cos(r)}},e:{call:()=>Math.E},floor:{call:(e,t)=>{const r=e.evaluate(t.args[0]);if("number"!=typeof r)throw new Error(`invalid operand '${r}' for operator 'floor'`);return Math.floor(r)}},ln:{call:(e,t)=>{const r=e.evaluate(t.args[0]);if("number"!=typeof r)throw new Error(`invalid operand '${r}' for operator 'ln'`);return Math.log(r)}},ln2:{call:(e,t)=>{const r=e.evaluate(t.args[0]);if("number"!=typeof r)throw new Error(`invalid operand '${r}' for operator 'ln2'`);return Math.log2(r)}},log10:{call:(e,t)=>{const r=e.evaluate(t.args[0]);if("number"!=typeof r)throw new Error(`invalid operand '${r}' for operator 'log10'`);return Math.log10(r)}},max:{call:(e,t)=>Math.max(...t.args.map((t=>Number(e.evaluate(t)))))},min:{call:(e,t)=>Math.min(...t.args.map((t=>Number(e.evaluate(t)))))},clamp:{call:(e,t)=>{const r=e.evaluate(t.args[0]),n=e.evaluate(t.args[1]),o=e.evaluate(t.args[2]);if("number"!=typeof r||"number"!=typeof n||"number"!=typeof o)throw new Error(`invalid operands '${r}', ${n}, ${o} for operator 'clamp'`);return i.MathUtils.clamp(r,n,o)}},pi:{call:()=>Math.PI},round:{call:(e,t)=>{const r=e.evaluate(t.args[0]);if("number"!=typeof r)throw new Error(`invalid operand '${r}' for operator 'round'`);return Math.round(r)}},sin:{call:(e,t)=>{const r=e.evaluate(t.args[0]);if("number"!=typeof r)throw new Error(`invalid operand '${r}' for operator 'sin'`);return Math.sin(r)}},sqrt:{call:(e,t)=>{const r=e.evaluate(t.args[0]);if("number"!=typeof r)throw new Error(`invalid operand '${r}' for operator 'sqrt'`);return Math.sqrt(r)}},tan:{call:(e,t)=>{const r=e.evaluate(t.args[0]);if("number"!=typeof r)throw new Error(`invalid operand '${r}' for operator 'tan'`);return Math.tan(r)}}};t.MathOperators=n},4292:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MiscOperators=void 0;const r={length:{call:(e,t)=>{const r=e.evaluate(t.args[0]);if(Array.isArray(r)||"string"==typeof r)return r.length;throw new Error(`invalid operand '${r}' for operator 'length'`)}},coalesce:{call:(e,t)=>{for(const r of t.args){const t=e.evaluate(r);if(null!==t)return t}return null}}};t.MiscOperators=r},9156:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ObjectOperators=void 0;const i=r(9415),n=r(8937),o=Object.prototype.hasOwnProperty;var s;function a(e,t,r){var n;const a=e.evaluate(t[0]);if("string"!=typeof a)throw new Error("expected the name of an attribute");const l=e.evaluate(t[1]);if(l&&"object"==typeof l){if(i.Env.isEnv(l)){const e=null!==(n=l.lookup(a))&&void 0!==n?n:null;return r===s.get?e:null!==e}if(o.call(l,a))return r!==s.get||l[a]}return r===s.get&&null}!function(e){e[e.get=0]="get",e[e.has=1]="has"}(s||(s={}));const l={in:{call:(e,t)=>{const r=e.evaluate(t.args[0]),i=e.evaluate(t.args[1]);return("string"==typeof r&&"string"==typeof i||!!Array.isArray(i))&&i.includes(r)}},get:{call:(e,t)=>a(e,t.args,s.get)},has:{call:(e,t)=>a(e,t.args,s.has)},"dynamic-properties":{isDynamicOperator:()=>!0,call:(e,t)=>e.scope===n.ExprScope.Dynamic?e.env:t}};t.ObjectOperators=l},9388:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StringOperators=void 0;const r={concat:{call:(e,t)=>"".concat(...t.args.map((t=>String(e.evaluate(t)))))},downcase:{call:(e,t)=>String(e.evaluate(t.args[0])).toLocaleLowerCase()},upcase:{call:(e,t)=>String(e.evaluate(t.args[0])).toLocaleUpperCase()},"~=":{call:(e,t)=>{const r=e.evaluate(t.args[0]),i=e.evaluate(t.args[1]);return"string"==typeof r&&"string"==typeof i&&r.includes(i)}},"^=":{call:(e,t)=>{const r=e.evaluate(t.args[0]),i=e.evaluate(t.args[1]);return"string"==typeof r&&"string"==typeof i&&r.startsWith(i)}},"$=":{call:(e,t)=>{const r=e.evaluate(t.args[0]),i=e.evaluate(t.args[1]);return"string"==typeof r&&"string"==typeof i&&r.endsWith(i)}}};t.StringOperators=r},8992:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TypeOperators=void 0,t.TypeOperators={typeof:{call:(e,t)=>typeof e.evaluate(t.args[0])}}},2273:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.VectorOperators=void 0;const i=r(4428),n=r(8937);function o(e,t,r){let n;switch(r){case"vector2":n=i.Vector2;break;case"vector3":n=i.Vector3;break;case"vector4":n=i.Vector4}for(const r of t.args){const t=e.evaluate(r);if(t instanceof n)return t}throw new Error(`expected a "${r}"`)}function s(e,t,r){let n,o;switch(r){case"vector2":n=i.Vector2,o=2;break;case"vector3":n=i.Vector3,o=3;break;case"vector4":n=i.Vector4,o=4}for(const r of t.args){const t=e.evaluate(r);if(t instanceof n)return t;if(Array.isArray(t)&&t.length===o&&t.every((e=>"number"==typeof e)))return(new n).fromArray(t)}throw new Error(`expected a "${r}"`)}const a={"make-vector":{call:(e,t)=>{if(void 0!==t._value)return t._value;if(t.args.length<2)throw new Error("not enough arguments");if(t.args.length>4)throw new Error("too many arguments");const r=t.args.map((t=>e.evaluate(t)));let o;switch(r.forEach(((e,t)=>{if("number"!=typeof e)throw new Error(`expected vector component at index ${t} to have type "number"`)})),r.length){case 2:o=(new i.Vector2).fromArray(r);break;case 3:o=(new i.Vector3).fromArray(r);break;case 4:o=(new i.Vector4).fromArray(r);break;default:throw new Error("too many arguments")}return t.args.every((e=>e instanceof n.NumberLiteralExpr))&&(t._value=o),o}},vector2:{call:(e,t)=>o(e,t,"vector2")},vector3:{call:(e,t)=>o(e,t,"vector3")},vector4:{call:(e,t)=>o(e,t,"vector4")},"to-vector2":{call:(e,t)=>s(e,t,"vector2")},"to-vector3":{call:(e,t)=>s(e,t,"vector3")},"to-vector4":{call:(e,t)=>s(e,t,"vector4")}};t.VectorOperators=a},4757:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CustomDecoderService=t.CustomDecoder=void 0;const i=r(3187),n=r(5263),o=r(3139),s=r(249),a=r(2851),l=r(4428),u=r(6120);class c extends a.ThemedTileDecoder{connect(){return Promise.resolve()}decodeThemedTile(e,t,r,i){const n=[],o=new Float32Array(e),s=this.processLineFeatures(o,t,r,i,n),a=this.processMeshFeatures(t,r,n),l=Math.min(s.minGeometryHeight,a.minGeometryHeight),u=Math.max(s.maxGeometryHeight,a.maxGeometryHeight),c=[];this.processDependencies(o,c);const h={techniques:r.techniques,geometries:n,dependencies:c,maxGeometryHeight:u,minGeometryHeight:l};return Promise.resolve(h)}createLineGeometry(e,t){const{vertices:r,indices:n}=e,o=new Float32Array(r).buffer,s=new Uint32Array(n).buffer,a={type:"float",stride:e.stride,buffer:o,attributes:e.vertexAttributes};return{type:i.GeometryType.SolidLine,index:{buffer:s,itemCount:1,type:"uint32",name:"index"},interleavedVertexAttributes:[a],groups:[{start:0,count:n.length,technique:t}],vertexAttributes:[]}}processLineFeatures(e,t,r,i,a){const u=new n.MapEnv({layer:"line-layer"}),c=r.getMatchingTechniques(u),h=o.webMercatorTilingScheme.getGeoBox(t).center,d=i.projectPoint(h,new l.Vector3),f=this.convertToLocalWorldCoordinates(e,h,i,d),p=new s.LineGroup;p.add(d,f,i);for(const e of c)a.push(this.createLineGeometry(p,e._index));return{minGeometryHeight:-100,maxGeometryHeight:0}}convertToLocalWorldCoordinates(e,t,r,i){const n=e[0],o=t.clone(),s=new l.Vector3,a=new Array(n/2*3);for(let l=0;l<n;l+=2)o.copy(t),o.latitude+=e[l+1],o.longitude+=e[l+2],o.altitude=-100,r.projectPoint(o,s),s.sub(i).toArray(a,l/2*3);return a}processMeshFeatures(e,t,r){const i=new n.MapEnv({layer:"mesh-layer"}),o=t.getMatchingTechniques(i),s=(1<<20)/(1<<e.level),a=new l.BoxBufferGeometry(1*s,5*s,5*s),u=new l.Matrix4;u.makeTranslation(2*s,1*s,0),a.applyMatrix4(u);const c=2.5*s;for(const e of o){const t=n.ThreeBufferUtils.fromThreeBufferGeometry(a,e._index);r.push(t)}return{minGeometryHeight:-c,maxGeometryHeight:c}}processDependencies(e,t){const r=e[0]+1,i=e[r],n=r+1;for(let r=0;r<i;r+=3){const i=e[n+r],s=e[n+r+1],a=e[n+r+2];t.push(o.TileKey.fromRowColumnLevel(i,s,a).mortonCode())}}}t.CustomDecoder=c,t.CustomDecoderService=class{static start(){a.WorkerServiceManager.getInstance().register({serviceType:u.CUSTOM_DECODER_SERVICE_TYPE,factory:e=>a.TileDecoderService.start(e,new c)})}}},6120:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CUSTOM_DECODER_SERVICE_TYPE=void 0,t.CUSTOM_DECODER_SERVICE_TYPE="custom_example_decoder_service"},8611:(e,t,r)=>{"use strict";self.importScripts("three.min.js");const i=r(4607),n=r(4757);i.VectorTileDecoderService.start(),i.GeoJsonTilerService.start(),n.CustomDecoderService.start()},6290:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.wrapLineString=t.clipLineString=void 0;const i=r(3139),n=r(3333),o=r(4428);class s{constructor(e,t,r,i,n){this.isInside=n,this.p0=new o.Vector2(e,t),this.p1=new o.Vector2(r,i)}inside(e){return this.isInside(e)}computeIntersection(e,t){const r=new o.Vector2;return n.Math2D.intersectLines(e.x,e.y,t.x,t.y,this.p0.x,this.p0.y,this.p1.x,this.p1.y,r),r}clipLine(e){const t=e,r=[];e=[],r.push(e);const i=t=>{0!==e.length&&e[e.length-1].equals(t)||e.push(t)};for(let n=0;n<t.length;++n){const o=t[n],s=n>0?t[n-1]:void 0;this.inside(o)?(void 0===s||this.inside(s)||(e.length>0&&(e=[],r.push(e)),i(this.computeIntersection(s,o))),i(o)):void 0!==s&&this.inside(s)&&i(this.computeIntersection(s,o))}return 0===r[r.length-1].length&&(r.length=r.length-1),r}clipLines(e){const t=[];return e.forEach((e=>{this.clipLine(e).forEach((e=>{t.push(e)}))})),t}}function a(e,t,r){for(const r of t)e=r.clipLines(e);const n=new o.Vector3,s=[];return e.forEach((e=>{if(0===e.length)return;const t=e.map((({x:e,y:t})=>{n.set(e,t,0);const o=i.webMercatorProjection.unprojectPoint(n);return o.longitude+=r,o}));s.push(t)})),s.length>0?s:void 0}t.clipLineString=function(e,t,r,i,n){const o=new s(t,r,t,n,(e=>e.x>t)),a=new s(t,n,i,n,(e=>e.y<n)),l=new s(i,n,i,r,(e=>e.x<i)),u=new s(i,r,t,r,(e=>e.y>r));let c=o.clipLine(e);return c=a.clipLines(c),c=l.clipLines(c),c=u.clipLines(c),c},t.wrapLineString=function(e){const t=new o.Vector3,r=[e.map((e=>{const{x:r,y:n}=i.webMercatorProjection.projectPoint(e,t);return new o.Vector2(r,n)}))];return{left:a(r,c,360),middle:a(r,u,0),right:a(r,h,-360)}};const l=i.EarthConstants.EQUATORIAL_CIRCUMFERENCE,u=[new s(0,l,0,0,(e=>e.x>0)),new s(l+0,0,l+0,l,(e=>e.x<l+0))],c=[new s(-l-0,l,-l-0,0,(e=>e.x>-l-0)),new s(0,0,0,l,(e=>e.x<0))],h=[new s(l-0,l,l-0,0,(e=>e.x>l-0)),new s(2*l+0,0,2*l+0,l,(e=>e.x<2*l+0))]},2635:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.clipPolygon=t.ClippingEdge=void 0;const i=r(4428);class n{clipPolygon(e,t){const r=e;e=[];const i=t=>{const r=e[e.length-1];(!(null==r?void 0:r.equals(t))||!0===t.isClipped&&!(null==r?void 0:r.isClipped)||!t.isClipped&&!0===(null==r?void 0:r.isClipped))&&e.push(t)};for(let e=0;e<r.length;++e){const n=r[e],o=r[(e+r.length-1)%r.length];if(this.inside(n,t)){if(!this.inside(o,t)){const e=this.computeIntersection(o,n,t);e.isClipped=!0,i(e)}i(n)}else if(this.inside(o,t)){const e=this.computeIntersection(o,n,t);e.isClipped=!0,i(e)}}return e}}t.ClippingEdge=n;const o=[new class extends n{inside(e){return e.y>=0}computeIntersection(e,t){const{x:r,y:n}=e,{x:o,y:s}=t;return new i.Vector2((r*s-n*o)/-(n-s),0).round()}},new class extends n{inside(e,t){return e.x<=t}computeIntersection(e,t,r){const{x:n,y:o}=e,{x:s,y:a}=t;return new i.Vector2(r,(n*a-o*s-(o-a)*-r)/(n-s)).round()}},new class extends n{inside(e,t){return e.y<=t}computeIntersection(e,t,r){const{x:n,y:o}=e,{x:s,y:a}=t;return new i.Vector2((n*a-o*s-(n-s)*r)/-(o-a),r).round()}},new class extends n{inside(e){return e.x>=0}computeIntersection(e,t){const{x:r,y:n}=e,{x:o,y:s}=t;return new i.Vector2(0,(r*s-n*o)/(r-o)).round()}}];t.clipPolygon=function(e,t){if(0===e.length)return e;e[0].equals(e[e.length-1])||(e=[...e,e[0]]);for(const r of o)e=r.clipPolygon(e,t);return e.length<3?[]:e}},7771:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EdgeLengthGeometrySubdivisionModifier=t.SubdivisionMode=void 0;const i=r(3139),n=r(3333),o=r(4428),s=r(5372),a=[new o.Vector3,new o.Vector3];var l;!function(e){e[e.All=0]="All",e[e.NoDiagonals=1]="NoDiagonals"}(l=t.SubdivisionMode||(t.SubdivisionMode={}));class u extends s.SubdivisionModifier{constructor(e,t,r=l.All,o){super(),this.subdivision=e,this.geoBox=t,this.subdivisionMode=r,this.projection=o,n.assert(o.type===i.ProjectionType.Planar,"EdgeLengthGeometrySubdivisionModifier only supports planar projections");const s=o.projectPoint(t.northEast,a[0]),u=o.projectPoint(t.southWest,a[1]);this.m_projectedBox={min:{x:Math.min(s.x,u.x),y:Math.min(s.y,u.y),z:Math.min(s.z,u.z)},max:{x:Math.max(s.x,u.x),y:Math.max(s.y,u.y),z:Math.max(s.z,u.z)}},this.m_maxLengthX=(this.m_projectedBox.max.x-this.m_projectedBox.min.x)/e,this.m_maxLengthY=(this.m_projectedBox.max.y-this.m_projectedBox.min.y)/e,this.subdivisionMode===l.All&&(this.m_maxLengthX*=1.1,this.m_maxLengthY*=1.1),this.m_maxLength=Math.sqrt(this.m_maxLengthX*this.m_maxLengthX+this.m_maxLengthY*this.m_maxLengthY)}get maxLength(){return this.m_maxLength}get maxLengthX(){return this.m_maxLengthX}get maxLengthY(){return this.m_maxLengthY}shouldSplitTriangle(e,t,r){const i=this.shouldSplitEdge(e,t),n=this.shouldSplitEdge(t,r),o=this.shouldSplitEdge(r,e);if(!(i||n||o))return;const s=e.distanceTo(t),a=t.distanceTo(r),l=r.distanceTo(e),u=Math.max(i?s:0,n?a:0,o?l:0);if(s===u)return 0;if(a===u)return 1;if(l===u)return 2;throw new Error("Could not split triangle.")}shouldSplitEdge(e,t){switch(this.subdivisionMode){case l.All:return e.y===t.y&&Math.abs(e.x-t.x)>this.m_maxLengthX||e.x===t.x&&Math.abs(e.y-t.y)>this.m_maxLengthY||e.distanceTo(t)>this.m_maxLength;case l.NoDiagonals:return e.y===t.y&&Math.abs(e.x-t.x)>this.m_maxLengthX||e.x===t.x&&Math.abs(e.y-t.y)>this.m_maxLengthY}}}t.EdgeLengthGeometrySubdivisionModifier=u},7478:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SphericalGeometrySubdivisionModifier=void 0;const i=r(3139),n=r(4428),o=r(5372),s=[new n.Vector3,new n.Vector3,new n.Vector3];class a extends o.SubdivisionModifier{constructor(e,t=i.sphereProjection){super(),this.angle=e,this.projection=t}shouldSplitTriangle(e,t,r){const n=i.sphereProjection.reprojectPoint(this.projection,e,s[0]),o=i.sphereProjection.reprojectPoint(this.projection,t,s[1]),a=i.sphereProjection.reprojectPoint(this.projection,r,s[2]),l=n.angleTo(o),u=o.angleTo(a),c=a.angleTo(n),h=Math.max(l,Math.max(u,c));if(!(h<this.angle)){if(h===l)return 0;if(h===u)return 1;if(h===c)return 2;throw new Error("failed to split triangle")}}}t.SphericalGeometrySubdivisionModifier=a},5372:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SubdivisionModifier=void 0;const i=r(4428),n=new i.Vector3,o=new i.Vector3,s=new i.Vector3;t.SubdivisionModifier=class{constructor(){}modify(e){const t=e.getAttribute("position"),r=Array.from(t.array),i=e.getAttribute("uv"),a=void 0!==i?Array.from(i.array):void 0,l=e.getAttribute("edge"),u=void 0!==l?Array.from(l.array):void 0,c=e.getAttribute("wall"),h=void 0!==c?Array.from(c.array):void 0,d=e.getIndex(),f=Array.from(d.array),p=new Map;function m(e,t){const i=`${Math.min(e,t)}_${Math.max(e,t)}`,l=p.get(i);if(void 0!==l)return l;n.set(r[3*e],r[3*e+1],r[3*e+2]),o.set(r[3*t],r[3*t+1],r[3*t+2]),s.lerpVectors(n,o,.5);const c=r.length/3;return r.push(...s.toArray()),p.set(i,c),void 0!==a&&(n.set(a[2*e],a[2*e+1],0),o.set(a[2*t],a[2*t+1],0),s.lerpVectors(n,o,.5),a.push(s.x,s.y)),void 0!==u&&(u[e]===t?(u.push(t),u[e]=c):u[t]===e?(u.push(e),u[t]=c):u.push(-1)),void 0!==h&&(h[e]===t?(h.push(t),h[e]=c):h[t]===e?(h.push(e),h[t]=c):h.push(-1)),c}const g=[];for(;f.length>=3;){const e=f.shift(),t=f.shift(),i=f.shift();switch(n.set(r[3*e],r[3*e+1],r[3*e+2]),o.set(r[3*t],r[3*t+1],r[3*t+2]),s.set(r[3*i],r[3*i+1],r[3*i+2]),this.shouldSplitTriangle(n,o,s)){case 0:{const r=m(e,t);f.push(e,r,i,r,t,i);break}case 1:{const r=m(t,i);f.push(e,t,r,e,r,i);break}case 2:{const r=m(i,e);f.push(e,t,r,r,t,i);break}case void 0:g.push(e,t,i);break;default:throw new Error("failed to subdivide the given geometry")}}return t.array=t.array instanceof Float32Array?new Float32Array(r):new Float64Array(r),t.count=r.length/t.itemSize,t.needsUpdate=!0,e.setIndex(g),void 0!==a&&(i.array=new Float32Array(a),i.count=a.length/i.itemSize,i.needsUpdate=!0),void 0!==u&&(l.array=new Float32Array(u),l.count=u.length/l.itemSize,l.needsUpdate=!0),e}}},2931:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GeoBox=void 0;const i=r(4428),n=r(7073);class o{constructor(e,t){this.southWest=e,this.northEast=t,this.west>this.east&&(this.northEast.longitude+=360)}static fromCoordinates(e,t){return new o(e,t)}static fromCenterAndExtents(e,t){return new o(new n.GeoCoordinates(e.latitude-t.latitudeSpan/2,e.longitude-t.longitudeSpan/2),new n.GeoCoordinates(e.latitude+t.latitudeSpan/2,e.longitude+t.longitudeSpan/2))}get minAltitude(){if(void 0!==this.southWest.altitude&&void 0!==this.northEast.altitude)return Math.min(this.southWest.altitude,this.northEast.altitude)}get maxAltitude(){if(void 0!==this.southWest.altitude&&void 0!==this.northEast.altitude)return Math.max(this.southWest.altitude,this.northEast.altitude)}get south(){return this.southWest.latitude}get north(){return this.northEast.latitude}get west(){return this.southWest.longitude}get east(){return this.northEast.longitude}get center(){const e=.5*(this.south+this.north),{west:t,east:r}=this,{minAltitude:i,altitudeSpan:o}=this;let s;if(void 0!==i&&void 0!==o&&(s=i+.5*o),t<=r)return new n.GeoCoordinates(e,.5*(t+r),s);let a=.5*(360+r+t);return a>360&&(a-=360),new n.GeoCoordinates(e,a,s)}get latitudeSpanInRadians(){return i.MathUtils.degToRad(this.latitudeSpan)}get longitudeSpanInRadians(){return i.MathUtils.degToRad(this.longitudeSpan)}get latitudeSpan(){return this.north-this.south}get altitudeSpan(){if(void 0!==this.maxAltitude&&void 0!==this.minAltitude)return this.maxAltitude-this.minAltitude}get longitudeSpan(){let e=this.northEast.longitude-this.southWest.longitude;return e<0&&(e+=360),e}get latitudeSpanInDegrees(){return this.latitudeSpan}get longitudeSpanInDegrees(){return this.longitudeSpan}contains(e){if(void 0===e.altitude||void 0===this.minAltitude||void 0===this.maxAltitude)return this.containsHelper(e);const t=this.minAltitude===this.maxAltitude,r=this.minAltitude===e.altitude,i=this.minAltitude<=e.altitude&&this.maxAltitude>e.altitude;return!!(t?r:i)&&this.containsHelper(e)}clone(){return new o(this.southWest.clone(),this.northEast.clone())}growToContain(e){this.southWest.latitude=Math.min(this.southWest.latitude,e.latitude),this.southWest.longitude=Math.min(this.southWest.longitude,e.longitude),this.southWest.altitude=void 0!==this.southWest.altitude&&void 0!==e.altitude?Math.min(this.southWest.altitude,e.altitude):void 0!==this.southWest.altitude?this.southWest.altitude:void 0!==e.altitude?e.altitude:void 0,this.northEast.latitude=Math.max(this.northEast.latitude,e.latitude),this.northEast.longitude=Math.max(this.northEast.longitude,e.longitude),this.northEast.altitude=void 0!==this.northEast.altitude&&void 0!==e.altitude?Math.max(this.northEast.altitude,e.altitude):void 0!==this.northEast.altitude?this.northEast.altitude:void 0!==e.altitude?e.altitude:void 0}containsHelper(e){if(e.latitude<this.southWest.latitude||e.latitude>=this.northEast.latitude)return!1;const{west:t,east:r}=this;let i=e.longitude;if(r>n.MAX_LONGITUDE)for(;i<t;)i+=360;if(i>r)for(;i>t+360;)i-=360;return i>=t&&i<r}}t.GeoBox=o},1754:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isGeoBoxExtentLike=void 0,t.isGeoBoxExtentLike=function(e){return e&&"object"==typeof e&&"number"==typeof e.latitudeSpan&&"number"==typeof e.longitudeSpan}},4908:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isGeoCoordLike=t.geoCoordLikeToGeoPointLike=t.geoCoordLikeToGeoCoordinatesLike=void 0;const i=r(7466),n=r(6233),o=r(6373);t.geoCoordLikeToGeoCoordinatesLike=function(e){return i.isGeoCoordinatesLike(e)?e:o.isLatLngLike(e)?{latitude:e.lat,longitude:e.lng}:{latitude:e[1],longitude:e[0]}},t.geoCoordLikeToGeoPointLike=function(e){return n.isGeoPointLike(e)?e:o.isLatLngLike(e)?[e.lng,e.lat]:[e.longitude,e.latitude]},t.isGeoCoordLike=function(e){return i.isGeoCoordinatesLike(e)||o.isLatLngLike(e)||!n.isGeoPointLike(e)}},7073:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GeoCoordinates=t.MIN_LONGITUDE=t.MAX_LONGITUDE=t.MIN_LATITUDE=t.MAX_LATITUDE=void 0;const i=r(4428),n=r(7466),o=r(6233),s=r(6373);t.MAX_LATITUDE=90,t.MIN_LATITUDE=-90,t.MAX_LONGITUDE=180,t.MIN_LONGITUDE=-180;const a=new i.Vector3,l=new i.Vector3;class u{constructor(e,t,r){this.latitude=e,this.longitude=t,this.altitude=r}static fromDegrees(e,t,r){return new u(e,t,r)}static fromRadians(e,t,r){return new u(i.MathUtils.radToDeg(e),i.MathUtils.radToDeg(t),r)}static fromLatLng(e){return new u(e.lat,e.lng)}static fromGeoPoint(e){return new u(e[1],e[0],e[2])}static fromObject(e){if(o.isGeoPointLike(e))return u.fromGeoPoint(e);if(n.isGeoCoordinatesLike(e))return u.fromDegrees(e.latitude,e.longitude,e.altitude);if(s.isLatLngLike(e))return u.fromDegrees(e.lat,e.lng);throw new Error("Invalid input coordinate format.")}static lerp(e,t,r,i=!1,n=!1){var o,s;if(i){if(e.lng<t.lng){const i=e.clone();return i.longitude+=360,this.lerp(t,i,1-r)}{const i=t.clone();return i.longitude+=360,this.lerp(e,i,r)}}const c=a.set(e.lat,e.lng,null!==(o=e.altitude)&&void 0!==o?o:0),h=l.set(t.lat,t.lng,null!==(s=t.altitude)&&void 0!==s?s:0);c.lerp(h,r);const d=new u(c.x,c.y,c.z);return n?d.normalized():d}get latitudeInRadians(){return i.MathUtils.degToRad(this.latitude)}get longitudeInRadians(){return i.MathUtils.degToRad(this.longitude)}get latitudeInDegrees(){return this.latitude}get longitudeInDegrees(){return this.longitude}get lat(){return this.latitude}get lng(){return this.longitude}isValid(){return!isNaN(this.latitude)&&!isNaN(this.longitude)}normalized(){let{latitude:e,longitude:t}=this;return isNaN(e)||isNaN(t)?this:((t<-180||t>180)&&(t=function(e,t){const r=e%360;return r<0==0?r:r+360}(t+180)-180),e=i.MathUtils.clamp(e,-90,90),new u(e,t,this.altitude))}equals(e){return this.latitude===e.latitude&&this.longitude===e.longitude&&this.altitude===e.altitude}copy(e){return this.latitude=e.latitude,this.longitude=e.longitude,this.altitude=e.altitude,this}clone(){return new u(this.latitude,this.longitude,this.altitude)}toLatLng(){return{lat:this.latitude,lng:this.longitude}}toGeoPoint(){return void 0!==this.altitude?[this.longitude,this.latitude,this.altitude]:[this.longitude,this.latitude]}minLongitudeSpanTo(e){const t=Math.min(this.longitude,e.longitude),r=Math.max(this.longitude,e.longitude);return Math.min(r-t,360+t-r)}}t.GeoCoordinates=u},7466:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isGeoCoordinatesLike=void 0,t.isGeoCoordinatesLike=function(e){return e&&"number"==typeof e.latitude&&"number"==typeof e.longitude&&("number"==typeof e.altitude||void 0===e.altitude)}},6233:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isGeoPointLike=void 0,t.isGeoPointLike=function(e){if(Array.isArray(e)){const[t,r,i]=e;return"number"==typeof t&&"number"==typeof r&&(void 0===i||"number"==typeof i)}return!1}},2779:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GeoPolygon=t.isAntimeridianCrossing=void 0;const i=r(4428),n=r(2931),o=r(7073),s=r(4908);function a(e,t){return Math.max(e,t)-Math.min(e,t)}function l(e,t){return e>0&&t<0&&a(e,t)>180}t.isAntimeridianCrossing=function(e,t){return Math.sign(e)===-Math.sign(t)&&a(e,t)>180},t.GeoPolygon=class{constructor(e,t=!1,r=!1){this.m_coordinates=e.map((e=>s.geoCoordLikeToGeoCoordinatesLike(e))),t&&this.sortCCW(),r&&this.wrapCoordinatesAround()}get coordinates(){return this.m_coordinates}getGeoBoundingBox(){const e=this.getCentroid();if(void 0===e)return n.GeoBox.fromCoordinates(this.coordinates[0],this.coordinates[0]);const{east:t,west:r}=this.getEastAndWest(e),{north:i,south:s}=this.getNorthAndSouth();return n.GeoBox.fromCoordinates(new o.GeoCoordinates(s,r),new o.GeoCoordinates(i,t))}getCentroid(){const e=this.getArea();if(0===e)return;let t,r=0,i=0,n=this.m_coordinates.length-1;return this.m_coordinates.forEach(((e,o)=>{const s=this.m_coordinates[n];t=e.latitude*s.longitude-s.latitude*e.longitude,r+=(e.latitude+s.latitude)*t,i+=(e.longitude+s.longitude)*t,n=o})),t=6*e,new o.GeoCoordinates(r/t,e<0?i/t-180:i/t)}sortCCW(){const e=this.getPolyAverageCenter();e&&this.m_coordinates.sort(((t,r)=>{const n=new i.Vector2(t.latitude-e.latitude,t.longitude-e.longitude).normalize();return new i.Vector2(r.latitude-e.latitude,r.longitude-e.longitude).normalize().angle()-n.angle()}))}wrapCoordinatesAround(){const e=this.m_coordinates.findIndex(((e,t)=>{const r=0===t?this.m_coordinates.length-1:t-1;return l(this.m_coordinates[r].longitude,e.longitude)}));if(e<0)return;let t=!0;for(let r=0;r<this.m_coordinates.length;r++){const i=(e+r)%this.m_coordinates.length,n=this.m_coordinates[i].longitude,o=this.m_coordinates[(i+1)%this.m_coordinates.length].longitude;t&&(this.m_coordinates[i].longitude+=360),l(o,n)?t=!1:l(n,o)&&(t=!0)}}getPolyAverageCenter(){const e=this.m_coordinates.reduce(((e,t)=>new o.GeoCoordinates(e.latitude+t.latitude,e.longitude+t.longitude)));return new o.GeoCoordinates(e.latitude/this.m_coordinates.length,e.longitude/this.m_coordinates.length)}getArea(){let e=0,t=this.m_coordinates.length-1;return this.m_coordinates.forEach(((r,i)=>{const n=this.m_coordinates[t];e+=r.latitude*n.longitude,e-=r.longitude*n.latitude,t=i})),e/=2}getEastAndWest(e){let t=e.longitude,r=e.longitude,n=this.m_coordinates.length-1;return this.m_coordinates.forEach(((o,s)=>{const a=this.m_coordinates[n];n=s;const l=new i.Vector2(o.latitude-e.latitude,o.longitude-e.longitude).normalize(),u=new i.Vector2(a.latitude-e.latitude,a.longitude-e.longitude).normalize();let c=1===Math.sign(u.angle()-l.angle());u.y>=0&&l.y<0&&(c=!0);const h=o.longitude;h<e.longitude?c?t=Math.min(t,h):r=Math.min(r,h):c?r=Math.max(r,h):t=Math.max(t,h)})),{east:r,west:t}}getNorthAndSouth(){let e=o.MIN_LATITUDE,t=o.MAX_LATITUDE;return this.m_coordinates.forEach(((r,i)=>{e=Math.max(e,r.latitude),t=Math.min(t,r.latitude)})),{north:e,south:t}}}},2553:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isGeoPolygonLike=void 0;const i=r(4908);t.isGeoPolygonLike=function(e){if(!e||!Array.isArray(e.coordinates)&&e.coordinates.length>2)return!1;let t=!0;return e.coordinates.forEach((r=>{i.isGeoCoordLike(e)||(t=!1)})),t}},6373:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isLatLngLike=void 0,t.isLatLngLike=function(e){return e&&"number"==typeof e.lat&&"number"==typeof e.lng}},8909:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isBox3Like=void 0,t.isBox3Like=function(e){const t=e;return void 0!==t.min&&void 0!==t.max}},6256:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MathUtils=void 0;const i=r(4428);!function(e){function t(e){return(e%=360)<0&&(e+=360),e}function r(e,r){const i=(e=t(e))-(r=t(r));return i>180?i-360:i<=-180?i+360:i}e.newEmptyBox3=function(){return{min:{x:1/0,y:1/0,z:1/0},max:{x:-1/0,y:-1/0,z:-1/0}}},e.newVector3=function(e,t,r,i){return void 0===i?{x:e,y:t,z:r}:(i.x=e,i.y=t,i.z=r,i)},e.copyVector3=function(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t},e.degToRad=i.MathUtils.degToRad,e.radToDeg=i.MathUtils.radToDeg,e.clamp=i.MathUtils.clamp,e.normalizeAngleDeg=t,e.normalizeLongitudeDeg=function(e){return(e=t(e))>180&&(e-=360),e},e.angleDistanceDeg=r,e.interpolateAnglesDeg=function(e,t,i){return(e+r(t,e)*i)%360}}(t.MathUtils||(t.MathUtils={}))},8703:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OrientedBox3=void 0;const i=r(4428);function n(e,t,r,i,n){const o=r.dot(t),s=r.dot(e);if(Math.abs(s)<1e-20)return Math.abs(o)<=i;const a=1/s,l=(o+i)*a,u=(o-i)*a;return l>u?(u>n.min&&(n.min=u),l<n.max&&(n.max=l)):(l>n.min&&(n.min=l),u<n.max&&(n.max=u)),n.min<=n.max&&n.max>=0}const o=new i.Vector3,s={min:-1/0,max:1/0};class a{constructor(e,t,r){this.position=new i.Vector3,this.xAxis=new i.Vector3(1,0,0),this.yAxis=new i.Vector3(0,1,0),this.zAxis=new i.Vector3(0,0,1),this.extents=new i.Vector3,void 0!==e&&this.position.copy(e),void 0!==t&&t.extractBasis(this.xAxis,this.yAxis,this.zAxis),void 0!==r&&this.extents.copy(r)}clone(){const e=new a;return e.copy(this),e}copy(e){this.position.copy(e.position),this.xAxis.copy(e.xAxis),this.yAxis.copy(e.yAxis),this.zAxis.copy(e.zAxis),this.extents.copy(e.extents)}getCenter(e=new i.Vector3){return e.copy(this.position)}getSize(e=new i.Vector3){return e.copy(this.extents).multiplyScalar(2)}getRotationMatrix(e=new i.Matrix4){return e.makeBasis(this.xAxis,this.yAxis,this.zAxis)}intersects(e){const t=Array.isArray(e)?e:e.planes;for(const e of t){const t=Math.abs(e.normal.dot(this.xAxis)*this.extents.x)+Math.abs(e.normal.dot(this.yAxis)*this.extents.y)+Math.abs(e.normal.dot(this.zAxis)*this.extents.z);if(e.distanceToPoint(this.position)+t<0)return!1}return!0}intersectsRay(e){if(s.min=-1/0,s.max=1/0,o.copy(this.position).sub(e.origin),n(e.direction,o,this.xAxis,this.extents.x,s)&&n(e.direction,o,this.yAxis,this.extents.y,s)&&n(e.direction,o,this.zAxis,this.extents.z,s))return s.min>0?s.min:s.max}contains(e){const t=e.x-this.position.x,r=e.y-this.position.y,i=e.z-this.position.z,n=Math.abs(t*this.xAxis.x+r*this.xAxis.y+i*this.xAxis.z),o=Math.abs(t*this.yAxis.x+r*this.yAxis.y+i*this.yAxis.z),s=Math.abs(t*this.zAxis.x+r*this.zAxis.y+i*this.zAxis.z);return!(n>this.extents.x||o>this.extents.y||s>this.extents.z)}distanceToPoint(e){return Math.sqrt(this.distanceToPointSquared(e))}distanceToPointSquared(e){const t=new i.Vector3;t.subVectors(e,this.position);const r=[t.dot(this.xAxis),t.dot(this.yAxis),t.dot(this.zAxis)];let n=0;for(let e=0;e<3;++e){const t=r[e],i=this.extents.getComponent(e);if(t<-i){const e=i+t;n+=e*e}else if(t>i){const e=t-i;n+=e*e}}return n}}t.OrientedBox3=a},2076:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isOrientedBox3Like=void 0,t.isOrientedBox3Like=function(e){const t=e;return void 0!==t.position&&void 0!==t.xAxis&&void 0!==t.yAxis&&void 0!==t.zAxis&&void 0!==t.extents}},463:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isTransformLike=void 0,t.isTransformLike=function(e){const t=e;return void 0!==t.position&&void 0!==t.xAxis&&void 0!==t.yAxis&&void 0!==t.zAxis}},5644:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isVector2Like=void 0,t.isVector2Like=function(e){return e&&"number"==typeof e.x&&"number"==typeof e.y}},4222:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isVector3Like=void 0,t.isVector3Like=function(e){return e&&"number"==typeof e.x&&"number"==typeof e.y&&"number"==typeof e.z}},9881:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EarthConstants=void 0;class r{}t.EarthConstants=r,r.EQUATORIAL_CIRCUMFERENCE=40075016.68557849,r.EQUATORIAL_RADIUS=6378137,r.MIN_ELEVATION=-433,r.MAX_ELEVATION=8848,r.MAX_BUILDING_HEIGHT=828},120:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.equirectangularProjection=t.normalizedEquirectangularProjection=void 0;const i=r(4428),n=r(2931),o=r(7073),s=r(8909),a=r(6256),l=r(2076),u=r(9881),c=r(8816);class h extends c.Projection{constructor(){super(...arguments),this.type=c.ProjectionType.Planar}getScaleFactor(e){return 1}worldExtent(e,t,r){return r||(r=new i.Box3),r.min.x=0,r.min.y=0,r.min.z=e,r.max.x=this.unitScale,r.max.y=this.unitScale/2,r.max.z=t,r}projectPoint(e,t){var r;return void 0===t&&(t={x:0,y:0,z:0}),t.x=(i.MathUtils.degToRad(e.longitude)+Math.PI)*h.geoToWorldScale*this.unitScale,t.y=(i.MathUtils.degToRad(e.latitude)+.5*Math.PI)*h.geoToWorldScale*this.unitScale,t.z=null!==(r=e.altitude)&&void 0!==r?r:0,t}unprojectPoint(e){return o.GeoCoordinates.fromRadians(e.y*h.worldToGeoScale/this.unitScale-.5*Math.PI,e.x*h.worldToGeoScale/this.unitScale-Math.PI,e.z)}unprojectAltitude(e){return e.z}projectBox(e,t){const r=this.projectPoint(new o.GeoCoordinates(e.center.latitude,e.center.longitude,0)),{latitudeSpanInRadians:n,longitudeSpanInRadians:u,altitudeSpan:c}=e,d=u*h.geoToWorldScale,f=n*h.geoToWorldScale;return t||(t=new i.Box3),s.isBox3Like(t)?(t.min.x=r.x-.5*d*this.unitScale,t.min.y=r.y-.5*f*this.unitScale,t.max.x=r.x+.5*d*this.unitScale,t.max.y=r.y+.5*f*this.unitScale,void 0!==c?(t.min.z=r.z-.5*c,t.max.z=r.z+.5*c):(t.min.z=0,t.max.z=0)):l.isOrientedBox3Like(t)&&(a.MathUtils.newVector3(1,0,0,t.xAxis),a.MathUtils.newVector3(0,1,0,t.yAxis),a.MathUtils.newVector3(0,0,1,t.zAxis),t.position.x=r.x,t.position.y=r.y,t.position.z=r.z,t.extents.x=.5*d*this.unitScale,t.extents.y=.5*f*this.unitScale,t.extents.z=Math.max(Number.EPSILON,.5*(null!=c?c:0))),t}unprojectBox(e){const t=this.unprojectPoint(e.min),r=this.unprojectPoint(e.max);return n.GeoBox.fromCoordinates(t,r)}groundDistance(e){return e.z}scalePointToSurface(e){return e.z=0,e}surfaceNormal(e,t){return void 0===t?t={x:0,y:0,z:1}:(t.x=0,t.y=0,t.z=1),t}}h.geoToWorldScale=1/(2*Math.PI),h.worldToGeoScale=2*Math.PI/1,t.normalizedEquirectangularProjection=new h(1),t.equirectangularProjection=new h(u.EarthConstants.EQUATORIAL_CIRCUMFERENCE)},7746:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.identityProjection=void 0;const i=r(4428),n=r(2931),o=r(7073),s=r(8909),a=r(6256),l=r(2076),u=r(8816);class c extends u.Projection{constructor(){super(...arguments),this.type=u.ProjectionType.Planar}getScaleFactor(e){return 1}worldExtent(e,t,r){return r||(r=new i.Box3),r.min.x=-Math.PI,r.min.y=.5*-Math.PI,r.min.z=e,r.max.x=Math.PI,r.max.y=.5*Math.PI,r.max.z=t,r}projectPoint(e,t){var r;return t||(t={x:0,y:0,z:0}),t.x=i.MathUtils.degToRad(e.longitude),t.y=i.MathUtils.degToRad(e.latitude),t.z=null!==(r=e.altitude)&&void 0!==r?r:0,t}unprojectPoint(e){return o.GeoCoordinates.fromRadians(e.y,e.x,e.z)}unprojectAltitude(e){return e.z}projectBox(e,t){t||(t=new i.Box3);const r=this.projectPoint(new o.GeoCoordinates(e.south,e.west,e.minAltitude)),n=this.projectPoint(new o.GeoCoordinates(e.north,e.east,e.maxAltitude));return s.isBox3Like(t)?(t.min.x=r.x,t.min.y=r.y,t.min.z=r.z,t.max.x=n.x,t.max.y=n.y,t.max.z=n.z):l.isOrientedBox3Like(t)&&(a.MathUtils.newVector3(1,0,0,t.xAxis),a.MathUtils.newVector3(0,1,0,t.yAxis),a.MathUtils.newVector3(0,0,1,t.zAxis),t.position.x=.5*(r.x+n.x),t.position.y=.5*(r.y+n.y),t.position.z=.5*(r.z+n.z),t.extents.x=.5*(n.x-r.x),t.extents.y=.5*(n.y-r.y),t.extents.z=Math.max(Number.EPSILON,.5*(n.z-r.z))),t}unprojectBox(e){const t=this.unprojectPoint(e.min),r=this.unprojectPoint(e.max);return n.GeoBox.fromCoordinates(t,r)}groundDistance(e){return e.z}scalePointToSurface(e){return e.z=0,e}surfaceNormal(e,t){return void 0===t?t={x:0,y:0,z:1}:(t.x=0,t.y=0,t.z=1),t}}t.identityProjection=new c(1)},1404:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.webMercatorProjection=t.mercatorProjection=t.MercatorConstants=void 0;const i=r(4428),n=r(2931),o=r(7073),s=r(7466),a=r(8909),l=r(6256),u=r(2076),c=r(9881),h=r(8816);class d extends h.Projection{constructor(){super(...arguments),this.type=h.ProjectionType.Planar}static clamp(e,t,r){return Math.min(Math.max(t,e),r)}static latitudeClamp(e){return d.clamp(e,-f.MAXIMUM_LATITUDE,f.MAXIMUM_LATITUDE)}static latitudeProject(e){return Math.log(Math.tan(.25*Math.PI+.5*e))/Math.PI}static latitudeClampProject(e){return d.latitudeProject(d.latitudeClamp(e))}static unprojectLatitude(e){return 2*Math.atan(Math.exp(Math.PI*e))-.5*Math.PI}getScaleFactor(e){return Math.cosh(2*Math.PI*(e.y/this.unitScale-.5))}worldExtent(e,t,r){return r||(r=new i.Box3),r.min.x=0,r.min.y=0,r.min.z=e,r.max.x=this.unitScale,r.max.y=this.unitScale,r.max.z=t,r}projectPoint(e,t){var r;let i;return i=e instanceof o.GeoCoordinates?e:new o.GeoCoordinates(e.latitude,e.longitude,e.altitude),t||(t={x:0,y:0,z:0}),t.x=(i.longitude+180)/360*this.unitScale,t.y=(.5*d.latitudeClampProject(i.latitudeInRadians)+.5)*this.unitScale,t.z=null!==(r=i.altitude)&&void 0!==r?r:0,t}unprojectPoint(e){return o.GeoCoordinates.fromRadians(d.unprojectLatitude(2*(e.y/this.unitScale-.5)),e.x/this.unitScale*2*Math.PI-Math.PI,e.z)}unprojectAltitude(e){return e.z}projectBox(e,t){var r;const n=this.projectPoint(e.center),o=(.5*d.latitudeClampProject(e.northEast.latitudeInRadians)+.5)*this.unitScale,s=(.5*d.latitudeClampProject(e.southWest.latitudeInRadians)+.5)*this.unitScale,c=.5*(o+s);n.y=c;const h=o-s,f=e.longitudeSpan/360*this.unitScale;if(t||(t=new i.Box3),a.isBox3Like(t)){t.min.x=n.x-.5*f,t.min.y=n.y-.5*h,t.max.x=n.x+.5*f,t.max.y=n.y+.5*h;const r=e.altitudeSpan;void 0!==r?(t.min.z=n.z-.5*r,t.max.z=n.z+.5*r):(t.min.z=0,t.max.z=0)}else{if(!u.isOrientedBox3Like(t))throw new Error("invalid bounding box");l.MathUtils.newVector3(1,0,0,t.xAxis),l.MathUtils.newVector3(0,1,0,t.yAxis),l.MathUtils.newVector3(0,0,1,t.zAxis),t.position.x=n.x,t.position.y=n.y,t.position.z=n.z,t.extents.x=.5*f,t.extents.y=.5*h,t.extents.z=Math.max(Number.EPSILON,.5*(null!==(r=e.altitudeSpan)&&void 0!==r?r:0))}return t}unprojectBox(e){const t=this.unprojectPoint(e.min),r=this.unprojectPoint(e.max);return n.GeoBox.fromCoordinates(t,r)}groundDistance(e){return e.z}scalePointToSurface(e){return e.z=0,e}surfaceNormal(e,t){return void 0===t?t={x:0,y:0,z:1}:(t.x=0,t.y=0,t.z=1),t}reprojectPoint(e,r,i){return e===this||e!==t.webMercatorProjection&&e!==t.mercatorProjection?super.reprojectPoint(e,r,i):(void 0===i&&(i={}),i.x=r.x,i.y=this.unitScale-r.y,i.z=r.z,i)}}class f{}t.MercatorConstants=f,f.MAXIMUM_LATITUDE=1.4844222297453322,t.mercatorProjection=new d(c.EarthConstants.EQUATORIAL_CIRCUMFERENCE),t.webMercatorProjection=new class extends d{projectPoint(e,t){var r;let i;i=e instanceof o.GeoCoordinates?e:new o.GeoCoordinates(e.latitude,e.longitude,e.altitude),t||(t={x:0,y:0,z:0}),t.x=(i.longitude+180)/360*this.unitScale;const n=Math.sin(d.latitudeClamp(i.latitudeInRadians));return t.y=(.5-Math.log((1+n)/(1-n))/(4*Math.PI))*this.unitScale,t.z=null!==(r=i.altitude)&&void 0!==r?r:0,t}unprojectPoint(e){const t=e.x/this.unitScale-.5,r=.5-e.y/this.unitScale,i=360*t,n=90-360*Math.atan(Math.exp(2*-r*Math.PI))/Math.PI;return new o.GeoCoordinates(n,i,e.z)}projectBox(e,t){const r=super.projectBox(e,t);if(a.isBox3Like(r)){const e=r.max.y;r.max.y=this.unitScale-r.min.y,r.min.y=this.unitScale-e}else u.isOrientedBox3Like(r)&&(l.MathUtils.newVector3(1,0,0,r.xAxis),l.MathUtils.newVector3(0,-1,0,r.yAxis),l.MathUtils.newVector3(0,0,-1,r.zAxis),r.position.y=this.unitScale-r.position.y);return r}unprojectBox(e){const t=this.unprojectPoint(e.min),r=this.unprojectPoint(e.max);return new n.GeoBox(new o.GeoCoordinates(r.latitude,t.longitude,t.altitude),new o.GeoCoordinates(t.latitude,r.longitude,r.altitude))}surfaceNormal(e,t){return void 0===t?t={x:0,y:0,z:-1}:(t.x=0,t.y=0,t.z=-1),t}localTangentSpace(e,t){return s.isGeoCoordinatesLike(e)?this.projectPoint(e,t.position):l.MathUtils.copyVector3(e,t.position),l.MathUtils.newVector3(1,0,0,t.xAxis),l.MathUtils.newVector3(0,-1,0,t.yAxis),l.MathUtils.newVector3(0,0,-1,t.zAxis),t}}(c.EarthConstants.EQUATORIAL_CIRCUMFERENCE)},8816:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Projection=t.ProjectionType=void 0;const i=r(7466),n=r(6256);var o;(o=t.ProjectionType||(t.ProjectionType={}))[o.Planar=0]="Planar",o[o.Spherical=1]="Spherical",t.Projection=class{constructor(e){this.unitScale=e}localTangentSpace(e,t){return i.isGeoCoordinatesLike(e)?this.projectPoint(e,t.position):n.MathUtils.copyVector3(e,t.position),n.MathUtils.newVector3(1,0,0,t.xAxis),n.MathUtils.newVector3(0,1,0,t.yAxis),n.MathUtils.newVector3(0,0,1,t.zAxis),t}reprojectPoint(e,t,r){return e===this?void 0===r?{x:t.x,y:t.y,z:t.z}:(r.x=t.x,r.y=t.y,r.z=t.z,r):this.projectPoint(e.unprojectPoint(t),r)}}},8457:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.sphereProjection=void 0;const i=r(4428),n=r(7073),o=r(7466),s=r(8909),a=r(6256),l=r(2076),u=r(9881),c=r(1404),h=r(8816);function d(e){const t=1/Math.PI,r=Math.floor(2*(e*t+1));return i.MathUtils.clamp(r,0,4)}function f(e){return Math.sqrt(e.x*e.x+e.y*e.y+e.z*e.z)}function p(e,t,r){var n;const o=.5*(r+(null!==(n=e.maxAltitude)&&void 0!==n?n:0)),s=i.MathUtils.degToRad(e.west),a=i.MathUtils.degToRad(e.east),l=d(s),u=d(a);let c=Math.cos(s),h=c,f=Math.sin(s),p=f;for(let e=l+1;e<=u;e++){const t=(e+1&1)*((2&e)-1);c=Math.min(t,c),h=Math.max(t,h);const r=(1&e)*((2&e)-1);f=Math.min(r,f),p=Math.max(r,p)}const m=Math.cos(a);c=Math.min(m,c),h=Math.max(m,h);const g=Math.sin(a);f=Math.min(g,f),p=Math.max(g,p);const v=(h+c)*o,y=(h-c)*o,x=(p+f)*o,_=(p-f)*o,b=i.MathUtils.degToRad(e.south),w=i.MathUtils.degToRad(e.north),E=Math.sin(w),S=Math.sin(b),M=(E+S)*o,T=(E-S)*o;return t.min.x=v-y,t.min.y=x-_,t.min.z=M-T,t.max.x=v+y,t.max.y=x+_,t.max.z=M+T,t}class m extends h.Projection{constructor(){super(...arguments),this.type=h.ProjectionType.Spherical}worldExtent(e,t,r=new i.Box3){const n=this.unitScale+t;return r.min.x=-n,r.min.y=-n,r.min.z=-n,r.max.x=n,r.max.y=n,r.max.z=n,r}projectPoint(e,t=a.MathUtils.newVector3(0,0,0)){return function(e,t,r){var n;const o=r+(null!==(n=e.altitude)&&void 0!==n?n:0),s=i.MathUtils.degToRad(e.latitude),a=i.MathUtils.degToRad(e.longitude),l=Math.cos(s);return t.x=o*l*Math.cos(a),t.y=o*l*Math.sin(a),t.z=o*Math.sin(s),t}(e,t,this.unitScale)}unprojectPoint(e){const t=e.x*e.x+e.y*e.y,r=Math.sqrt(t),i=e.z/r;if(isNaN(i))return n.GeoCoordinates.fromRadians(0,0,-this.unitScale);const o=Math.sqrt(t+e.z*e.z);return n.GeoCoordinates.fromRadians(Math.atan(i),Math.atan2(e.y,e.x),o-this.unitScale)}unprojectAltitude(e){const t=e.x*e.x+e.y*e.y+e.z*e.z;return Math.sqrt(t)-u.EarthConstants.EQUATORIAL_RADIUS}projectBox(e,t=new i.Box3){var r,n;if(s.isBox3Like(t))return p(e,t,this.unitScale);if(l.isOrientedBox3Like(t)){if(e.longitudeSpan>=90){const r=p(e,new i.Box3,this.unitScale);return a.MathUtils.newVector3(1,0,0,t.xAxis),a.MathUtils.newVector3(0,1,0,t.yAxis),a.MathUtils.newVector3(0,0,1,t.zAxis),t.position.x=.5*(r.max.x+r.min.x),t.position.y=.5*(r.max.y+r.min.y),t.position.z=.5*(r.max.z+r.min.z),t.extents.x=.5*(r.max.x-r.min.x),t.extents.y=.5*(r.max.y-r.min.y),t.extents.z=.5*(r.max.z-r.min.z),t}const{south:o,west:s,north:l,east:u,center:c}=e,h=c.longitude,d=c.latitude,f=Math.cos(i.MathUtils.degToRad(o)),m=Math.sin(i.MathUtils.degToRad(o)),g=Math.cos(i.MathUtils.degToRad(s)),v=Math.sin(i.MathUtils.degToRad(s)),y=Math.cos(i.MathUtils.degToRad(l)),x=Math.sin(i.MathUtils.degToRad(l)),_=Math.cos(i.MathUtils.degToRad(u)),b=Math.sin(i.MathUtils.degToRad(u)),w=Math.cos(i.MathUtils.degToRad(h)),E=Math.sin(i.MathUtils.degToRad(h)),S=Math.cos(i.MathUtils.degToRad(d)),M=Math.sin(i.MathUtils.degToRad(d));let T,P,A;a.MathUtils.newVector3(w*S,E*S,M,t.zAxis),a.MathUtils.newVector3(-E,w,0,t.xAxis),a.MathUtils.newVector3(-w*M,-E*M,S,t.yAxis),o>=0?(T=Math.abs(f*(w*(v-b)+E*(_-g))),P=S*m-M*f,A=S*x-M*y*(w*_+E*b)):(l<=0?(T=Math.abs(y*(w*(v-b)+E*(_-g))),A=S*x-M*y):(T=Math.abs(w*(v-b)+E*(_-g)),A=S*x-M*y*(E*b+w*_)),P=S*m-M*f*(w*_+E*b));const L=.5*(this.unitScale+(null!==(r=e.maxAltitude)&&void 0!==r?r:0)),C=.5*(this.unitScale+(null!==(n=e.minAltitude)&&void 0!==n?n:0)),O=S*(w*_+E*b),R=Math.min(y*O+x*M,f*O+m*M);return a.MathUtils.newVector3(T*L,(A-P)*L,L-R*C,t.extents),a.MathUtils.newVector3(0,(P+A)*L,L+L,t.position),function(e,t,r,i){const n=e.x*i.x+t.x*i.y+r.x*i.z,o=e.y*i.x+t.y*i.y+r.y*i.z,s=e.z*i.x+t.z*i.y+r.z*i.z;i.x=n,i.y=o,i.z=s}(t.xAxis,t.yAxis,t.zAxis,t.position),t.position.x=t.position.x-t.zAxis.x*t.extents.z,t.position.y=t.position.y-t.zAxis.y*t.extents.z,t.position.z=t.position.z-t.zAxis.z*t.extents.z,t}throw new Error("Invalid bounding box")}unprojectBox(e){throw new Error("Method not implemented.")}getScaleFactor(e){return 1}groundDistance(e){return f(e)-this.unitScale}scalePointToSurface(e){const t=this.unitScale/(f(e)||1);return e.x*=t,e.y*=t,e.z*=t,e}surfaceNormal(e,t){void 0===t&&(t={x:0,y:0,z:0});const r=1/(f(e)||1);return t.x=e.x*r,t.y=e.y*r,t.z=e.z*r,t}reprojectPoint(e,t,r){if(e===c.mercatorProjection||e===c.webMercatorProjection){const{x:i,y:n,z:o}=t,s=this.unitScale,a=i/s-Math.PI,l=n/s-Math.PI,u=Math.exp(l),h=u*u,d=2*u/(h+1),f=(h-1)/(h+1),p=s+o;return void 0===r&&(r={}),r.x=Math.cos(a)*d*p,r.y=Math.sin(a)*d*p,r.z=f*p,e===c.webMercatorProjection&&(r.z=-r.z),r}return super.reprojectPoint(e,t,r)}localTangentSpace(e,t){let r;o.isGeoCoordinatesLike(e)?(this.projectPoint(e,t.position),r=e):(a.MathUtils.copyVector3(e,t.position),r=this.unprojectPoint(e));const n=i.MathUtils.degToRad(r.latitude),s=i.MathUtils.degToRad(r.longitude),l=Math.cos(s),u=Math.sin(s),c=Math.cos(n),h=Math.sin(n);return a.MathUtils.newVector3(l*c,u*c,h,t.zAxis),a.MathUtils.newVector3(-u,l,0,t.xAxis),a.MathUtils.newVector3(-l*h,-u*h,c,t.yAxis),t}}t.sphereProjection=new m(u.EarthConstants.EQUATORIAL_RADIUS)},115:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.transverseMercatorProjection=t.TransverseMercatorUtils=void 0;const i=r(4428),n=r(2931),o=r(7073),s=r(8909),a=r(6256),l=r(2076),u=r(9881),c=r(8816);class h extends c.Projection{constructor(e){super(e),this.unitScale=e,this.type=c.ProjectionType.Planar,this.m_phi0=0,this.m_lambda0=0}static clampGeoPoint(e,t){const r=e.latitude,i=e.longitude,n=d.POLE_RADIUS,s=d.POLE_RADIUS_SQ,a=Math.round(i/90),l=90*a-i;if(a%2==0||Math.abs(l)>n)return e;const u=r-0,c=l*l+u*u;if(c<s){const e=Math.sqrt(c),t=(n-e)/e,s=1,a=0===l&&0===u?n*s:l;return new o.GeoCoordinates(r+u*t,i+a*t)}return e}getScaleFactor(e){return Math.cosh(2*(e.x/this.unitScale-.5)*Math.PI)}worldExtent(e,t,r){return r||(r=new i.Box3),r.min.x=0,r.min.y=0,r.min.z=e,r.max.x=this.unitScale,r.max.y=this.unitScale,r.max.z=t,r}projectPoint(e,t){var r;t||(t={x:0,y:0,z:0});const n=h.clampGeoPoint(e,this.unitScale),o=n.longitude/360+.5,s=1===o?0:Math.floor(o),a=i.MathUtils.degToRad(n.latitude),l=i.MathUtils.degToRad(n.longitude-360*s)-this.m_lambda0,u=Math.cos(a)*Math.sin(l);t.x=Math.atanh(u),t.y=Math.atan2(Math.tan(a),Math.cos(l))-this.m_phi0;const c=.5/Math.PI;return t.x=this.unitScale*(i.MathUtils.clamp(t.x*c+.5,0,1)+s),t.y=this.unitScale*i.MathUtils.clamp(t.y*c+.5,0,1),t.z=null!==(r=e.altitude)&&void 0!==r?r:0,t}unprojectPoint(e){const t=2*Math.PI,r=e.x/this.unitScale,i=e.y/this.unitScale,n=1===r?0:Math.floor(r),s=t*(r-.5-n),a=t*(i-.5),l=e.z||0,u=a+this.m_phi0,c=Math.asin(Math.sin(u)/Math.cosh(s)),h=this.m_lambda0+Math.atan2(Math.sinh(s),Math.cos(u))+n*t;return o.GeoCoordinates.fromRadians(c,h,l)}projectBox(e,t){const{north:r,south:n,east:u,west:c}=e,h=[e.center,e.northEast,e.southWest,new o.GeoCoordinates(n,u),new o.GeoCoordinates(r,c)],f=d.POLE_EDGE_DEG,p=c<90&&u>90,m=c<0&&u>0,g=c<f&&u>-f&&r>0&&n<0;c<-90&&u>-90&&(h.push(new o.GeoCoordinates(r,-90)),h.push(new o.GeoCoordinates(n,-90))),p&&(h.push(new o.GeoCoordinates(r,90)),h.push(new o.GeoCoordinates(n,90))),m&&(h.push(new o.GeoCoordinates(r,0)),h.push(new o.GeoCoordinates(n,0))),g&&(h.push(new o.GeoCoordinates(0,c)),h.push(new o.GeoCoordinates(0,u))),d.alignLatitude(h,h[0]);const v=h.map((e=>this.projectPoint(e))),y=v.map((e=>e.x)),x=v.map((e=>e.y)),_=v.map((e=>e.z)),b=Math.min(...y),w=Math.min(...x),E=Math.min(..._),S=Math.max(...y),M=Math.max(...x),T=Math.max(..._);if(t||(t=new i.Box3),s.isBox3Like(t))t.min.x=b,t.min.y=w,t.min.z=E,t.max.x=S,t.max.y=M,t.max.z=T;else{if(!l.isOrientedBox3Like(t))throw new Error("invalid bounding box");a.MathUtils.newVector3(1,0,0,t.xAxis),a.MathUtils.newVector3(0,1,0,t.yAxis),a.MathUtils.newVector3(0,0,1,t.zAxis),t.position.x=(b+S)/2,t.position.y=(w+M)/2,t.position.z=(E+T)/2,t.extents.x=(S-b)/2,t.extents.y=(M-w)/2,t.extents.z=(T-E)/2}return t}unprojectBox(e){const t=this.unitScale,r=e.min,i=e.max,s=[{x:(r.x+i.x)/2,y:(r.y+i.y)/2,z:0},r,i,{x:r.x,y:i.y,z:0},{x:i.x,y:r.y,z:0}],a=.5*t,l=.25*t,u=.75*t,c=r.x<a&&i.x>a,h=r.y<a&&i.y>a,f=r.y<l&&i.y>l,p=r.y<u&&i.y>u;h&&(s.push({x:r.x,y:a,z:0}),s.push({x:i.x,y:a,z:0}),c&&s.push({x:a,y:a,z:0})),f&&(s.push({x:r.x,y:l,z:0}),s.push({x:i.x,y:l,z:0}),c&&s.push({x:a,y:l,z:0})),p&&(s.push({x:r.x,y:u,z:0}),s.push({x:i.x,y:u,z:0}),c&&s.push({x:a,y:u,z:0}));const m=s.map((e=>this.unprojectPoint(e)));d.alignLongitude(m,m[0]);const g=m.map((e=>e.latitude)),v=m.filter((e=>Math.abs(e.latitude)<90)).map((e=>e.longitude)),y=m.map((e=>{var t;return null!==(t=e.altitude)&&void 0!==t?t:0})),x=new o.GeoCoordinates(Math.min(...g),Math.min(...v),Math.min(...y)),_=new o.GeoCoordinates(Math.max(...g),Math.max(...v),Math.max(...y));return n.GeoBox.fromCoordinates(x,_)}unprojectAltitude(e){return e.z}groundDistance(e){return e.z}scalePointToSurface(e){return e.z=0,e}surfaceNormal(e,t){return void 0===t?t={x:0,y:0,z:-1}:(t.x=0,t.y=0,t.z=-1),t}}class d{static alignLatitude(e,t){for(const r of e)0===r.latitude&&(r.latitude=1e-9*t.latitude)}static alignLongitude(e,t){const r=t.longitude<0?180:-180,i=t.longitude<0?-180:180;for(const t of e)t.longitude===r&&(t.longitude=i)}}t.TransverseMercatorUtils=d,d.POLE_EDGE=1.4844222297453322,d.POLE_EDGE_DEG=i.MathUtils.radToDeg(d.POLE_EDGE),d.POLE_RADIUS=90-d.POLE_EDGE_DEG,d.POLE_RADIUS_SQ=Math.pow(d.POLE_RADIUS,2),t.transverseMercatorProjection=new h(u.EarthConstants.EQUATORIAL_CIRCUMFERENCE)},8053:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FlatTileBoundingBoxGenerator=void 0;const i=r(4428);t.FlatTileBoundingBoxGenerator=class{constructor(e,t=0,r=0){this.tilingScheme=e,this.minElevation=t,this.maxElevation=r,this.m_tilingScheme=e,this.m_worldBox=e.projection.worldExtent(t,r);const{min:i,max:n}=this.m_worldBox;this.m_worldDimensions={x:n.x-i.x,y:n.y-i.y,z:n.z-i.z}}get projection(){return this.m_tilingScheme.projection}get subdivisionScheme(){return this.m_tilingScheme.subdivisionScheme}getWorldBox(e,t){const r=e.level,n=this.subdivisionScheme.getLevelDimensionX(r),o=this.subdivisionScheme.getLevelDimensionY(r),s=this.m_worldDimensions.x/n,a=this.m_worldDimensions.y/o,l=this.m_worldBox.min.x+s*e.column,u=this.m_worldBox.min.y+a*e.row;return t||(t=new i.Box3),t.min.x=l,t.min.y=u,t.min.z=this.m_worldBox.min.z,t.max.x=l+s,t.max.y=u+a,t.max.z=this.m_worldBox.max.z,t}getGeoBox(e){const t=this.getWorldBox(e);return this.projection.unprojectBox(t)}}},4955:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.halfQuadTreeSubdivisionScheme=void 0,t.halfQuadTreeSubdivisionScheme=new class{getSubdivisionX(){return 2}getSubdivisionY(e){return 0===e?1:2}getLevelDimensionX(e){return 1<<e}getLevelDimensionY(e){return 0!==e?1<<e-1:1}}},7821:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.hereTilingScheme=void 0;const i=r(120),n=r(4955),o=r(1914);t.hereTilingScheme=new o.TilingScheme(n.halfQuadTreeSubdivisionScheme,i.normalizedEquirectangularProjection)},1498:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.mercatorTilingScheme=void 0;const i=r(1404),n=r(4276),o=r(1914);t.mercatorTilingScheme=new o.TilingScheme(n.quadTreeSubdivisionScheme,i.mercatorProjection)},8836:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.polarTilingScheme=void 0;const i=r(115),n=r(4276),o=r(1914);t.polarTilingScheme=new o.TilingScheme(n.quadTreeSubdivisionScheme,i.transverseMercatorProjection)},730:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.QuadTree=void 0;const i=r(20);t.QuadTree=class{constructor(e){this.tilingScheme=e}visit(e){this.visitTileKey(i.TileKey.fromRowColumnLevel(0,0,0),e)}visitTileKey(e,t){if(t(e,this.tilingScheme.getGeoBox(e)))for(const r of this.tilingScheme.getSubTileKeys(e))this.visitTileKey(r,t)}}},4276:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.quadTreeSubdivisionScheme=void 0,t.quadTreeSubdivisionScheme=new class{getSubdivisionX(){return 2}getSubdivisionY(){return 2}getLevelDimensionX(e){return 1<<e}getLevelDimensionY(e){return 1<<e}}},5707:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SubTiles=void 0;const i=r(20);class n{constructor(e,t,r){this.tileKey=e,this.sizeX=t,this.sizeY=r}[Symbol.iterator](){return 2===this.sizeX&&2===this.sizeY?n.ZCurveIterator(this.tileKey):n.RowColumnIterator(this.tileKey,this.sizeX,this.sizeY)}}t.SubTiles=n,function(e){e.RowColumnIterator=function*(e,t,r){for(let n=0;n<r;n++)for(let o=0;o<t;o++)yield i.TileKey.fromRowColumnLevel(e.row*r+n,e.column*t+o,e.level+1)},e.ZCurveIterator=function*(e){for(let t=0;t<4;t++)yield i.TileKey.fromRowColumnLevel(e.row<<1|t>>1,e.column<<1|1&t,e.level+1)}}(n=t.SubTiles||(t.SubTiles={}))},6368:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},20:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TileKey=void 0;const r=[1,2,4,8,16,32,64,128,256,512,1024,2048,4096,8192,16384,32768,65536,131072,262144,524288,1048576,2097152,4194304,8388608,16777216,33554432,67108864,134217728,268435456,536870912,1073741824,2147483648,4294967296,8589934592,17179869184,34359738368,68719476736,137438953472,274877906944,549755813888,1099511627776,2199023255552,4398046511104,8796093022208,17592186044416,35184372088832,70368744177664,0x800000000000,281474976710656,562949953421312,0x4000000000000,0x8000000000000,4503599627370496];class i{constructor(e,t,r){this.row=e,this.column=t,this.level=r}static fromRowColumnLevel(e,t,r){return new i(e,t,r)}static fromQuadKey(e){const t=e.length;let r=0,n=0;for(let i=0;i<e.length;++i){const o=1<<i,s=parseInt(e.charAt(t-i-1),10);1&s&&(n|=o),2&s&&(r|=o)}return i.fromRowColumnLevel(r,n,t)}static fromMortonCode(e){let t=0,r=0,n=0,o=e;for(;o>1;){const e=1<<t;1&o&&(n|=e),2&o&&(r|=e),t++,o=(o-(3&o))/4}const s=i.fromRowColumnLevel(r,n,t);return s.m_mortonCode=e,s}static fromHereTile(e){const t=i.fromMortonCode(parseInt(e,10));return t.m_hereTile=e,t}static columnsAtLevel(e){return Math.pow(2,e)}static rowsAtLevel(e){return Math.pow(2,e)}static atCoords(e,t,r,n,o){return i.fromRowColumnLevel(Math.floor(r/(o/i.rowsAtLevel(e))),Math.floor(t/(n/i.columnsAtLevel(e))),e)}static parentMortonCode(e){return Math.floor(e/4)}parent(){if(0===this.level)throw new Error("Cannot get the parent of the root tile key");return i.fromRowColumnLevel(this.row>>>1,this.column>>>1,this.level-1)}changedLevelBy(e){const t=Math.max(0,this.level+e);let r=this.row,n=this.column;return e>=0?(r<<=e,n<<=e):(r>>>=-e,n>>>=-e),i.fromRowColumnLevel(r,n,t)}changedLevelTo(e){return this.changedLevelBy(e-this.level)}mortonCode(){if(void 0===this.m_mortonCode){let e=this.column,t=this.row,i=r[this.level<<1];for(let n=0;n<this.level;++n)1&e&&(i+=r[2*n]),1&t&&(i+=r[2*n+1]),e>>>=1,t>>>=1;this.m_mortonCode=i}return this.m_mortonCode}toHereTile(){return void 0===this.m_hereTile&&(this.m_hereTile=this.mortonCode().toString()),this.m_hereTile}toQuadKey(){let e="";for(let t=this.level;t>0;--t){const r=1<<t-1,i=0!=(this.column&r),n=0!=(this.row&r);e+=i&&n?"3":n?"2":i?"1":"0"}return e}equals(e){return this.row===e.row&&this.column===e.column&&this.level===e.level}addedSubKey(e){const t=i.fromQuadKey(0===e.length?"-":e),r=this.changedLevelBy(t.level);return i.fromRowColumnLevel(r.row+t.row,r.column+t.column,r.level)}addedSubHereTile(e){const t=i.fromHereTile(e),r=this.changedLevelBy(t.level);return i.fromRowColumnLevel(r.row+t.row,r.column+t.column,r.level)}getSubHereTile(e){const t=1<<2*e;return(this.mortonCode()&t-1|t).toString()}rowCount(){return i.rowsAtLevel(this.level)}columnCount(){return i.columnsAtLevel(this.level)}}t.TileKey=i},3465:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TileKeyUtils=void 0;const i=r(7073),n=r(20);class o{static geoCoordinatesToTileKey(e,t,r){const i=e.projection.projectPoint(t);return this.worldCoordinatesToTileKey(e,i,r)}static worldCoordinatesToTileKey(e,t,r){const i=e.projection,o=e.subdivisionScheme,s=o.getLevelDimensionX(r),a=o.getLevelDimensionY(r),{min:l,max:u}=i.worldExtent(0,0),c=u.x-l.x,h=u.y-l.y;if(t.x<l.x||t.x>u.x)return null;if(t.y<l.y||t.y>u.y)return null;const d=Math.min(s-1,Math.floor(s*(t.x-l.x)/c)),f=Math.min(a-1,Math.floor(a*(t.y-l.y)/h));return n.TileKey.fromRowColumnLevel(f,d,r)}static geoRectangleToTileKeys(e,t,r){const s=(e,t,r)=>e<t?r-(t-e)%(r-t):t+(e-t)%(r-t),a=(e,t,r)=>Math.min(Math.max(e,t),r),l=s(t.southWest.longitudeInRadians,-Math.PI,Math.PI),u=a(t.southWest.latitudeInRadians,-.5*Math.PI,.5*Math.PI),c=s(t.northEast.longitudeInRadians,-Math.PI,Math.PI),h=a(t.northEast.latitudeInRadians,-.5*Math.PI,.5*Math.PI),d=o.geoCoordinatesToTileKey(e,i.GeoCoordinates.fromRadians(u,l),r),f=o.geoCoordinatesToTileKey(e,i.GeoCoordinates.fromRadians(h,c),r),p=e.subdivisionScheme.getLevelDimensionX(r);if(!d||!f)throw new Error("Invalid coordinates");const m=d.column;let g=f.column;l>c&&(g+=g!==m?p:p-1);const v=Math.min(d.row,f.row),y=Math.max(d.row,f.row),x=new Array;for(let e=v;e<=y;++e)for(let t=m;t<=g;++t)x.push(n.TileKey.fromRowColumnLevel(e,t%p,r));return x}}t.TileKeyUtils=o},7511:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TileTreeTraverse=void 0;const i=r(5707);t.TileTreeTraverse=class{constructor(e){this.m_subdivisionScheme=e}subTiles(e){const t=this.m_subdivisionScheme.getSubdivisionX(e.level),r=this.m_subdivisionScheme.getSubdivisionY(e.level);return new i.SubTiles(e,t,r)}}},1914:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TilingScheme=void 0;const i=r(8053),n=r(3465),o=r(7511);t.TilingScheme=class{constructor(e,t){this.subdivisionScheme=e,this.projection=t,this.boundingBoxGenerator=new i.FlatTileBoundingBoxGenerator(this),this.tileTreeTraverse=new o.TileTreeTraverse(e)}getSubTileKeys(e){return this.tileTreeTraverse.subTiles(e)}getTileKey(e,t){return n.TileKeyUtils.geoCoordinatesToTileKey(this,e,t)}getTileKeys(e,t){return n.TileKeyUtils.geoRectangleToTileKeys(this,e,t)}getGeoBox(e){return this.boundingBoxGenerator.getGeoBox(e)}getWorldBox(e,t){return this.boundingBoxGenerator.getWorldBox(e,t)}}},1555:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.webMercatorTilingScheme=void 0;const i=r(1404),n=r(4276),o=r(1914);t.webMercatorTilingScheme=new o.TilingScheme(n.quadTreeSubdivisionScheme,i.webMercatorProjection)},1314:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HighPrecisionLine=t.HighPrecisionWireFrameLine=void 0;const i=r(4428),n=r(1274);class o extends i.Line{constructor(e,t,r){super(e,t),this.matrixWorldInverse=new i.Matrix4,r&&this.setPositions(r)}get bufferGeometry(){return this.geometry}get shaderMaterial(){return this.material}setPositions(e){n.HighPrecisionUtils.setPositions(this,e)}setupForRendering(){this.onBeforeRender=(e,t,r,i,o,s)=>{n.HighPrecisionUtils.updateHpUniforms(this,r,this.shaderMaterial)}}updateMatrixWorld(e){const t=this.matrixWorldNeedsUpdate||e;super.updateMatrixWorld(e),t&&this.matrixWorldInverse.copy(this.matrixWorld).invert()}}t.HighPrecisionWireFrameLine=o;class s extends i.Mesh{constructor(e,t,r){super(e,t),this.matrixWorldInverse=new i.Matrix4,r&&this.setPositions(r)}get bufferGeometry(){return this.geometry}get shaderMaterial(){return this.material}setPositions(e){n.HighPrecisionUtils.setPositions(this,e)}setupForRendering(){this.onBeforeRender=(e,t,r,i,o,s)=>{n.HighPrecisionUtils.updateHpUniforms(this,r,this.shaderMaterial)}}updateMatrixWorld(e){const t=this.matrixWorldNeedsUpdate||e;super.updateMatrixWorld(e),t&&this.matrixWorldInverse.copy(this.matrixWorld).invert()}}t.HighPrecisionLine=s},82:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HighPrecisionPoints=void 0;const i=r(284),n=r(4428),o=r(1274);class s extends n.Points{constructor(e,t,r,o,s){void 0===t&&(t=new i.HighPrecisionPointMaterial({color:o||i.HighPrecisionPointMaterial.DEFAULT_COLOR,opacity:void 0!==s?s:1})),super(void 0===e?new n.BufferGeometry:e,t),this.matrixWorldInverse=new n.Matrix4,r&&this.setPositions(r)}get bufferGeometry(){return this.geometry}clearGeometry(){return this.geometry=new n.BufferGeometry}get shaderMaterial(){return this.material}setPositions(e){o.HighPrecisionUtils.setPositions(this,e)}setupForRendering(){this.material.isHighPrecisionPointsMaterial&&void 0!==this.dimensionality&&this.material.setDimensionality(this.dimensionality),this.onBeforeRender=(e,t,r,i,n,s)=>{o.HighPrecisionUtils.updateHpUniforms(this,r,this.shaderMaterial)}}updateMatrixWorld(e){const t=this.matrixWorldNeedsUpdate||e;super.updateMatrixWorld(e),t&&this.matrixWorldInverse.copy(this.matrixWorld).invert()}}t.HighPrecisionPoints=s},1274:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HighPrecisionUtils=void 0;const i=r(284),n=r(4428),o=r(1314),s=r(82),a=r(8655);!function(e){function t(e){return new n.Vector3(Math.fround(e.x),Math.fround(e.y),Math.fround(e.z))}function r(e,r){const i=(new n.Matrix4).copy(e.projectionMatrix).multiply(e.matrixWorldInverse),o=new n.Vector3(0,0,0).applyMatrix4(r),s=t(o);return{viewProjection:i,eyePosHi:s,eyePosLo:t(o.sub(s))}}function l(e){if(e.length>0){const t=e[0];if(null==t)throw Error("Empty element in positions");const r=new Array,i=new Array,o=(...e)=>{for(const t of e){const e=Math.fround(t);i.push(t-e),r.push(e)}},s=e=>{o(e.x,e.y,e.z)};if(void 0!==t.z)e.forEach((e=>{s(e)}));else{if(r.length%3!=0)throw Error("Positions must be 3D, not 2D");e.forEach((e=>{o(e)}))}return{positionHigh:new n.Float32BufferAttribute(r,3),positionLow:new n.Float32BufferAttribute(i,3)}}return{positionHigh:new n.Float32BufferAttribute([],3),positionLow:new n.Float32BufferAttribute([],3)}}function u(e,t,r=0){const i=new Array,n=e.length;for(let o=0;o<n;o+=t){for(let t=0;t<r;t++)i.push(e[o+t]);const n=e[o+r],s=e[o+r+1],a=e[o+r+2],l=Math.fround(n),u=n-l,c=Math.fround(s),h=s-c,d=Math.fround(a),f=a-d;i.push(l,c,d,u,h,f);for(let n=r+3;n<t;n++)i.push(e[o+n])}return i}function c(e,t){const r=l(t);return e.bufferGeometry.setAttribute("position",r.positionHigh),e.bufferGeometry.setAttribute("positionLow",r.positionLow),r.positionHigh.itemSize}e.doubleToFloatVec=t,e.makeFloatVec=function(e){const t=Math.fround(e.x),r=Math.fround(e.y),i=Math.fround(e.z),o=new n.Vector3(e.x-t,e.y-r,e.z-i);return e.x=Math.fround(t),e.y=Math.fround(r),e.z=Math.fround(i),o},e.createHighPrecisionCameraPos=r,e.updateHpUniforms=function(e,t,i){const n=r(t,e.matrixWorldInverse),o=n.viewProjection;if(void 0===i||!i.isMaterial)throw Error("High pecision line has no high precision material");if(!(i.uniforms&&i.uniforms.u_mvp&&i.uniforms.u_eyepos&&i.uniforms.u_eyepos_lowpart))throw Error("High pecision material has missing uniforms");i.uniforms.u_mvp.value=new Float32Array(o.elements),i.uniforms.u_eyepos.value=new Float32Array(n.eyePosHi.toArray()),i.uniforms.u_eyepos_lowpart.value=new Float32Array(n.eyePosLo.toArray())},e.createAttributes=l,e.addInterleavedAttributes3=u,e.setPositions=c,e.convertPositions=function(e){if(e.length<=0)return{positions:[]};const t=e[0];if(null==t)throw Error("Empty element in positions");const r=t;if(void 0===r.y&&void 0===r.z)return{positions:e};const i=new Array;return e.forEach((e=>{i.push(e.x,e.y,e.z)})),{positions:i}},e.createLine=function(e,t){const r=void 0!==t.lineWidth?t.lineWidth:5,s=void 0!==t.addCircles&&t.addCircles,l=void 0!==t.wireFrame&&t.wireFrame,c=[],h=[];a.triangulateLine(e,r,c,h,s);const d=new n.BufferGeometry,f=u(c,3),p=new n.InterleavedBuffer(new Float32Array(f),6),m=new n.InterleavedBufferAttribute(p,3,0,!1),g=new n.InterleavedBufferAttribute(p,3,3,!1);d.setAttribute("position",m),d.setAttribute("positionLow",g),d.setIndex(new n.BufferAttribute(new Uint32Array(h),1));const v=new i.HighPrecisionLineMaterial(t),y=l?new o.HighPrecisionWireFrameLine(d,v):new o.HighPrecisionLine(d,v);return y.setupForRendering(),y},e.createPoints=function(e,t){const r=[];for(let t=0;t<e.length;t++)r.push(r.length/3);const o=new n.BufferGeometry,a=i.isHighPrecisionPointMaterial(t)?t:new i.HighPrecisionPointMaterial(t),l=new s.HighPrecisionPoints(o,a);return c(l,e),l.setupForRendering(),l}}(t.HighPrecisionUtils||(t.HighPrecisionUtils={}))},6155:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LineGroup=t.createSimpleLineGeometry=t.createLineGeometry=t.LineGeometry=void 0;const i=r(3333),n=r(4428),o=new n.Vector3,s=new n.Vector3,a=new n.Vector3,l=new n.Vector3,u=new n.Vector3,c={attributes:[{name:"extrusionCoord",itemSize:3,offset:0},{name:"position",itemSize:3,offset:3},{name:"tangent",itemSize:3,offset:6},{name:"bitangent",itemSize:4,offset:9}],stride:13},h={attributes:[{name:"uv",itemSize:2,offset:c.stride},{name:"normal",itemSize:3,offset:c.stride+2}],stride:5},d={attributes:[...c.attributes,...h.attributes],stride:c.stride+h.stride},f={attributes:[{name:"extrusionCoord",itemSize:2,offset:0},{name:"position",itemSize:3,offset:2},{name:"positionLow",itemSize:3,offset:5},{name:"tangent",itemSize:3,offset:8},{name:"bitangent",itemSize:4,offset:11}],stride:15},p={attributes:[...f.attributes,...h.attributes],stride:f.stride+h.stride};class m{constructor(){this.vertices=[],this.vertexColors=[],this.indices=[]}}function g(e,t){return t?e?p:f:e?d:c}function v(e,t,r,n,c,h,d=new m,f=!1){if(0===t.length)return d;const p=g(void 0!==c,f).stride,v=t.length/3,y=new Array(v),x=new Array(t.length-3),_=d.vertices.length/p,b=void 0!==n&&n.length>0,w=void 0!==c&&c.length>0,E=void 0!==h&&h.length&&t.length;i.assert(!b||n.length===v),i.assert(!w||c.length/2===v),i.assert(!E||h.length===t.length);let S=.1;y[0]=S;for(let e=0;e<v-1;++e){let r=0;for(let i=0;i<3;++i){const n=t[3*(e+1)+i]-t[3*e+i];x[3*e+i]=n,r+=n*n}S+=Math.sqrt(r),y[e+1]=S}const M=b?Math.abs(n[n.length-1]-n[0]):1,T=y[y.length-1]/M;if(b)for(let e=0;e<v;++e)y[e]=n[e]*T+.1;let P=!0;for(let e=0;e<3;++e)P=P&&t[e]===t[t.length-3+e];const A=[],L=(i,n,p,m,g)=>{A.length=0,d.vertices.push(m,-1*g,T),A.push(m,1*g,T);for(let e=0;e<3;++e){if(f){const r=Math.fround(t[3*i+e]),n=t[3*i+e]-r;d.vertices.push(r,n),A.push(r,n)}else d.vertices.push(t[3*i+e]),A.push(t[3*i+e]);s.setComponent(e,t[3*i+e])}for(let e=0;e<3;++e)a.setComponent(e,x[n+e]),l.setComponent(e,x[p+e]);a.normalize(),d.vertices.push(a.x,a.y,a.z),A.push(a.x,a.y,a.z),s.add(e),r.surfaceNormal(s,s);const v=function(e,t,r,i){let n=0;return t.equals(r)||(n=Math.acos(t.dot(r))*Math.sign(e.dot(o.copy(t).cross(r))),Number.isNaN(n)&&(n=0)),i.copy(t).add(r).normalize().cross(e).normalize(),n}(s,a,l.normalize(),u);d.vertices.push(u.x,u.y,u.z,v),A.push(u.x,u.y,u.z,v),w&&(d.vertices.push(c[2*i],c[2*i+1]),A.push(c[2*i],c[2*i+1]),d.vertices.push(s.x,s.y,s.z),A.push(s.x,s.y,s.z)),d.vertices.push(...A),E&&(d.vertexColors.push(h[3*i],h[3*i+1],h[3*i+2]),d.vertexColors.push(h[3*i],h[3*i+1],h[3*i+2]))};for(let e=0;e<v;++e){const t=P&&0===e?x.length-3:3*Math.max(0,e-1),r=P&&e===v-1?0:Math.min(3*e,x.length-3);e>0&&L(e,t,r,y[e-1],y[e]),e+1<v&&L(e,t,r,-1*y[Math.min(e,y.length-1)],y[Math.min(e+1,y.length-1)])}for(let e=0;e<v-1;++e){const t=_+4*e;d.indices.push(t,t+1,t+2,t+2,t+1,t+3)}return d}function y(e,t,r=new m){if(0===e.length)return r;const i=e.length/3;let n=r.vertices.length/3;const o=void 0!==t&&t.length&&e.length;for(let s=0;s<i;++s,n++){s>0&&r.indices.push(n),s<i-1&&r.indices.push(n);for(let i=0;i<3;++i)r.vertices.push(e[3*s+i]),o&&r.vertexColors.push(t[3*s+i])}return r}t.LineGeometry=m,t.createLineGeometry=v,t.createSimpleLineGeometry=y;class x{constructor(e=!1,t=!1,r=!1){this.hasNormalsAndUvs=e,this.highPrecision=t,this.isSimple=r,this.m_geometry=new m}static createGeometry(e,t,r,i,o=!1,s=!1,a=!1){if(a)return i.setAttribute("position",new n.BufferAttribute(new Float32Array(e),3)),t.length===e.length&&i.setAttribute("color",new n.BufferAttribute(new Float32Array(t),3)),i.setIndex(new n.BufferAttribute(new Uint32Array(r),1)),i;{const a=g(o,s),l=new n.InterleavedBuffer(new Float32Array(e),a.stride);return a.attributes.forEach((e=>{const t=new n.InterleavedBufferAttribute(l,e.itemSize,e.offset,!1);i.setAttribute(e.name,t)})),t.length===e.length&&i.setAttribute("color",new n.BufferAttribute(new Float32Array(t),3)),i.setIndex(new n.BufferAttribute(new Uint32Array(r),1)),i}}clear(){this.m_geometry.vertices=[],this.m_geometry.vertexColors=[],this.m_geometry.indices=[]}add(e,t,r,n,o,s){return this.isSimple?y(t,s,this.m_geometry):(i.assert(!this.hasNormalsAndUvs||void 0!==o),v(e,t,r,n,o,s,this.m_geometry,this.highPrecision)),this}get vertices(){return this.m_geometry.vertices}get vertexColors(){return this.m_geometry.vertexColors}get indices(){return this.m_geometry.indices}get vertexAttributes(){return g(this.hasNormalsAndUvs,this.highPrecision).attributes}get stride(){return g(this.hasNormalsAndUvs,this.highPrecision).stride}createGeometry(e){return void 0===e&&(e=new n.BufferGeometry),x.createGeometry(this.m_geometry.vertices,this.m_geometry.vertexColors,this.m_geometry.indices,e,this.hasNormalsAndUvs,this.highPrecision)}}t.LineGroup=x},8655:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.reconstructLineWidth=t.reconstructLine=t.triangulateLine=t.numCirclePoints=void 0;const i=r(4428),n=new i.Vector3(0,0,1),o=[0,1,2,1,3,2],s=[0,1,3,3,1,2,0,3,4,5,4,3],a=Math.PI/8;function l(e,t,r,i,n,o){const s=n.length/3;n.push(e,t,0);for(let l=0;l<9;++l){const u=a*l+Math.PI/2+r;n.push(e+i*Math.cos(u),t+i*Math.sin(u),0),o.push(s,s+l+1,s+(l+1)%9+1)}}t.numCirclePoints=function(e){return 9},t.triangulateLine=function(e,t,r,a,u=!0,c=u){if(e.length<3)return;const h=new i.Vector2;if(u){const i=3!==e.length?h.set(e[3]-e[0],e[4]-e[1]).angle():0;l(e[0],e[1],i,t,r,a)}const d=r.length/3,f=new i.Vector3,p=new i.Vector3,m=new i.Vector3,g=new i.Vector3,v=new i.Vector3,y=new i.Vector3,x=new i.Vector3,_=new i.Vector3,b=new i.Vector3,w=e.length/3;let E=0;for(let i=0;i<w;++i){let l=!1;if(p.set(e[3*i],e[3*i+1],e[3*i+2]),i+1<w){if(m.set(e[3*(i+1)],e[3*(i+1)+1],e[3*(i+1)+2]),g.copy(m).sub(p).normalize().cross(n),v.copy(g),i>0&&(v.add(f).multiplyScalar(1-.5*g.dot(f)),l=f.angleTo(g)>Math.PI/2,l)){const e=t/Math.cos(g.angleTo(f)/2);y.copy(g).add(f).normalize().multiplyScalar(-e).add(p),x.copy(f).multiplyScalar(t).add(p),_.copy(g).add(f).normalize().multiplyScalar(e).add(p),b.copy(g).multiplyScalar(t).add(p)}l?r.push(y.x,y.y,y.z,x.x,x.y,x.z,_.x,_.y,_.z,b.x,b.y,b.z):(y.copy(v).multiplyScalar(-t).add(p),x.copy(v).multiplyScalar(t).add(p),r.push(y.x,y.y,y.z,x.x,x.y,x.z)),f.copy(g)}else y.copy(f).multiplyScalar(-t).add(p),x.copy(f).multiplyScalar(t).add(p),r.push(y.x,y.y,y.z,x.x,x.y,x.z);i!==w-1&&((l?s:o).forEach((e=>a.push(d+E+e))),E+=l?4:2)}if(c){const i=2!==e.length?h.set(e[3*(w-3)]-e[3*(w-2)],e[3*(w-3)+1]-e[3*(w-2)+1]).angle():Math.PI;l(e[3*(w-2)],e[3*(w-2)+1],i,t,r,a)}},t.reconstructLine=function(e,t){const r=new Float32Array(e.length/2);for(let i=3*t,n=2*i;i<r.length;i+=3,n+=6)r[i]=e[n]+.5*(e[n+3]-e[n]),r[i+1]=e[n+1]+.5*(e[n+3+1]-e[n+1]),r[i+2]=e[n+2]+.5*(e[n+3+2]-e[n+2]);return r},t.reconstructLineWidth=function(e,t){const r=e[2*t+3]-e[2*t],i=e[2*t+3+1]-e[2*t+1],n=e[2*t+3+2]-e[2*t+2];return.5*Math.sqrt(r*r+i*i+n*n)}},2851:function(e,t,r){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,r,i){void 0===i&&(i=r),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,i){void 0===i&&(i=r),e[i]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||i(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),n(r(9363),t),n(r(2396),t),n(r(9609),t),n(r(253),t),n(r(9482),t),n(r(9164),t)},9164:(e,t,r)=>{"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),t.GeoJsonTiler=void 0;const n=r(3187),o=r(8721),s=null!==(i=o.default)&&void 0!==i?i:o,a=-(-2&-Math.ceil(204.8));t.GeoJsonTiler=class{constructor(){this.indexes=new Map}dispose(){}async connect(){return await Promise.resolve()}async registerIndex(e,t){if(!this.indexes.has(e))return await this.updateIndex(e,t)}async updateIndex(e,t){if(t instanceof URL){const e=await fetch(t.href);if(!e.ok)throw new Error(`GeoJsonTiler: Unable to fetch ${t.href}: ${e.statusText}`);t=await e.json()}else t=t;const r=n.isFeatureGeometry(t)||"GeometryCollection"===t.type||"Feature"===t.type&&void 0===t.id||"FeatureCollection"===t.type&&t.features.length>0&&void 0===t.features[0].id,i=s(t,{maxZoom:20,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:a,lineMetrics:!1,promoteId:null,generateId:r,debug:0});i.geojson=t,this.indexes.set(e,i)}async getTile(e,t){const r=this.indexes.get(e);if(void 0===r)throw new Error("Tile not found");const i=r.getTile(t.level,t.column,t.row);return null!==i&&(i.layer=e),i||{}}}},9363:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ThemedTileDecoder=void 0;const i=r(5263),n=r(3333).LoggerManager.instance.create("ThemedTileDecoder");t.ThemedTileDecoder=class{constructor(){this.m_storageLevelOffset=0}dispose(){}decodeTile(e,t,r){return void 0===this.m_styleSetEvaluator?(n.info("cannot decode tile, as there is not style available"),Promise.resolve(void 0)):this.decodeThemedTile(e,t,this.m_styleSetEvaluator,r)}getTileInfo(e,t,r){return Promise.resolve(void 0)}configure(e,t){void 0!==(null==e?void 0:e.styleSet)&&(this.m_styleSetEvaluator=new i.StyleSetEvaluator(e)),void 0!==(null==e?void 0:e.languages)&&(this.languages=e.languages),void 0!==t&&void 0!==t.storageLevelOffset&&(this.m_storageLevelOffset=t.storageLevelOffset)}}},2396:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TileDecoderService=void 0;const i=r(3187),n=r(3139),o=r(3333),s=r(253),a=o.LoggerManager.instance.create("TileDecoderService");class l extends s.WorkerService{constructor(e,t){super(e),this.serviceId=e,this.m_decoder=t,this.m_decoder.connect()}static start(e,t){return new l(e,t)}handleRequest(e){return i.WorkerDecoderProtocol.isDecodeTileRequest(e)?this.handleDecodeTileRequest(e):i.WorkerDecoderProtocol.isTileInfoRequest(e)?this.handleTileInfoRequest(e):super.handleRequest(e)}handleMessage(e){i.WorkerDecoderProtocol.isConfigurationMessage(e)?this.handleConfigurationMessage(e):a.error(`[${this.serviceId}]: invalid message ${e.type}`)}async handleDecodeTileRequest(e){const t=n.TileKey.fromMortonCode(e.tileKey),r=i.getProjection(e.projection),o=await this.m_decoder.decodeTile(e.data,t,r),s=[],a=e=>{void 0!==e&&e.buffer.byteLength>0&&!s.includes(e.buffer)&&s.push(e.buffer)};return null==o||o.geometries.forEach((e=>{var t,r,i;if(null===(t=e.vertexAttributes)||void 0===t||t.forEach((e=>a(e))),null===(r=e.interleavedVertexAttributes)||void 0===r||r.forEach((e=>a(e))),a(e.index),a(e.edgeIndex),Array.isArray(e.objInfos)&&1===e.objInfos.length&&"object"==typeof e.objInfos[0]&&(null===(i=e.objInfos[0])||void 0===i?void 0:i.hasOwnProperty("displacementMap"))){const t=e.objInfos[0];a(t.displacementMap)}Array.isArray(e.attachments)&&e.attachments.forEach((e=>{a(e.index),a(e.edgeIndex)}))})),null==o||o.techniques.forEach((e=>{i.addBuffersToTransferList(e,s)})),{response:o,transferList:s}}handleTileInfoRequest(e){const t=n.TileKey.fromMortonCode(e.tileKey),r=i.getProjection(e.projection);return this.m_decoder.getTileInfo(e.data,t,r).then((e=>({response:e,transferList:void 0!==e&&void 0!==e.transferList?e.transferList:[]})))}handleConfigurationMessage(e){this.m_decoder.configure(e,e.options)}}t.TileDecoderService=l},9609:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TilerService=void 0;const i=r(3187),n=r(3139),o=r(9164),s=r(253);class a extends s.WorkerService{constructor(e){super(e),this.serviceId=e,this.tiler=new o.GeoJsonTiler}static start(e){return new a(e)}handleRequest(e){return i.WorkerTilerProtocol.isRegisterIndexRequest(e)?this.handleRegisterIndexRequest(e):i.WorkerTilerProtocol.isUpdateIndexRequest(e)?this.handleUpdateIndexRequest(e):i.WorkerTilerProtocol.isTileRequest(e)?this.handleTileRequest(e):super.handleRequest(e)}async handleTileRequest(e){const t=n.TileKey.fromMortonCode(e.tileKey);return{response:await this.tiler.getTile(e.index,t)||{}}}async handleRegisterIndexRequest(e){const t="string"==typeof e.input?new URL(e.input):e.input;return await this.tiler.registerIndex(e.id,t),{response:{}}}async handleUpdateIndexRequest(e){const t="string"==typeof e.input?new URL(e.input):e.input;return this.tiler.updateIndex(e.id,t),{response:{}}}}t.TilerService=a},253:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WorkerService=void 0;const i=r(3187),n=r(3333).LoggerManager.instance.create("WorkerService",{enabled:!0});t.WorkerService=class{constructor(e){this.serviceId=e,this.m_pendingRequests=new Map,this.onMessage=e=>{if("string"==typeof e.data.service&&e.data.service===this.serviceId)try{if(i.WorkerServiceProtocol.isRequestMessage(e.data)){const t=e.data,r={service:t.service,messageId:t.messageId,responseSent:!1};this.m_pendingRequests.set(t.messageId,r),this.tryHandleRequest(t.request).then((e=>{this.doSendResponse(r,{service:this.serviceId,type:i.WorkerServiceProtocol.ServiceMessageName.Response,messageId:t.messageId,response:e.response},e.transferList)})).catch((e=>{this.doSendResponse(r,{service:this.serviceId,type:i.WorkerServiceProtocol.ServiceMessageName.Response,messageId:t.messageId,errorMessage:e.toString(),errorStack:e.stack})}))}else this.tryHandleMessage(e.data)}catch(t){n.error(`[${this.serviceId}]: Unhandled exception when handling ${e.type}`)}},self.addEventListener("message",this.onMessage);const t={service:e,type:i.WorkerServiceProtocol.ServiceMessageName.Initialized};self.postMessage(t)}destroy(){this.cancelAllPendingRequests(),self.removeEventListener("message",this.onMessage)}handleMessage(e){n.error(`[${this.serviceId}]: Invalid message ${e.type}`)}handleRequest(e){throw new Error(`ServiceAdapter[${this.serviceId}]: Invalid request '${e.type}'`)}tryHandleMessage(e){try{this.handleMessage(e)}catch(t){n.error(`[${this.serviceId}]: Failed, handling message ${e.type}`)}}tryHandleRequest(e){try{return this.handleRequest(e)}catch(e){return n.error(`[${this.serviceId}]: Failure`,e),Promise.reject(e)}}doSendResponse(e,t,r){e.responseSent||(void 0!==r?self.postMessage(t,r):self.postMessage(t),e.responseSent=!0,this.m_pendingRequests.delete(e.messageId))}cancelAllPendingRequests(){this.m_pendingRequests.forEach((e=>{this.doSendResponse(e,{service:this.serviceId,type:i.WorkerServiceProtocol.ServiceMessageName.Response,messageId:e.messageId,errorMessage:"cancelled"})}))}}},9482:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WorkerServiceManager=void 0;const i=r(3187),n=r(253);class o extends n.WorkerService{constructor(e=i.WorkerServiceProtocol.WORKER_SERVICE_MANAGER_SERVICE_ID){super(e),this.m_factories=new Map,this.m_services=new Map}static getInstance(){return void 0===this.m_service&&(this.m_service=new o(i.WorkerServiceProtocol.WORKER_SERVICE_MANAGER_SERVICE_ID)),this.m_service}register(e){this.m_factories.set(e.serviceType,e.factory)}handleRequest(e){if(e.type===i.WorkerServiceProtocol.Requests.CreateService){if(void 0!==this.m_services.get(e.targetServiceId))throw Error(`error - service with targetServiceId='${e.targetServiceId}' already running, ignoring CreateService request`);const t=this.m_factories.get(e.targetServiceType);if(void 0===t)throw Error(`unknown targetServiceType requested: '${e.targetServiceType}'`);const r=t(e.targetServiceId);this.m_services.set(e.targetServiceId,r)}if(e.type===i.WorkerServiceProtocol.Requests.DestroyService){const t=this.m_services.get(e.targetServiceId);if(void 0===t)throw Error(`unknown targetServiceId '${e.targetServiceId}'`);t.destroy(),this.m_services.delete(e.targetServiceId)}return Promise.resolve({response:{}})}}t.WorkerServiceManager=o},963:function(e,t,r){"use strict";var i=this&&this.__rest||function(e,t){var r={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(r[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(r[i[n]]=e[i[n]])}return r};Object.defineProperty(t,"__esModule",{value:!0}),t.CirclePointsMaterial=void 0;const n=r(4428),o=r(3993),s=r(1703);class a extends o.RawShaderMaterial{constructor(e){const t=new n.Color;let r,o,l,u;if(e){const{size:s,color:c,opacity:h}=e,d=i(e,["size","color","opacity"]);r=s,o=c,l=h,d.name="CirclePointsMaterial",d.vertexShader="\nuniform float size;\nuniform mat4 modelViewMatrix;\nuniform mat4 projectionMatrix;\n\nattribute vec3 position;\n\nvoid main() {\n    vec3 transformed = vec3(position);\n    vec4 mvPosition = modelViewMatrix * vec4(transformed, 1.0);\n\n    gl_Position = projectionMatrix * mvPosition;\n    gl_PointSize = size;\n}\n",d.fragmentShader="\nprecision highp float;\nprecision highp int;\n\nuniform vec3 diffuse;\nuniform float opacity;\n\nvoid main() {\n    float alpha = opacity;\n\n    float radius = 0.5;\n    vec2 coords = gl_PointCoord.xy - vec2(0.5);\n    float len = length(coords);\n    float falloff = fwidth(len);\n    float threshold = 1.0 - smoothstep(radius - falloff, radius, len);\n    alpha *= threshold;\n\n    gl_FragColor = vec4(diffuse, alpha);\n}",d.uniforms=n.UniformsUtils.merge([{size:new n.Uniform(a.DEFAULT_CIRCLE_SIZE),diffuse:new n.Uniform(t),opacity:new n.Uniform(1)},n.UniformsLib.fog]),d.depthTest=!1,d.extensions=Object.assign(Object.assign({},d.extensions),{derivatives:!0}),u=d}super(u),s.enforceBlending(this),this.type="CirclePointsMaterial",this.setOpacity(1),void 0!==r&&(this.size=r),void 0!==o&&(this.color=o),void 0!==l&&this.setOpacity(l)}get size(){return this.uniforms.size.value}set size(e){this.uniforms.size.value=e}get color(){return this.uniforms.diffuse.value}set color(e){this.uniforms.diffuse.value.copy(e)}}t.CirclePointsMaterial=a,a.DEFAULT_CIRCLE_SIZE=1},5083:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CopyMaterial=t.CopyShader=void 0;const i=r(4428);t.CopyShader={uniforms:{tDiffuse:{value:null},opacity:{value:1}},vertexShader:"\n    varying vec2 vUv;\n    void main() {\n        vUv = uv;\n        gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n    }",fragmentShader:"\n    uniform float opacity;\n    uniform sampler2D tDiffuse;\n    varying vec2 vUv;\n    void main() {\n        vec4 texel = texture2D( tDiffuse, vUv );\n        gl_FragColor = opacity * texel;\n    }"};class n extends i.ShaderMaterial{constructor(e){super({name:"CopyMaterial",uniforms:e,vertexShader:t.CopyShader.vertexShader,fragmentShader:t.CopyShader.fragmentShader,premultipliedAlpha:!0,transparent:!1,blending:i.NoBlending,depthTest:!1,depthWrite:!1})}}t.CopyMaterial=n},3255:(e,t)=>{"use strict";function r(e){return"displacementMap"in e}Object.defineProperty(t,"__esModule",{value:!0}),t.setDisplacementMapToMaterial=t.hasDisplacementFeature=void 0,t.hasDisplacementFeature=r,t.setDisplacementMapToMaterial=function(e,t){r(t)&&t.displacementMap!==e&&(t.displacementMap=e,t.needsUpdate=!0,null!==t.displacementMap&&(t.displacementMap.needsUpdate=!0))}},7833:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EdgeMaterial=void 0;const i=r(4428),n=r(5722),o=r(8136),s=r(3993),a=r(1703);class l extends s.RawShaderMaterial{constructor(e){var t;let r;if(e){const s={},u=void 0!==e.extrusionRatio&&e.extrusionRatio>=o.ExtrusionFeatureDefs.DEFAULT_RATIO_MIN&&e.extrusionRatio<o.ExtrusionFeatureDefs.DEFAULT_RATIO_MAX;e.displacementMap&&a.setShaderDefine(s,"USE_DISPLACEMENTMAP",!0),u&&a.setShaderDefine(s,"USE_EXTRUSION",!0),!0===e.vertexColors&&a.setShaderDefine(s,"USE_COLOR",!0),r={name:"EdgeMaterial",vertexShader:"\n#define EDGE_DEPTH_OFFSET 0.0001\n\n#ifdef USE_COLOR\nattribute vec4 color;\n#else\nuniform vec3 color;\n#endif\n\n// SHADER_NAME may be defined by THREE.JS own shaders in which case these attributes & uniforms are\n// already defined\n#ifndef SHADER_NAME\nattribute vec3 position;\nuniform mat4 modelViewMatrix;\nuniform mat4 projectionMatrix;\nuniform mat3 normalMatrix;\n#endif\n\nuniform vec3 edgeColor;\nuniform float edgeColorMix;\n\n#ifdef USE_DISPLACEMENTMAP\nattribute vec3 normal;\nattribute vec2 uv;\nuniform sampler2D displacementMap;\n#endif\n\nvarying vec3 vColor;\n\n#ifdef USE_EXTRUSION\n#include <extrusion_pars_vertex>\n#endif\n\n#ifdef USE_FADING\n#include <fading_pars_vertex>\n#endif\n\nvoid main() {\n\n    vColor = mix(edgeColor.rgb, color.rgb, edgeColorMix);\n\n    vec3 transformed = vec3( position );\n\n    #ifdef USE_EXTRUSION\n    #include <extrusion_vertex>\n    #endif\n\n    #ifdef USE_DISPLACEMENTMAP\n    transformed += normalize( normal ) * texture2D( displacementMap, uv ).x;\n    #endif\n\n    vec4 mvPosition = modelViewMatrix * vec4( transformed, 1.0 );\n\n    gl_Position = projectionMatrix * mvPosition;\n    // After projection gl_Position contains clip space coordinates of each vertex\n    // before perspective division (1 / w), thus only vertexes with -w < z < w should\n    // be displayed and offset. We offset only those edges which z coordinate in NDC\n    // space is between: -inf < z < 1\n    float depthOffset = step(-1.0, -gl_Position.z / gl_Position.w) * EDGE_DEPTH_OFFSET;\n    gl_Position.z -= depthOffset;\n\n    #ifdef USE_FADING\n    #include <fading_vertex>\n    #endif\n}",fragmentShader:"\nprecision highp float;\nprecision highp int;\n\nvarying vec3 vColor;\n\n#ifdef USE_EXTRUSION\n#include <extrusion_pars_fragment>\n#endif\n\n#ifdef USE_FADING\n#include <fading_pars_fragment>\n#endif\n\nvoid main() {\n    float alphaValue = 1.0;\n    gl_FragColor = vec4(vColor, alphaValue);\n\n    #ifdef USE_EXTRUSION\n    #include <extrusion_fragment>\n    #endif\n\n    #ifdef USE_FADING\n    #include <fading_fragment>\n    #endif\n}",uniforms:{color:new i.Uniform(new i.Color(l.DEFAULT_COLOR)),edgeColor:new i.Uniform(new i.Color(l.DEFAULT_COLOR)),edgeColorMix:new i.Uniform(l.DEFAULT_COLOR_MIX),fadeNear:new i.Uniform(n.FadingFeature.DEFAULT_FADE_NEAR),fadeFar:new i.Uniform(n.FadingFeature.DEFAULT_FADE_FAR),extrusionRatio:new i.Uniform(o.ExtrusionFeatureDefs.DEFAULT_RATIO_MAX),displacementMap:new i.Uniform(null!==(t=e.displacementMap)&&void 0!==t?t:new i.Texture)},depthWrite:!1,defines:s,rendererCapabilities:e.rendererCapabilities}}super(r),a.enforceBlending(this),n.FadingFeature.patchGlobalShaderChunks(),n.ExtrusionFeature.patchGlobalShaderChunks(),void 0!==e&&(void 0!==e.color&&this.color.set(e.color),void 0!==e.colorMix&&(this.colorMix=e.colorMix),void 0!==e.fadeNear&&(this.fadeNear=e.fadeNear),void 0!==e.fadeFar&&(this.fadeFar=e.fadeFar),void 0!==e.displacementMap&&(this.displacementMap=e.displacementMap),void 0!==e.extrusionRatio&&(this.extrusionRatio=e.extrusionRatio))}get objectColor(){return this.uniforms.color.value}set objectColor(e){this.uniforms.color.value.copy(e)}get color(){return this.uniforms.edgeColor.value}set color(e){this.uniforms.edgeColor.value.copy(e)}get lineWidth(){return this.linewidth}set lineWidth(e){this.linewidth=e,this.linewidth<=0?this.visible=!1:this.visible=!0}get colorMix(){return this.uniforms.edgeColorMix.value}set colorMix(e){this.uniforms.edgeColorMix.value!==e&&(this.uniforms.edgeColorMix.value=e)}get fadeNear(){return this.uniforms.fadeNear.value}set fadeNear(e){this.uniforms.fadeNear.value=e}get fadeFar(){return this.uniforms.fadeFar.value}set fadeFar(e){this.uniforms.fadeFar.value!==e&&(this.uniforms.fadeFar.value=e,a.setShaderMaterialDefine(this,"USE_FADING",e>0))}get extrusionRatio(){return this.uniforms.extrusionRatio.value}set extrusionRatio(e){if(this.uniforms.extrusionRatio.value===e)return;this.uniforms.extrusionRatio.value=e;const t=e>=o.ExtrusionFeatureDefs.DEFAULT_RATIO_MIN;a.setShaderMaterialDefine(this,"USE_EXTRUSION",t)}get displacementMap(){return this.uniforms.displacementMap.value}set displacementMap(e){if(this.uniforms.displacementMap.value===e)return;this.uniforms.displacementMap.value=e;const t=null!==e;t&&(this.uniforms.displacementMap.value.needsUpdate=!0),a.setShaderMaterialDefine(this,"USE_DISPLACEMENTMAP",t)}}t.EdgeMaterial=l,l.DEFAULT_COLOR=0,l.DEFAULT_COLOR_MIX=0},5656:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GroundAtmosphereMaterial=t.GroundAtmosphereShader=void 0;const i=r(4428),n=r(3993),o=r(2870),s=r(1703);t.GroundAtmosphereShader={uniforms:{u_eyePositionWorld:new i.Uniform(new i.Vector3),u_lightDirectionWorld:new i.Uniform(new i.Vector3(0,1,0)),u_modelViewProjection:new i.Uniform(new i.Matrix4),u_atmosphereEnv:new i.Uniform(new i.Vector3(6384515.136999999,6537590.425,0)),u_hsvCorrection:new i.Uniform(new i.Vector3(0,0,0)),topColor:new i.Uniform(new i.Color(30719)),bottomColor:new i.Uniform(new i.Color(16777215)),offset:new i.Uniform(33),exponent:new i.Uniform(.6),fogColor:new i.Uniform(new i.Color(30719)),fogNear:new i.Uniform(new i.Color(30719)),fogFar:new i.Uniform(new i.Color(16777215))},vertexShader:`\n\n    #define IMPROVE_INTERSECT_PRECISION 1\n    #define IMPROVE_DOT_PRECISION 1\n\n    precision highp float;\n    precision highp int;\n\n    attribute vec4 position;\n\n    // Base mandatory uniforms\n    uniform mat4 u_modelViewProjection;\n    uniform vec3 u_eyePositionWorld;\n    uniform vec3 u_lightDirectionWorld;\n\n    uniform vec3 u_atmosphereEnv; // Atmosphere inner and outer radius, camera height\n    uniform vec3 u_hsvCorrection;\n\n    const float Pi = 3.141592653589793;\n    const float Kr = 0.0025;\n    const float Km = 0.0015;\n    const float Kr4PI = Kr * 4.0 * Pi;\n    const float Km4PI = Km * 4.0 * Pi;\n    const float ESun = 25.0; // should be 15.0\n    const float KmESun = Km * ESun;\n    const float KrESun = Kr * ESun;\n    const vec3 InvWavelength = vec3(\n        1.0 / pow(0.650, 4.0), // Red\n        1.0 / pow(0.570, 4.0), // Green\n        1.0 / pow(0.475, 4.0)); // Blue\n\n    const int nSamples = 2;\n    const float fSamples = 2.0;\n\n    varying vec3 v_rayleighColor;\n    varying vec3 v_mieColor;\n    varying vec3 v_vertToCamera;\n    varying vec3 v_vertToOrigin;\n\n    ${o.default.atmosphere_vertex_utils}\n\n    //\n    // Computes rayleight and mia atmosphere factors for ground.\n    //\n    // Code based on GPU Gems article.\n    //\n    // Author: Sean O'Neil\n    //\n    // Copyright (c) 2004 Sean O'Neil\n    //\n    // https://developer.nvidia.com/gpugems/gpugems2/part-ii-shading-lighting-and-shadows/chapter-16-accurate-atmospheric-scattering\n    //\n    // Further modifications by HERE.\n    //\n    AtmosphereColor computeGroundAtmosphere(vec3 v3Pos, vec3 vLightDir)\n    {\n        // Retrieve environment variables\n        float fInnerRadius = u_atmosphereEnv.x;\n        float fOuterRadius = u_atmosphereEnv.y;\n        float fCameraHeight = u_atmosphereEnv.z;\n\n        // All that may be moved to const or define(s) at further optimizations:\n        float fScale = 1.0 / (fOuterRadius - fInnerRadius);\n        float fScaleOverScaleDepth = fScale / RayleighScaleDepth;\n        float fCameraHeight2 = fCameraHeight * fCameraHeight;\n        float fOuterRadius2 = fOuterRadius * fOuterRadius;\n\n        // Get the ray from the camera to the vertex and its length (which is the far point of the ray passing through the atmosphere)\n        vec3 v3Ray = v3Pos - u_eyePositionWorld;\n        float fFar = length(v3Ray);\n        v3Ray /= fFar;\n\n#if !defined(IMPROVE_DOT_PRECISION)\n        vec3 v3Dir = normalize(v3Pos);\n#endif\n\n#ifdef CAMERA_IN_SPACE\n\n        // Calculate first point of camera ray and sphere intersection.\n        float fNear = getNearSphereIntersect(u_eyePositionWorld, v3Ray, fCameraHeight2, fOuterRadius2);\n        // Make far relative to first atmosphere intersection, setting it to\n        // the length of ray passed through atmosphere\n        fFar -= fNear;\n\n        // Compute the ray's starting position within the atmosphere, then\n        // calculate its scattering offset\n        vec3 v3Start = u_eyePositionWorld + v3Ray * fNear;\n        float fDepth = exp((fInnerRadius - fOuterRadius) / RayleighScaleDepth);\n\n#else // CAMERA_IN_ATMOSPHERE\n\n        // The ray starts already in atmosphere\n        vec3 v3Start = u_eyePositionWorld;\n        // Virtually fNear is just at eye position, so ray passing through atmosphere does not shorten\n        // fFar -= 0.0;\n        float fDepth = exp((fInnerRadius - fCameraHeight) / RayleighScaleDepth);\n#endif\n\n#if defined(IMPROVE_DOT_PRECISION)\n        float fCameraAngle = dot(-v3Ray, v3Pos) / length(v3Pos);\n#else\n        float fCameraAngle = dot(-v3Ray, v3Dir);\n#endif\n        float fCameraScale = scale(fCameraAngle);\n\n#ifdef DYNAMIC_LIGHT\n        // When we want the atmosphere to be uniform over the globe so it is set to 1.0.\n        #if defined(IMPROVE_DOT_PRECISION)\n            // The light angle for given light source may be calculated as:\n            // angle = dot(vLightDir, v3Dir) / length(v3Dir);\n            // where v3Dir holds normalized vertex position, but for precision issues we v3Pos (un-normalized)\n            float fLightAngle = dot(vLightDir, v3Pos) / length(v3Pos);\n        #else\n            float fLightAngle = dot(vLightDir, v3Dir);\n        #endif\n#else\n        float fLightAngle = 1.0;\n#endif\n        float fLightScale = scale(fLightAngle);\n\n        float fCameraOffset = fDepth * fCameraScale;\n        float fTemp = (fLightScale + fCameraScale);\n\n        // Initialize the scattering loop variables\n        float fSampleLength = fFar / fSamples;\n        float fScaledLength = fSampleLength * fScale;\n        vec3 v3SampleRay = v3Ray * fSampleLength;\n        vec3 v3SamplePoint = v3Start + v3SampleRay * 0.5;\n\n        // Now loop through the sample rays\n        vec3 v3BaseColor = vec3(0.0);\n        vec3 v3Attenuate = vec3(0.0);\n        for(int i = 0; i < nSamples; i++)\n        {\n            float fHeight = length(v3SamplePoint);\n            float fDepth = exp(fScaleOverScaleDepth * (fInnerRadius - fHeight));\n            float fScatter = fDepth * fTemp - fCameraOffset;\n            // Compute color factors\n            v3Attenuate = exp(-fScatter * (InvWavelength * Kr4PI + Km4PI));\n            v3BaseColor += v3Attenuate * (fDepth * fScaledLength);\n            // Move to the next point\n            v3SamplePoint += v3SampleRay;\n        }\n\n        AtmosphereColor color;\n        color.mie = v3BaseColor * (InvWavelength * KrESun + KmESun);\n        // Calculate the attenuation factor for the ground\n        color.rayleigh = v3Attenuate;\n\n        return color;\n    }\n\n    void main(void)\n    {\n        #ifdef DYNAMIC_LIGHT\n            vec3 vLightDir = u_lightDirectionWorld;\n        #else\n            vec3 vLightDir = u_eyePositionWorld;\n        #endif\n        vLightDir = normalize(vLightDir);\n\n        AtmosphereColor atmColor = computeGroundAtmosphere(position.xyz, vLightDir);\n        v_mieColor = atmColor.mie;\n        v_rayleighColor = atmColor.rayleigh;\n        v_vertToCamera = u_eyePositionWorld - position.xyz;\n        v_vertToOrigin = normalize(position.xyz);\n\n        gl_Position = u_modelViewProjection * position;\n    }\n    `,fragmentShader:`\n\n    // Exposure correction gives more subtle gradients on the ground.\n    #define CORRECT_EXPOSURE 1\n    #define FADE_DEPTH 1\n    #define NIGHT_LOCAL 1\n\n    precision highp float;\n    precision highp int;\n\n    #ifdef CORRECT_COLOR\n    uniform vec3 u_hsvCorrection; // Hue, saturation, brightness\n    #endif\n\n    uniform vec3 u_atmosphereEnv; // Atmosphere inner and outer radius, camera height\n    uniform vec3 u_eyePositionWorld;\n    uniform vec3 u_lightDirectionWorld;\n\n    const float g = -0.95;\n    const float g2 = g * g;\n\n    varying vec3 v_rayleighColor;\n    varying vec3 v_mieColor;\n    varying vec3 v_vertToCamera;\n    varying vec3 v_vertToOrigin;\n\n    ${o.default.atmosphere_fragment_utils}\n\n    void main(void)\n    {\n        float fInnerRadius = u_atmosphereEnv.x;\n        float fOuterRadius = u_atmosphereEnv.y;\n        float fCameraHeight = u_atmosphereEnv.z;\n\n        #ifdef DYNAMIC_LIGHT\n            vec3 vLightDir = u_lightDirectionWorld;\n        #else\n            vec3 vLightDir = u_eyePositionWorld;\n        #endif\n        vLightDir = normalize(vLightDir);\n\n        // GPU gems mix of ground solution, with custom alpha settings\n        vec3 cRgb = v_mieColor + 0.25 * v_rayleighColor;\n\n        // Not needed for HDR frame buffer\n    #if !defined(HDR_FRAME_BUFFER) && defined(CORRECT_EXPOSURE)\n        // Interesting results with exposure factor: 2.0, 3.5, 4.0\n        cRgb = correctExposure(cRgb, 3.0);\n    #endif\n\n    #ifdef CORRECT_COLOR\n        cRgb = correctColor(cRgb, u_hsvCorrection);\n    #endif\n\n        // Base atmosphere opacity\n        float fAtmosphereAlpha = 1.0;\n\n        // Factor based on the distance of camera atmosphere and ground, results are:\n        // 0.0 = camera on the ground surface,\n        // 1.0 = at the outer edge of the atmosphere.\n        float fDepthFactor = clamp((fCameraHeight - fInnerRadius) /\n            (fOuterRadius - fInnerRadius), 0.0, 1.0);\n    #ifdef FADE_DEPTH\n        // Fade alpha based on the distance of camera between atmosphere layers\n        #ifdef FADE_DEPTH_LINEAR\n            fAtmosphereAlpha *= fDepthFactor;\n        #else\n            fAtmosphereAlpha *= pow(fDepthFactor, 1.5);\n        #endif\n    #endif\n\n#if defined(FADE_NIGHT) || defined(DARKEN_NIGHT)\n    #ifdef DYNAMIC_LIGHT\n        // Adjust factor based on time of day, results are:\n        // 0.0 = night,\n        // 1.0 = day.\n        #ifdef NIGHT_GLOBAL\n            // Global night fade based on camera and light orientation\n            float fNightFactor = clamp(dot(normalize(u_eyePositionWorld), vLightDir), 0.0, 1.0);\n            fNightFactor = pow(fNightFactor, 0.5);\n        #else // NIGHT_LOCAL\n            float fNightFactor =\n                clamp(dot(v_vertToOrigin, vLightDir) / length(v_vertToOrigin), 0.0, 1.0);\n            fNightFactor = pow(fNightFactor, 0.8);\n        #endif\n    #else\n        float fNightFactor = 1.0;\n    #endif\n#endif\n\n    #ifdef FADE_NIGHT\n        // Adjust alpha for night side of the globe\n        fAtmosphereAlpha *= fNightFactor;\n    #endif\n\n    #ifdef DARKEN_NIGHT\n        // Change the brightness depending on night / day side.\n        // NOTE: Darkening should be rather applied in HSV space, without loss on saturation,\n        // but it is much more GPU consuming.\n        const float minBrightness = 0.5;\n        float fDarkenFactor = clamp(fNightFactor, minBrightness, 1.0);\n        cRgb *= fDarkenFactor;\n    #endif\n\n    #ifdef EXPOSURE_DEPTH\n        // Control exposure depending from ground distance\n        float exposureBoost = 3.0 - fDepthFactor;\n        cRgb = correctExposure(cRgb, exposureBoost);\n    #endif\n\n        // Experimental fading out of focus point - similar to fresnel effect in top view.\n        // This fade is handy to better expose cartographic/map features in screen center.\n        float fFocusFactor = 1.0 - clamp(dot(normalize(v_vertToCamera), v_vertToOrigin), 0.0, 1.0) + 0.1;\n        fFocusFactor = pow(fFocusFactor, 2.5);\n        fAtmosphereAlpha *= fFocusFactor;\n\n        // Integrate all features\n        gl_FragColor = vec4(cRgb, fAtmosphereAlpha);\n    }\n    `};class a extends n.RawShaderMaterial{constructor(e){let r;e&&(r={name:"GroundAtmosphereMaterial",vertexShader:t.GroundAtmosphereShader.vertexShader,fragmentShader:t.GroundAtmosphereShader.fragmentShader,uniforms:t.GroundAtmosphereShader.uniforms,transparent:!0,depthTest:!1,depthWrite:!1,side:i.FrontSide,blending:i.NormalBlending,fog:!1,rendererCapabilities:e.rendererCapabilities}),super(r)}setDynamicLighting(e){s.setShaderMaterialDefine(this,"DYNAMIC_LIGHT",e)}set outerRadius(e){this.uniforms.u_atmosphereEnv.value.y=e}get outerRadius(){return this.uniforms.u_atmosphereEnv.value.y}set innerRadius(e){this.uniforms.u_atmosphereEnv.value.x=e}get innerRadius(){return this.uniforms.u_atmosphereEnv.value.x}updateUniforms(e,t,r,i){const n=this.getCameraInfo(t,r);if(void 0===e||!e.isMaterial)throw Error("Wrong object used, only Material objects are supported");if(!(e.uniforms&&e.uniforms.u_atmosphereEnv&&e.uniforms.u_hsvCorrection&&e.uniforms.u_eyePositionWorld&&e.uniforms.u_modelViewProjection&&e.uniforms.u_lightDirectionWorld))throw Error("Atmosphere material has missing uniforms");{const t=n.eyePos,r=n.modelViewProjection,o=n.eyeHeight;e.uniforms.u_eyePositionWorld.value.copy(t),e.uniforms.u_modelViewProjection.value.copy(r),e.uniforms.u_atmosphereEnv.value.z=o,e.uniforms.u_lightDirectionWorld.value=i.clone();const a=o>this.outerRadius,l=s.setShaderDefine(e.defines,"CAMERA_IN_SPACE",a),u=s.setShaderDefine(e.defines,"CAMERA_IN_ATMOSPHERE",!a);e.needsUpdate=e.needsUpdate||l||u}}getCameraInfo(e,t,r=!1){if(r){const r=(new i.Matrix4).identity(),n=(new i.Matrix4).copy(e.matrixWorld).invert().transpose(),o=t.projectionMatrix,s=new i.Matrix4;s.multiplyMatrices(n,r),s.multiplyMatrices(o,s);const a=new i.Vector3;e.getWorldPosition(a);const l=new i.Vector3;return t.getWorldPosition(l),{modelViewProjection:s,eyePos:a,eyeHeight:l.distanceTo(a)}}{const r=e.matrixWorld,n=t.matrixWorldInverse,o=t.projectionMatrix,s=new i.Matrix4;s.multiplyMatrices(n,r),s.multiplyMatrices(o,s);const a=new i.Vector3;t.getWorldPosition(a);const l=new i.Vector3;e.getWorldPosition(l);const u=l.distanceTo(a);return a.sub(l),{modelViewProjection:s,eyePos:a,eyeHeight:u}}}}t.GroundAtmosphereMaterial=a},5172:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isHighPrecisionLineMaterial=t.HighPrecisionLineMaterial=void 0;const i=r(4428),n=r(3993),o=r(5477);class s extends n.RawShaderMaterial{constructor(e){Object.assign(i.ShaderChunk,o.default);const t=e?{name:"HighPrecisionLineMaterial",vertexShader:"\n#ifdef USE_COLOR\nattribute vec4 color;\nvarying vec3 vColor;\n#endif\n\n// uniforms to implement double-precision\nuniform mat4 u_mvp;             // combined modelView and projection matrix\nuniform vec3 u_eyepos;          // eye position major\nuniform vec3 u_eyepos_lowpart;  // eye position minor ((double) eyepos - (float) eyepos)\n\n// vertex attributes\nattribute vec3 position;        // high part\nattribute vec3 positionLow;     // low part\n\n#include <high_precision_vert_func>\n\nvoid main() {\n    #ifdef USE_COLOR\n    vColor = color.rgb;\n    #endif\n\n    vec3 pos = subtractDblEyePos(position);\n    gl_Position = u_mvp * vec4(pos, 1.0);\n}",fragmentShader:"\nprecision highp float;\nprecision highp int;\n\nuniform vec3 diffuse;\nuniform float opacity;\n\n#ifdef USE_COLOR\nvarying vec3 color;\n#endif\n\nvoid main() {\n    #ifdef USE_COLOR\n    gl_FragColor = vec4( diffuse * vColor, opacity );\n    #else\n    gl_FragColor = vec4( diffuse, opacity );\n    #endif\n}",uniforms:{diffuse:new i.Uniform(new i.Color(s.DEFAULT_COLOR)),opacity:new i.Uniform(s.DEFAULT_OPACITY),u_mvp:new i.Uniform(new i.Matrix4),u_eyepos:new i.Uniform(new i.Vector3),u_eyepos_lowpart:new i.Uniform(new i.Vector3)},rendererCapabilities:e.rendererCapabilities}:void 0;Object.assign(t,e),super(t),this.type="HighPrecisionLineMaterial",this.isHighPrecisionLineMaterial=!0,e&&(void 0!==e.color&&this.color.set(e.color),void 0!==e.opacity&&(this.opacity=e.opacity)),this.updateTransparencyFeature()}get color(){return this.uniforms.diffuse.value}set color(e){this.uniforms.diffuse.value.copy(e)}updateTransparencyFeature(){this.transparent=this.opacity<1}}t.HighPrecisionLineMaterial=s,s.DEFAULT_COLOR=80,s.DEFAULT_OPACITY=1,t.isHighPrecisionLineMaterial=function(e){return void 0!==e&&!0===e.isHighPrecisionLineMaterial}},884:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isHighPrecisionPointMaterial=t.HighPrecisionPointMaterial=void 0;const i=r(4428),n=r(5477);class o extends i.PointsMaterial{constructor(e){Object.assign(i.ShaderChunk,n.default),super(e),this.type="HighPrecisionPointMaterial",this.vertexShader="\n#ifdef USE_COLOR\nvarying vec3 vColor;\n#endif\n\nuniform float size;\n\n// uniforms to implement double-precision\nuniform mat4 u_mvp;             // combined modelView and projection matrix\nuniform vec3 u_eyepos;          // eye position major\nuniform vec3 u_eyepos_lowpart;  // eye position minor ((double) eyepos - (float) eyepos)\n\n// vertex attributes\nattribute vec3 positionLow;     // low part\n\n#include <high_precision_vert_func>\n\nvoid main() {\n    #ifdef USE_COLOR\n    vColor = color.rgb;\n    #endif\n\n    vec3 pos = subtractDblEyePos(position);\n    gl_Position = u_mvp * vec4(pos, 1.0);\n\n    // ignore sizeAttenuation for now!\n    gl_PointSize = size;\n}",this.fragmentShader=i.ShaderChunk.points_frag,this.fog=!1,this.uniforms={diffuse:new i.Uniform(new i.Color(o.DEFAULT_COLOR)),opacity:new i.Uniform(o.DEFAULT_OPACITY),size:new i.Uniform(o.DEFAULT_SIZE),scale:new i.Uniform(o.DEFAULT_SCALE),map:new i.Uniform(new i.Texture),uvTransform:new i.Uniform(new i.Matrix3),u_mvp:new i.Uniform(new i.Matrix4),u_eyepos:new i.Uniform(new i.Vector3),u_eyepos_lowpart:new i.Uniform(new i.Vector3)},this.isHighPrecisionPointMaterial=!0,void 0!==e&&(void 0!==e.color&&this.color.set(e.color),void 0!==e.opacity&&(this.opacity=e.opacity),void 0!==e.size&&(this.size=e.size),void 0!==e.scale&&(this.scale=e.scale),void 0!==e.uvTransform&&(this.uvTransform=e.uvTransform),void 0!==e.map&&(this.map=e.map))}get scale(){return this.uniforms.scale.value}set scale(e){this.uniforms.scale.value=e}get uvTransform(){return this.uniforms.uvTransform.value}set uvTransform(e){this.uniforms.uvTransform.value=e}}t.HighPrecisionPointMaterial=o,o.DEFAULT_COLOR=80,o.DEFAULT_OPACITY=1,o.DEFAULT_SIZE=1,o.DEFAULT_SCALE=1,t.isHighPrecisionPointMaterial=function(e){return void 0!==e&&!0===e.isHighPrecisionPointMaterial}},2343:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IconMaterial=void 0;const i=r(4428),n=r(3993);class o extends n.RawShaderMaterial{constructor(e){super(e?{name:"IconMaterial",vertexShader:"\nattribute vec4 position;\nattribute vec4 color;\nattribute vec2 uv;\n\nuniform mat4 modelViewMatrix;\nuniform mat4 projectionMatrix;\n\nvarying vec4 vColor;\nvarying vec2 vUv;\n\nvoid main() {\n    vUv = uv;\n    vColor = color;\n    gl_Position = projectionMatrix * modelViewMatrix * vec4(position.xyz, 1.0);\n}",fragmentShader:"\nprecision highp float;\nprecision highp int;\n\nuniform sampler2D map;\n\nvarying vec4 vColor;\nvarying vec2 vUv;\n\nvoid main() {\n\n    vec4 color = texture2D(map, vUv.xy);\n    color *= vColor;\n    if (color.a < 0.05) {\n        discard;\n    }\n    gl_FragColor = color;\n}",uniforms:{map:new i.Uniform(e.map)},depthTest:!0,depthWrite:!1,transparent:!0,vertexColors:!0,premultipliedAlpha:!0,rendererCapabilities:e.rendererCapabilities}:void 0)}get map(){return this.uniforms.map.value}}t.IconMaterial=o},5930:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LuminosityHighPassShader=void 0;const i=r(4428);t.LuminosityHighPassShader={uniforms:{tDiffuse:{value:null},luminosityThreshold:{value:1},smoothWidth:{value:1},defaultColor:{value:new i.Color(0)},defaultOpacity:{value:0}},vertexShader:"\n    varying vec2 vUv;\n    void main() {\n        vUv = uv;\n        gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n    }",fragmentShader:"\n    uniform sampler2D tDiffuse;\n    uniform vec3 defaultColor;\n    uniform float defaultOpacity;\n    uniform float luminosityThreshold;\n    uniform float smoothWidth;\n    varying vec2 vUv;\n    void main() {\n        vec4 texel = texture2D( tDiffuse, vUv );\n        vec3 luma = vec3( 0.299, 0.587, 0.114 );\n        float v = dot( texel.xyz, luma );\n        vec4 outputColor = vec4( defaultColor.rgb, defaultOpacity );\n        float alpha = smoothstep( luminosityThreshold, luminosityThreshold + smoothWidth, v );\n        gl_FragColor = mix( outputColor, texel, alpha );\n    }"}},8682:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MSAAMaterial=void 0;const i=r(4428),n=r(5083);class o extends i.ShaderMaterial{constructor(e){super({uniforms:e,vertexShader:n.CopyShader.vertexShader,fragmentShader:n.CopyShader.fragmentShader,premultipliedAlpha:!0,transparent:!0,blending:i.AdditiveBlending,depthTest:!1,depthWrite:!1})}}t.MSAAMaterial=o},5722:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MapMeshStandardMaterial=t.MapMeshDepthMaterial=t.MapMeshBasicMaterial=t.ExtrusionFeatureMixin=t.ExtrusionFeature=t.FadingFeatureMixin=t.FadingFeature=t.DisplacementFeatureMixin=t.hasExtrusionFeature=void 0;const i=r(3333),n=r(4428),o=r(8136),s=r(7225),a=r(9178),l=r(5888),u=r(1703),c=new n.Texture;function h(e,t){return e*t.maximum}function d(e,t){void 0===t.defines&&(t.defines={}),e.shaderDefines=t.defines,void 0===e.shaderUniforms&&(e.shaderUniforms={})}function f(e,t){Object.assign(t.uniforms,e.shaderUniforms),e.shaderUniforms=t.uniforms}var p,m,g;t.hasExtrusionFeature=function(e){return"extrusionRatio"in e},function(e){function t(e){return null!==e.displacementMap}e.isEnabled=t,e.updateDisplacementFeature=function(e){i.assert(void 0!==e.shaderDefines),i.assert(void 0!==e.shaderUniforms);const r=t(e),n=u.setShaderDefine(e.shaderDefines,"USE_DISPLACEMENTMAP",r);if(e.needsUpdate=n,r){const t=e.displacementMap;t.needsUpdate=!0,e.shaderUniforms.displacementMap.value=t}else n&&(e.shaderUniforms.displacementMap.value=c)},e.onBeforeCompile=function(e,r){t(e)&&(i.assert(void 0!==e.shaderUniforms),f(e,r),r.vertexShader=r.vertexShader.replace("#include <skinbase_vertex>","#include <skinbase_vertex>\n#ifndef USE_ENVMAP\n    vec3 objectNormal = vec3( normal );\n#endif"),r.vertexShader=u.insertShaderInclude(r.vertexShader,"uv2_pars_vertex","displacementmap_pars_vertex"),r.vertexShader=u.insertShaderInclude(r.vertexShader,"skinning_vertex","displacementmap_vertex",!0))}}(p||(p={}));class v{constructor(){this.m_displacementMap=null}get displacementMap(){return this.m_displacementMap}set displacementMap(e){this.setDisplacementMap(e)}getDisplacementMap(){return this.m_displacementMap}setDisplacementMap(e){e!==this.m_displacementMap&&(this.m_displacementMap=e,p.updateDisplacementFeature(this))}addDisplacementProperties(){Object.defineProperty(this,"displacementMap",{get:()=>this.getDisplacementMap(),set:e=>{this.setDisplacementMap(e)}})}applyDisplacementParameters(e){d(this,this),i.assert(void 0!==this.shaderDefines),i.assert(void 0!==this.shaderUniforms);const t=this.shaderUniforms;t.displacementMap=new n.Uniform(c),t.displacementScale=new n.Uniform(1),t.displacementBias=new n.Uniform(0),void 0!==e&&void 0!==e.displacementMap&&this.setDisplacementMap(e.displacementMap),this.onBeforeCompile=i.chainCallbacks(this.onBeforeCompile,(e=>{p.onBeforeCompile(this,e)})),this.needsUpdate=p.isEnabled(this)}copyDisplacementParameters(e){return this.setDisplacementMap(e.displacementMap),this}}t.DisplacementFeatureMixin=v,function(e){function t(e){return void 0!==e.fadeNear&&void 0!==e.fadeFar&&e.fadeFar>0}e.DEFAULT_FADE_NEAR=-1,e.DEFAULT_FADE_FAR=-1,e.isEnabled=t,e.isDefined=function(e){return void 0!==e.fadeNear&&void 0!==e.fadeFar},e.patchGlobalShaderChunks=function(){void 0===n.ShaderChunk.fading_pars_vertex&&Object.assign(n.ShaderChunk,a.default)},e.updateFadingFeature=function(r){i.assert(void 0!==r.shaderDefines),i.assert(void 0!==r.shaderUniforms);const n=t(r),o=u.setShaderDefine(r.shaderDefines,"FADING_MATERIAL",n);r.needsUpdate=o,i.assert(void 0!==r.shaderUniforms.fadeNear&&void 0!==r.shaderUniforms.fadeFar),n?(r.shaderUniforms.fadeNear.value=r.fadeNear,r.shaderUniforms.fadeFar.value=r.fadeFar,o&&u.enableBlending(r)):o&&(r.shaderUniforms.fadeNear.value=e.DEFAULT_FADE_NEAR,r.shaderUniforms.fadeFar.value=e.DEFAULT_FADE_FAR,u.disableBlending(r))},e.onBeforeCompile=function(e,r){t(e)&&(i.assert(void 0!==e.shaderUniforms),f(e,r),r.vertexShader=u.insertShaderInclude(r.vertexShader,"fog_pars_vertex","fading_pars_vertex"),r.vertexShader=u.insertShaderInclude(r.vertexShader,"fog_vertex","fading_vertex",!0),r.fragmentShader=u.insertShaderInclude(r.fragmentShader,"fog_pars_fragment","fading_pars_fragment"),r.fragmentShader=u.insertShaderInclude(r.fragmentShader,"fog_fragment","fading_fragment",!0))},e.addRenderHelper=function(t,r,n,o,s,a){t.onBeforeRender=i.chainCallbacks(t.onBeforeRender,((t,i,s,l,u,c)=>{const d=u;d.fadeNear=void 0===n||n===e.DEFAULT_FADE_NEAR?e.DEFAULT_FADE_NEAR:h(n,r),d.fadeFar=void 0===o||o===e.DEFAULT_FADE_FAR?e.DEFAULT_FADE_FAR:h(o,r),void 0!==a&&a(t,u)}))}}(m=t.FadingFeature||(t.FadingFeature={}));class y{constructor(){this.m_fadeNear=m.DEFAULT_FADE_NEAR,this.m_fadeFar=m.DEFAULT_FADE_FAR}getFadeNear(){return this.m_fadeNear}setFadeNear(e){e!==this.m_fadeNear&&(this.m_fadeNear=e,m.updateFadingFeature(this))}getFadeFar(){return this.m_fadeFar}setFadeFar(e){e!==this.m_fadeFar&&(this.m_fadeFar=e,m.updateFadingFeature(this))}addFadingProperties(){Object.defineProperty(this,"fadeNear",{get:()=>this.getFadeNear(),set:e=>{this.setFadeNear(e)}}),Object.defineProperty(this,"fadeFar",{get:()=>this.getFadeFar(),set:e=>{this.setFadeFar(e)}})}applyFadingParameters(e){d(this,this),i.assert(void 0!==this.shaderDefines),i.assert(void 0!==this.shaderUniforms),this.shaderUniforms.fadeNear=new n.Uniform(m.DEFAULT_FADE_NEAR),this.shaderUniforms.fadeFar=new n.Uniform(m.DEFAULT_FADE_FAR),void 0!==e&&(void 0!==e.fadeNear&&this.setFadeNear(e.fadeNear),void 0!==e.fadeFar&&this.setFadeFar(e.fadeFar)),this.onBeforeCompile=i.chainCallbacks(this.onBeforeCompile,(e=>{m.onBeforeCompile(this,e)})),this.needsUpdate=m.isEnabled(this)}copyFadingParameters(e){return this.setFadeNear(void 0===e.fadeNear?m.DEFAULT_FADE_NEAR:e.fadeNear),this.setFadeFar(void 0===e.fadeFar?m.DEFAULT_FADE_FAR:e.fadeFar),this}}t.FadingFeatureMixin=y,function(e){function t(e){return void 0!==e.extrusionRatio&&e.extrusionRatio>=o.ExtrusionFeatureDefs.DEFAULT_RATIO_MIN}e.isEnabled=t,e.patchGlobalShaderChunks=function(){void 0===n.ShaderChunk.extrusion_pars_vertex&&Object.assign(n.ShaderChunk,s.default)},e.updateExtrusionFeature=function(e){i.assert(void 0!==e.shaderDefines),i.assert(void 0!==e.shaderUniforms);const r=t(e),n=u.setShaderDefine(e.shaderDefines,"EXTRUSION_MATERIAL",r);e.needsUpdate=n,r?e.shaderUniforms.extrusionRatio.value=e.extrusionRatio:n&&(e.shaderUniforms.extrusionRatio.value=o.ExtrusionFeatureDefs.DEFAULT_RATIO_MAX)},e.onBeforeCompile=function(e,r){t(e)&&(i.assert(void 0!==e.shaderUniforms),f(e,r),r.vertexShader=u.insertShaderInclude(r.vertexShader,"common","extrusion_pars_vertex"),r.vertexShader=u.insertShaderInclude(r.vertexShader,"begin_vertex","extrusion_vertex",!0),r.fragmentShader=u.insertShaderInclude(r.fragmentShader,"fog_pars_fragment","extrusion_pars_fragment"),r.fragmentShader=r.fragmentShader.replace("#include <normal_fragment_begin>","#include <extrusion_normal_fragment_begin>"),r.fragmentShader=u.insertShaderInclude(r.fragmentShader,"fog_fragment","extrusion_fragment",!0))}}(g=t.ExtrusionFeature||(t.ExtrusionFeature={}));class x{constructor(){this.m_extrusion=o.ExtrusionFeatureDefs.DEFAULT_RATIO_MAX}getExtrusionRatio(){return this.m_extrusion}setExtrusionRatio(e){e!==this.m_extrusion&&(this.m_extrusion=e,g.updateExtrusionFeature(this))}addExtrusionProperties(){Object.defineProperty(this,"extrusionRatio",{get:()=>this.getExtrusionRatio(),set:e=>{this.setExtrusionRatio(e)}})}applyExtrusionParameters(e){d(this,this),i.assert(void 0!==this.shaderDefines),i.assert(void 0!==this.shaderUniforms),e&&!0===e.zFightingWorkaround&&(this.shaderDefines.ZFIGHTING_WORKAROUND=""),this.shaderUniforms.extrusionRatio=new n.Uniform(o.ExtrusionFeatureDefs.DEFAULT_RATIO_MAX),void 0!==e&&void 0!==e.extrusionRatio&&this.setExtrusionRatio(e.extrusionRatio),this.onBeforeCompile=i.chainCallbacks(this.onBeforeCompile,(e=>{g.onBeforeCompile(this,e)})),this.needsUpdate=g.isEnabled(this)}copyExtrusionParameters(e){return void 0!==e.extrusionRatio&&this.setExtrusionRatio(e.extrusionRatio),this}}t.ExtrusionFeatureMixin=x;class _ extends n.MeshBasicMaterial{constructor(e){super(e),m.patchGlobalShaderChunks(),this.addFadingProperties(),this.applyFadingParameters(e),g.patchGlobalShaderChunks(),this.addExtrusionProperties(),this.applyExtrusionParameters(Object.assign(Object.assign({},e),{zFightingWorkaround:!0})),this.addDisplacementProperties(),this.applyDisplacementParameters(e)}clone(){return(new _).copy(this)}copy(e){return super.copy(e),this.copyFadingParameters(e),this.copyExtrusionParameters(e),this.copyDisplacementParameters(e),this}get fadeNear(){return m.DEFAULT_FADE_NEAR}set fadeNear(e){}get fadeFar(){return m.DEFAULT_FADE_FAR}set fadeFar(e){}get extrusionRatio(){return o.ExtrusionFeatureDefs.DEFAULT_RATIO_MAX}set extrusionRatio(e){}get displacementMap(){return null}set displacementMap(e){}setDisplacementMap(e){}addFadingProperties(){}applyFadingParameters(e){}copyFadingParameters(e){}addExtrusionProperties(){}applyExtrusionParameters(e){}copyExtrusionParameters(e){}addDisplacementProperties(){}applyDisplacementParameters(e){}copyDisplacementParameters(e){}}t.MapMeshBasicMaterial=_;class b extends n.MeshDepthMaterial{constructor(e){super(e),g.patchGlobalShaderChunks(),this.addExtrusionProperties(),this.applyExtrusionParameters(Object.assign(Object.assign({},e),{zFightingWorkaround:!1}))}get extrusionRatio(){return o.ExtrusionFeatureDefs.DEFAULT_RATIO_MAX}set extrusionRatio(e){}addExtrusionProperties(){}applyExtrusionParameters(e){}copyExtrusionParameters(e){}}t.MapMeshDepthMaterial=b;class w extends n.MeshStandardMaterial{constructor(e){super(e),m.patchGlobalShaderChunks(),this.addFadingProperties(),this.applyFadingParameters(e),g.patchGlobalShaderChunks(),this.addExtrusionProperties(),this.applyExtrusionParameters(Object.assign(Object.assign({},e),{zFightingWorkaround:!0})),!0===(null==e?void 0:e.removeDiffuseLight)&&(this.onBeforeCompile=i.chainCallbacks(this.onBeforeCompile,(e=>{e.fragmentShader=n.ShaderChunk.meshphysical_frag.replace("#include <lights_physical_pars_fragment>",l.simpleLightingShadowChunk)})))}clone(){return(new w).copy(this)}copy(e){return super.copy(e),this.copyFadingParameters(e),this.copyExtrusionParameters(e),this}get fadeNear(){return m.DEFAULT_FADE_NEAR}set fadeNear(e){}get fadeFar(){return m.DEFAULT_FADE_FAR}set fadeFar(e){}get extrusionRatio(){return o.ExtrusionFeatureDefs.DEFAULT_RATIO_MAX}set extrusionRatio(e){}get removeDiffuseLight(){return!1}set removeDiffuseLight(e){}addFadingProperties(){}applyFadingParameters(e){}copyFadingParameters(e){}addExtrusionProperties(){}applyExtrusionParameters(e){}copyExtrusionParameters(e){}}t.MapMeshStandardMaterial=w,i.applyMixinsWithoutProperties(_,[y]),i.applyMixinsWithoutProperties(w,[y]),i.applyMixinsWithoutProperties(_,[x]),i.applyMixinsWithoutProperties(w,[x]),i.applyMixinsWithoutProperties(b,[x]),i.applyMixinsWithoutProperties(_,[v])},8136:(e,t)=>{"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.ExtrusionFeatureDefs=void 0,(r=t.ExtrusionFeatureDefs||(t.ExtrusionFeatureDefs={})).DEFAULT_RATIO_MIN=0,r.DEFAULT_RATIO_MAX=1,r.MIN_BUILDING_HEIGHT=.1},3993:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RawShaderMaterial=void 0;const i=r(3333),n=r(4428),o=r(1703);class s extends n.RawShaderMaterial{constructor(e){const t=!0===(null==e?void 0:e.rendererCapabilities.isWebGL2),r=e?Object.assign(Object.assign({},e),{glslVersion:t?n.GLSL3:n.GLSL1,vertexShader:t&&e.vertexShader?i.convertVertexShaderToWebGL2(e.vertexShader):e.vertexShader,fragmentShader:t&&e.fragmentShader?i.convertFragmentShaderToWebGL2(e.fragmentShader):e.fragmentShader}):void 0;r&&delete r.rendererCapabilities,super(r),this.invalidateFog(),this.setOpacity(null==r?void 0:r.opacity)}invalidateFog(){void 0!==this.defines&&this.fog!==o.getShaderMaterialDefine(this,"USE_FOG")&&o.setShaderMaterialDefine(this,"USE_FOG",this.fog)}setOpacity(e){var t;void 0!==e&&(this.opacity=e,(null===(t=this.uniforms)||void 0===t?void 0:t.opacity)&&(this.uniforms.opacity.value=e))}}t.RawShaderMaterial=s},5421:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SepiaShader=void 0,t.SepiaShader={uniforms:{tDiffuse:{value:null},amount:{value:1}},vertexShader:"\n        varying vec2 vUv;\n        void main() {\n            vUv = uv;\n            gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n        }",fragmentShader:"\n        uniform float amount;\n        uniform sampler2D tDiffuse;\n        varying vec2 vUv;\n        void main() {\n            vec4 color = texture2D( tDiffuse, vUv );\n            vec3 c = color.rgb;\n            color.r = dot( c, vec3( 1.0 - 0.607 * amount, 0.769 * amount, 0.189 * amount ) );\n            color.g = dot( c, vec3( 0.349 * amount, 1.0 - 0.314 * amount, 0.168 * amount ) );\n            color.b = dot( c, vec3( 0.272 * amount, 0.534 * amount, 1.0 - 0.869 * amount ) );\n            gl_FragColor = vec4( min( vec3( 1.0 ), color.rgb ), color.a );\n        }"}},2870:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={atmosphere_vertex_utils:"\n\n    const float RayleighScaleDepth = 0.25;\n\n    struct AtmosphereColor\n    {\n        vec3 mie;\n        vec3 rayleigh;\n    };\n\n    float scale(float cosAngle)\n    {\n        float x = 1.0 - cosAngle;\n        return RayleighScaleDepth  * exp(-0.00287 + x*(0.459 + x*(3.83 + x*(-6.80 + x*5.25))));\n    }\n\n    float getNearSphereIntersect(vec3 v3Pos, vec3 v3Ray, float fCameraHeight2, float fOuterRadius2) {\n        // Solve simple square equation for the x0 (first point of intersection).\n#if defined(IMPROVE_INTERSECT_PRECISION)\n        // To improve precision instead of simple projection: b = 2.0 * dot(vPos, v3Ray),\n        // we change the equation that gives better results especially around the poles.\n        float fB = 2.0 * length(v3Pos) * dot(normalize(v3Pos), v3Ray);\n#else\n        float fB = 2.0 * dot(v3Pos, v3Ray);\n#endif\n        float fC = fCameraHeight2 - fOuterRadius2;\n        // det = b^2 - 4*a*c, where a = 1\n        float fDet = max(0.0, fB * fB - 4.0 * fC);\n        // Intersection points distances are defined as follows:\n        // x0 = (-b - sqrt(det)) / 2*a ^ x1 = (-b + sqrt(det)) / 2*a\n        // we search for x0:\n        return 0.5 * (-fB - sqrt(fDet));\n    }\n\n    float getFarSphereIntersect(vec3 v3Pos, vec3 v3Ray, float fCameraHeight2, float fOuterRadius2) {\n        // Solve simple square equation for the x1 (second point of intersection).\n#if defined(IMPROVE_INTERSECT_PRECISION)\n        float fB = 2.0 * length(v3Pos) * dot(normalize(v3Pos), v3Ray);\n#else\n        float fB = 2.0 * dot(v3Pos, v3Ray);\n#endif\n        float fC = fCameraHeight2 - fOuterRadius2;\n        // det = b^2 - 4*a*c, where a = 1\n        float fDet = max(0.0, fB * fB - 4.0 * fC);\n        // Compute second intersection distance:\n        // x1 = (-b + sqrt(det)) / 2*a\n        return 0.5 * (-fB + sqrt(fDet));\n    }\n    ",atmosphere_fragment_utils:"\n\n    // Branch free RGB to HSV conversion.\n    // Based on article:\n    // http://lolengine.net/blog/2013/01/13/fast-rgb-to-hsv\n    // and optimized OpenGL SL algorithm\n    // http://lolengine.net/blog/2013/07/27/rgb-to-hsv-in-glsl\n    vec3 rgb2Hsv(vec3 c)\n    {\n        const vec4 RGB_HSV_CONV = vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);\n        // Ternary operator may be used explicitly if compiler can use fast conditional move.\n        // vec4 p = c.g < c.b ? vec4(c.bg, RGB_HSV_CONV.wz) : vec4(c.gb, RGB_HSV_CONV.xy);\n        vec4 p = mix(vec4(c.bg, RGB_HSV_CONV.wz), vec4(c.gb, RGB_HSV_CONV.xy), step(c.b, c.g));\n        // vec4 q = c.r < p.x ? vec4(p.xyw, c.r) : vec4(c.r, p.yzx);\n        vec4 q = mix(vec4(p.xyw, c.r), vec4(c.r, p.yzx), step(p.x, c.r));\n\n        float d = q.x - min(q.w, q.y);\n        float e = 1.0e-10;\n        return vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), d / (q.x + e), q.x);\n    }\n\n    // Branch free HSV to RGB conversion\n    vec3 hsv2Rgb(vec3 c)\n    {\n        const vec4 HSV_RGB_CONV = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n        vec3 p = abs(fract(c.xxx + HSV_RGB_CONV.xyz) * 6.0 - HSV_RGB_CONV.www);\n        return c.z * mix(HSV_RGB_CONV.xxx, clamp(p - HSV_RGB_CONV.xxx, 0.0, 1.0), c.y);\n    }\n\n    vec3 correctExposure(vec3 rgb, float exposure)\n    {\n        const vec3 fullColor = vec3(1.0);\n        return fullColor - exp(-exposure * rgb);\n    }\n\n    vec3 correctColor(vec3 rgb, vec3 hsvShift)\n    {\n        const float e = 0.0000001;\n        // Convert rgb color to hsv\n        vec3 hsv = rgb2Hsv(rgb);\n        // Shift hue value with angle wrapping\n        hsv.x = mod(hsv.x + hsvShift.x, 1.0);\n        // Shift and clamp saturation\n        hsv.y = clamp(hsv.y + hsvShift.y, 0.0, 1.0);\n        // Change value if it is significant (greater then epsilon)\n        hsv.z = hsv.z > e ? clamp(hsv.z + hsvShift.z, 0.0, 1.0) : 0.0;\n        // Convert shifted hsv back to rgb\n        return hsv2Rgb(hsv);\n    }\n    "}},7225:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(8136),n=i.ExtrusionFeatureDefs.MIN_BUILDING_HEIGHT*i.ExtrusionFeatureDefs.MIN_BUILDING_HEIGHT;t.default={extrusion_pars_vertex:"\n// Add define so we can check for it in the outline effect (see Outline.ts).\n#define HAS_EXTRUSION_PARS_VERTEX\n// Extrusion axis (xyz: vector, w: factor).\nattribute vec4 extrusionAxis;\nuniform float extrusionRatio;\n#ifdef FLAT_SHADED\nvarying vec4 vExtrusionAxis;\n#endif\n#ifdef ZFIGHTING_WORKAROUND\nvarying float vExtrusionRatio;\n#endif\n",extrusion_vertex:`\n#define HAS_EXTRUSION_VERTEX\n#ifdef ZFIGHTING_WORKAROUND\n// Cancel extrusionRatio (meaning, force to 1) if extrusionAxisLen < MIN_BUILDING_HEIGHT.\nconst float MIN_BUILDING_HEIGHT_SQUARED = ${n};\nfloat extrusionAxisLenSquared = dot(extrusionAxis.xyz, extrusionAxis.xyz);\nvExtrusionRatio = (extrusionAxisLenSquared < MIN_BUILDING_HEIGHT_SQUARED) ? 1.0 : extrusionRatio;\n#else\nfloat vExtrusionRatio = extrusionRatio;\n#endif\ntransformed = transformed + extrusionAxis.xyz * (vExtrusionRatio - 1.0);\n#ifdef FLAT_SHADED\nvExtrusionAxis = vec4(normalMatrix * extrusionAxis.xyz, extrusionAxis.w);\n#endif\n`,extrusion_normal_fragment_begin:"\n#ifdef FLAT_SHADED\n    // Flattened this divergent path to prevent undefined behaviour in the following derivatives\n    // functions. For more info:\n    // http://www.aclockworkberry.com/shader-derivative-functions/#Derivatives_and_branches\n\n    // Workaround for Adreno/Nexus5 not able able to do dFdx( vViewPosition ) ...\n    vec3 fdx = vec3(dFdx(vViewPosition.x), dFdx(vViewPosition.y), dFdx(vViewPosition.z));\n    vec3 fdy = vec3(dFdy(vViewPosition.x), dFdy(vViewPosition.y), dFdy(vViewPosition.z));\n    vec3 normal = cross( fdx, fdy );\n    if (vExtrusionAxis.w > 0.999999) {\n        normal = vExtrusionAxis.xyz;\n    }\n    normal = normalize(normal);\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * (float(gl_FrontFacing) * 2.0 - 1.0);\n\t#endif\n\t#ifdef USE_TANGENT\n\t\tvec3 tangent = normalize( vTangent );\n\t\tvec3 bitangent = normalize( vBitangent );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\ttangent = tangent * (float(gl_FrontFacing) * 2.0 - 1.0);\n\t\t\tbitangent = bitangent * (float(gl_FrontFacing) * 2.0 - 1.0);\n\t\t#endif\n\t#endif\n#endif\n// non perturbed normal for clearcoat among others\nvec3 geometryNormal = normal;\n",extrusion_pars_fragment:"\n#ifdef ZFIGHTING_WORKAROUND\nvarying float vExtrusionRatio;\n#else\nuniform float extrusionRatio;\n#endif\nvarying vec4 vExtrusionAxis;\n",extrusion_fragment:"\n#ifndef ZFIGHTING_WORKAROUND\nfloat vExtrusionRatio = extrusionRatio;\n#endif\ngl_FragColor.a *= smoothstep( 0.0, 0.25, vExtrusionRatio );\n"}},9178:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={fading_pars_vertex:"\nvarying float fadingDepth;\n",fading_vertex:"\nfadingDepth = -mvPosition.z;\n",fading_pars_fragment:"\nvarying float fadingDepth;\nuniform float fadeNear;\nuniform float fadeFar;\n",fading_fragment:'\n\n// lerp with "hard" edges\n//float fadingFactor = 1.0 - clamp((fadingDepth - fadeNear) / (fadeFar - fadeNear), 0.0, 1.0);\n\n// smooth transitions\nfloat fadingFactor = smoothstep( fadeNear, fadeFar, fadingDepth );\n\ngl_FragColor.a *= 1.0 - fadingFactor;\n\n// debugging color:\n// gl_FragColor = vec4(1., fadingFactor, fadingFactor, 1.0);\n'}},5477:(e,t)=>{"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.LineCapsModes=void 0,function(e){e[e.CAPS_NONE=0]="CAPS_NONE",e[e.CAPS_SQUARE=1]="CAPS_SQUARE",e[e.CAPS_ROUND=2]="CAPS_ROUND",e[e.CAPS_TRIANGLE_IN=3]="CAPS_TRIANGLE_IN",e[e.CAPS_TRIANGLE_OUT=4]="CAPS_TRIANGLE_OUT"}(r=t.LineCapsModes||(t.LineCapsModes={})),t.default={extrude_line_vert_func:"\nvec3 extrudeLine(\n        in vec3 vertexPosition,\n        in float linePosition,\n        in float extrusionWidth,\n        in vec4 bitangent,\n        in vec3 tangent,\n        in float tanHalfAngle,\n        inout vec2 uv\n    ) {\n    vec3 result = vertexPosition;\n    // Retrieve the angle between this segment and the previous one (stored in the bitangent w\n    // component).\n    float angle = bitangent.w;\n    // Extrude according to the angle between segments to properly render narrow joints...\n    if (angle != 0.0) {\n        result += uv.y * extrusionWidth * bitangent.xyz / cos(angle / 2.0);\n        uv.x = linePosition + uv.x * extrusionWidth * uv.y * tanHalfAngle;\n    }\n    // ... or extrude in a simple manner for segments that keep the same direction.\n    else {\n        result += uv.y * extrusionWidth * bitangent.xyz + uv.x * extrusionWidth * tangent;\n        uv.x = linePosition + uv.x * extrusionWidth;\n    }\n    uv.y *= extrusionWidth;\n    return result;\n}\n",round_edges_and_add_caps:`\n#define CAPS_NONE ${r.CAPS_NONE}\n#define CAPS_SQUARE ${r.CAPS_SQUARE}\n#define CAPS_ROUND ${r.CAPS_ROUND}\n#define CAPS_TRIANGLE_IN ${r.CAPS_TRIANGLE_IN}\n#define CAPS_TRIANGLE_OUT ${r.CAPS_TRIANGLE_OUT}\n\nfloat roundEdgesAndAddCaps(in vec4 coords, in vec3 range) {\n    // Compute the line's width to length ratio.\n    float widthRatio = range.y / range.x;\n\n    // Compute the inner segment distance (same for all cap mode).\n    float dist = abs(coords.y);\n    float segmentBeginMask = clamp(ceil(coords.z - coords.x), 0.0, 1.0);\n    float segmentEndMask = clamp(ceil(coords.x - coords.w), 0.0, 1.0);\n    dist = max(dist, segmentBeginMask * length(vec2((coords.x - coords.z) / widthRatio, coords.y)));\n    dist = max(dist, segmentEndMask * length(vec2((coords.x - coords.w) / widthRatio, coords.y)));\n\n    #if CAPS_MODE != CAPS_ROUND\n    // Compute the caps mask.\n    float capRangeMask = clamp(1.0 - ceil(range.z - drawRange.y), 0.0, 1.0);\n    float beginCapMask = clamp(ceil(drawRange.x - coords.x), 0.0, 1.0);\n    float endCapMask = clamp(ceil(coords.x - drawRange.y), 0.0, 1.0);\n    float capMask = capRangeMask * max(beginCapMask, endCapMask);\n\n    // Compute the outer segment distance (specific for each cap mode).\n    float capDist = max(coords.x - drawRange.y, drawRange.x - coords.x) / widthRatio;\n    #if CAPS_MODE == CAPS_NONE\n    dist = mix(dist, max(abs(coords.y), (capDist + 0.1) / 0.1), capMask);\n    #elif CAPS_MODE == CAPS_SQUARE\n    dist = mix(dist, max(abs(coords.y), capDist), capMask);\n    #elif CAPS_MODE == CAPS_TRIANGLE_OUT\n    dist = mix(dist, abs(coords.y) + capDist, capMask);\n    #elif CAPS_MODE == CAPS_TRIANGLE_IN\n    dist = mix(dist, max(abs(coords.y), (capDist - abs(coords.y)) + capDist), capMask);\n    #endif\n    #endif // CAPS_MODE != CAPS_ROUND\n\n    return dist;\n}\n`,tile_clip_func:"\nvoid tileClip(vec2 tilePos, vec2 tileSize) {\n    if (tileSize.x > 0.0 && (tilePos.x < -tileSize.x / 2.0 || tilePos.x > tileSize.x / 2.0))\n        discard;\n    if (tileSize.y > 0.0 && (tilePos.y < -tileSize.y / 2.0 || tilePos.y > tileSize.y / 2.0))\n        discard;\n}\n",high_precision_vert_func:"\nvec3 subtractDblEyePos( const in vec3 pos ) {\n    vec3 t1 = positionLow - u_eyepos_lowpart;\n    vec3 e = t1 - positionLow;\n    vec3 t2 = ((-u_eyepos_lowpart - e) + (positionLow - (t1 - e))) + pos - u_eyepos;\n    vec3 high_delta = t1 + t2;\n    vec3 low_delta = t2 - (high_delta - t1);\n    return (high_delta + low_delta);\n}\n"}},5888:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.simpleLightingShadowChunk=void 0,t.simpleLightingShadowChunk="\n    struct PhysicalMaterial {\n        vec3\tdiffuseColor;\n        float\tspecularRoughness;\n        vec3\tspecularColor;\n    };\n\n    #define DEFAULT_SPECULAR_COEFFICIENT 0.04\n\n    void RE_Direct_Physical( const in IncidentLight directLight,\n        const in GeometricContext geometry,\n        const in PhysicalMaterial material,\n        inout ReflectedLight reflectedLight ) {\n        // directLight.color is the light color * shadow, internally three.js uses a step function, so\n        // this value is either the light color or black. in order to lighten up the shadows, we\n        // take add 50% of the color to grey (to give us either pure white or grey) and multiply this to\n        // the material's diffuse color.\n        #if defined(USE_SHADOWMAP)\n            reflectedLight.directDiffuse = (0.5 * directLight.color +\n                vec3(0.5,0.5,0.5)) * material.diffuseColor;\n        #else\n            reflectedLight.directDiffuse = material.diffuseColor;\n        #endif\n    }\n\n    void RE_IndirectDiffuse_Physical( const in vec3 irradiance,\n        const in GeometricContext geometry,\n        const in PhysicalMaterial material,\n        inout ReflectedLight reflectedLight ) {\n            // Disable influence of indirect light (it is handled in the RE_Direct_Physical function)\n    }\n\n    void RE_IndirectSpecular_Physical( const in vec3 radiance,\n        const in vec3 irradiance,\n        const in vec3 clearcoatRadiance,\n        const in GeometricContext geometry,\n        const in PhysicalMaterial material,\n        inout ReflectedLight reflectedLight) {\n            // Disable specular reflection of light.\n    }\n\n    #define RE_Direct               RE_Direct_Physical\n    #define RE_IndirectDiffuse      RE_IndirectDiffuse_Physical\n    #define RE_IndirectSpecular     RE_IndirectSpecular_Physical\n"},1420:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SkyAtmosphereMaterial=t.SkyAtmosphereShader=void 0;const i=r(4428),n=r(3993),o=r(2870),s=r(1703);t.SkyAtmosphereShader={uniforms:{u_eyePositionWorld:new i.Uniform(new i.Vector3),u_lightDirectionWorld:new i.Uniform(new i.Vector3(0,1,0)),u_modelViewProjection:new i.Uniform(new i.Matrix4),u_atmosphereEnv:new i.Uniform(new i.Vector3(6378137,6537590.425,0)),u_hsvCorrection:new i.Uniform(new i.Vector3(0,0,0)),topColor:new i.Uniform(new i.Color(30719)),bottomColor:new i.Uniform(new i.Color(16777215)),offset:new i.Uniform(33),exponent:new i.Uniform(.6),fogColor:new i.Uniform(new i.Color(30719)),fogNear:new i.Uniform(new i.Color(30719)),fogFar:new i.Uniform(new i.Color(16777215))},vertexShader:`\n    precision highp float;\n    precision highp int;\n\n    attribute vec4 position;\n\n    uniform mat4 u_modelViewProjection;\n    uniform vec3 u_eyePositionWorld;\n    uniform vec3 u_lightDirectionWorld;\n\n    uniform vec3 u_atmosphereEnv; // Atmosphere inner and outer radius, camera height\n    uniform vec3 u_hsvCorrection;\n\n    const float Pi = 3.141592653589793;\n    const float Kr = 0.0025;\n    const float Kr4PI = Kr * 4.0 * Pi;\n    const float Km = 0.0015;\n    const float Km4PI = Km * 4.0 * Pi;\n    const float ESun = 15.0; // should be 15.0\n    const float KmESun = Km * ESun;\n    const float KrESun = Kr * ESun;\n    const vec3 InvWavelength = vec3(\n        5.60204474633241,  // Red = 1.0 / Math.pow(0.650, 4.0)\n        9.473284437923038, // Green = 1.0 / Math.pow(0.570, 4.0)\n        19.643802610477206); // Blue = 1.0 / Math.pow(0.475, 4.0)\n\n    const int nSamples = 2;\n    const float fSamples = 2.0;\n\n    varying vec3 v_rayleighColor;\n    varying vec3 v_mieColor;\n    varying vec3 v_vertToCamera;\n\n    ${o.default.atmosphere_vertex_utils}\n\n    //\n    // Computes rayleight and mia atmosphere factors for sky.\n    //\n    // Code based on GPU Gems article.\n    //\n    // Author: Sean O'Neil\n    //\n    // Copyright (c) 2004 Sean O'Neil\n    //\n    // https://developer.nvidia.com/gpugems/gpugems2/part-ii-shading-lighting-and-shadows/chapter-16-accurate-atmospheric-scattering\n    //\n    // Further modifications by HERE\n    //\n    AtmosphereColor computeSkyAtmosphere(vec3 v3Pos, vec3 vLightDir)\n    {\n        // Unpack attributes\n        float fInnerRadius = u_atmosphereEnv.x;\n        float fOuterRadius = u_atmosphereEnv.y;\n        float fCameraHeight = u_atmosphereEnv.z;\n\n        // All that may be const or define(s) at further optimization:\n        float fScale = 1.0 / (fOuterRadius - fInnerRadius);\n        float fScaleOverScaleDepth = (fScale / RayleighScaleDepth);\n        float fCameraHeight2 = fCameraHeight * fCameraHeight;\n        float fOuterRadius2 = fOuterRadius * fOuterRadius;\n\n        // Get the ray from the camera to the vertex and its length (which is the far point of the ray passing through the atmosphere)\n        vec3 v3Ray = v3Pos - u_eyePositionWorld;\n        float fFar = length(v3Ray);\n        v3Ray /= fFar;\n\n    #ifdef CAMERA_IN_SPACE\n\n        // Calculate the closest intersection of the ray with the outer\n        // atmosphere, this is the first point of the ray passing through the atmosphere dome.\n        float fNear = getNearSphereIntersect(u_eyePositionWorld, v3Ray, fCameraHeight2, fOuterRadius2);\n        // Make far relative to first atmosphere intersection\n        fFar -= fNear;\n\n        // Compute the ray's starting position within the atmosphere, then\n        // calculate its scattering offset\n        vec3 v3Start = u_eyePositionWorld + v3Ray * fNear;\n\n        float fStartAngle = dot(v3Ray, v3Start) / fOuterRadius;\n        float fStartDepth = exp(-1.0 / RayleighScaleDepth );\n        float fStartOffset = fStartDepth * scale(fStartAngle);\n\n    #else // CAMERA_IN_ATMOSPHERE\n\n        // The ray starts already in atmosphere\n        vec3 v3Start = u_eyePositionWorld;\n        float height = length(v3Start);\n        float depth = exp(fScaleOverScaleDepth * (fInnerRadius - fCameraHeight));\n        float fStartAngle = dot(v3Ray, v3Start) / height;\n        float fStartOffset = depth * scale(fStartAngle);\n\n    #endif\n\n        // Initialize the scattering loop variables\n        float fSampleLength = fFar / fSamples;\n        float fScaledLength = fSampleLength * fScale;\n        vec3 v3SampleRay = v3Ray * fSampleLength;\n        vec3 v3SamplePoint = v3Start + v3SampleRay * 0.5;\n\n        // Now loop through the sample rays\n        vec3 v3BaseColor = vec3(0.0);\n        vec3 v3Attenuate = vec3(0.0);\n        for(int i=0; i < nSamples; i++)\n        {\n            float height = length(v3SamplePoint);\n            float depth = exp(fScaleOverScaleDepth * (fInnerRadius - height));\n            float fLightAngle = dot(vLightDir, v3SamplePoint) / height;\n            float fCameraAngle = dot(v3Ray, v3SamplePoint) / height;\n            float fScatter = (fStartOffset + depth * (scale(fLightAngle) - scale(fCameraAngle)));\n            v3Attenuate = exp(-fScatter * (InvWavelength * Kr4PI + Km4PI));\n            v3BaseColor += v3Attenuate * (depth * fScaledLength);\n            v3SamplePoint += v3SampleRay;\n        }\n\n        // Scale the Mie and Rayleigh colors and set up output of the function\n        AtmosphereColor color;\n        color.mie = v3BaseColor * KmESun;\n        color.rayleigh = v3BaseColor * (InvWavelength * KrESun);\n        return color;\n    }\n\n    void main(void)\n    {\n        #ifdef DYNAMIC_LIGHT\n            vec3 vLightDir = u_lightDirectionWorld;\n        #else\n            vec3 vLightDir = u_eyePositionWorld;\n        #endif\n        vLightDir = normalize(vLightDir);\n\n        AtmosphereColor atmColor = computeSkyAtmosphere(position.xyz, vLightDir);\n        v_mieColor = atmColor.mie;\n        v_rayleighColor = atmColor.rayleigh;\n        v_vertToCamera = u_eyePositionWorld - position.xyz;\n\n        gl_Position = u_modelViewProjection * position;\n    }\n    `,fragmentShader:`\n    // Because of harsh light distribution the exposure correction is always enabled for the sky.\n    #define CORRECT_EXPOSURE 1\n\n    precision highp float;\n    precision highp int;\n\n    #ifdef CORRECT_COLOR\n    uniform vec3 u_hsvCorrection; // Hue, saturation, brightness\n    #endif\n\n    uniform vec3 u_atmosphereEnv; // Atmosphere inner and outer radius, camera height\n    uniform vec3 u_eyePositionWorld;\n    uniform vec3 u_lightDirectionWorld;\n\n    const float g = -0.95;\n    const float g2 = g * g;\n\n    varying vec3 v_rayleighColor;\n    varying vec3 v_mieColor;\n    varying vec3 v_vertToCamera;\n\n    ${o.default.atmosphere_fragment_utils}\n\n    void main(void)\n    {\n        float fInnerRadius = u_atmosphereEnv.x;\n        float fOuterRadius = u_atmosphereEnv.y;\n        float fCameraHeight = u_atmosphereEnv.z;\n\n        #ifdef DYNAMIC_LIGHT\n            vec3 vLightDir = u_lightDirectionWorld;\n            // Alter alpha based on time of day (0.0 = night , 1.0 = day)\n            float fNightAlpha = clamp(dot(normalize(u_eyePositionWorld), vLightDir), 0.0, 1.0);\n        #else\n            vec3 vLightDir = u_eyePositionWorld;\n            float fNightAlpha = 1.0;\n        #endif\n        vLightDir = normalize(vLightDir);\n\n        // NOTE:\n        // For better precision normalization may be added on fragment (for mobile devices)\n        // while in vertex shader may be left un-normalized\n        // dot(vLightDir, normalize(v_vertToCamera)) / length(v_vertToCamera);\n        float fCosAngle = dot(vLightDir, v_vertToCamera) / length(v_vertToCamera);\n        float fRayleighPhase = 0.75 * (1.0 + fCosAngle * fCosAngle);\n        float fMiePhase = 1.5 * ((1.0 - g2) / (2.0 + g2)) * (1.0 + fCosAngle * fCosAngle) / pow(1.0 + g2 - 2.0 * g * fCosAngle, 1.5);\n\n        vec3 cRgb = fRayleighPhase * v_rayleighColor + fMiePhase * v_mieColor;\n\n        // Sky produces very harsh lighting effect so exposure correction is always enabled.\n    #if !defined(HDR_FRAME_BUFFER) && defined(CORRECT_EXPOSURE)\n        // Exposure factor may be exposed to uniform variable.\n        cRgb = correctExposure(cRgb, 2.0);\n    #endif\n\n    #ifdef CORRECT_COLOR\n        cRgb = correctColor(cRgb, u_hsvCorrection);\n    #endif\n\n        // Alter alpha based on how close the viewer is to the ground (1.0 = on ground, 0.0 = at edge of atmosphere)\n        float fAtmosphereAlpha = clamp((fOuterRadius - fCameraHeight) /\n            (fOuterRadius - fInnerRadius), 0.0, 1.0);\n        fAtmosphereAlpha *= pow(fNightAlpha, 0.5);\n\n        gl_FragColor = vec4(cRgb, mix(cRgb.b, 1.0, fAtmosphereAlpha));\n    }\n    `};class a extends n.RawShaderMaterial{constructor(e){let r;e&&(r={name:"SkyAtmosphereMaterial",vertexShader:t.SkyAtmosphereShader.vertexShader,fragmentShader:t.SkyAtmosphereShader.fragmentShader,uniforms:t.SkyAtmosphereShader.uniforms,transparent:!0,depthTest:!0,depthWrite:!1,side:i.BackSide,blending:i.NormalBlending,fog:!1,rendererCapabilities:e.rendererCapabilities}),super(r)}setDynamicLighting(e){s.setShaderMaterialDefine(this,"DYNAMIC_LIGHT",e)}set outerRadius(e){this.uniforms.u_atmosphereEnv.value.y=e}get outerRadius(){return this.uniforms.u_atmosphereEnv.value.y}set innerRadius(e){this.uniforms.u_atmosphereEnv.value.x=e}get innerRadius(){return this.uniforms.u_atmosphereEnv.value.x}updateUniforms(e,t,r,i){const n=this.getCameraInfo(t,r);if(void 0===e||!e.isMaterial)throw Error("Wrong object used, only Material objects are supported");if(!(e.uniforms&&e.uniforms.u_atmosphereEnv&&e.uniforms.u_hsvCorrection&&e.uniforms.u_eyePositionWorld&&e.uniforms.u_modelViewProjection&&e.uniforms.u_lightDirectionWorld))throw Error("Atmosphere material has missing uniforms");{const t=n.eyePos,r=n.modelViewProjection,o=n.eyeHeight;e.uniforms.u_eyePositionWorld.value.copy(t),e.uniforms.u_modelViewProjection.value.copy(r),e.uniforms.u_atmosphereEnv.value.z=o,e.uniforms.u_lightDirectionWorld.value=i.clone();const a=o>this.outerRadius,l=s.setShaderDefine(e.defines,"CAMERA_IN_SPACE",a),u=s.setShaderDefine(e.defines,"CAMERA_IN_ATMOSPHERE",!a);e.needsUpdate=e.needsUpdate||l||u}}getCameraInfo(e,t,r=!1){if(r){const r=(new i.Matrix4).identity(),n=(new i.Matrix4).copy(e.matrixWorld).invert().transpose(),o=t.projectionMatrix,s=new i.Matrix4;s.multiplyMatrices(n,r),s.multiplyMatrices(o,s);const a=new i.Vector3;e.getWorldPosition(a);const l=new i.Vector3;return t.getWorldPosition(l),{modelViewProjection:s,eyePos:a,eyeHeight:l.distanceTo(a)}}{const r=e.matrixWorld,n=t.matrixWorldInverse,o=t.projectionMatrix,s=new i.Matrix4;s.multiplyMatrices(n,r),s.multiplyMatrices(o,s);const a=new i.Vector3;t.getWorldPosition(a);const l=new i.Vector3;e.getWorldPosition(l);const u=l.distanceTo(a);return a.sub(l),{modelViewProjection:s,eyePos:a,eyeHeight:u}}}}t.SkyAtmosphereMaterial=a},7355:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SolidLineMaterial=t.LineDashesModes=void 0;const i=r(4428),n=r(5722),o=r(3993),s=r(5477),a=r(1703),l={None:s.LineCapsModes.CAPS_NONE,Square:s.LineCapsModes.CAPS_SQUARE,Round:s.LineCapsModes.CAPS_ROUND,TriangleIn:s.LineCapsModes.CAPS_TRIANGLE_IN,TriangleOut:s.LineCapsModes.CAPS_TRIANGLE_OUT},u=Object.keys(l).reduce(((e,t)=>{const r=t;return e[l[r]]=r,e}),{});var c;!function(e){e[e.DASHES_SQUARE=0]="DASHES_SQUARE",e[e.DASHES_ROUND=1]="DASHES_ROUND",e[e.DASHES_DIAMOND=2]="DASHES_DIAMOND"}(c=t.LineDashesModes||(t.LineDashesModes={}));const h={Square:c.DASHES_SQUARE,Round:c.DASHES_ROUND,Diamond:c.DASHES_DIAMOND},d=Object.keys(h).reduce(((e,t)=>{const r=t;return e[h[r]]=r,e}),{}),f=new i.Color,p=`\nprecision highp float;\nprecision highp int;\n\nuniform vec3 diffuse;\nuniform vec3 outlineColor;\nuniform float opacity;\nuniform float extrusionWidth;\nuniform float outlineWidth;\nuniform vec2 tileSize;\nuniform vec2 drawRange;\n\n#ifdef USE_DASHED_LINE\nuniform float dashSize;\nuniform float gapSize;\nuniform vec3 dashColor;\n\n#define DASHES_SQUARE ${c.DASHES_SQUARE}\n#define DASHES_ROUND ${c.DASHES_ROUND}\n#define DASHES_DIAMOND ${c.DASHES_DIAMOND}\n#endif\n\n#ifdef USE_TILE_CLIP\nvarying vec3 vPosition;\n#endif\n\nvarying vec3 vRange;\nvarying vec4 vCoords;\n#ifdef USE_COLOR\nvarying vec3 vColor;\n#endif\n\n#include <round_edges_and_add_caps>\n#include <tile_clip_func>\n\n#ifdef USE_FADING\n#include <fading_pars_fragment>\n#endif\n\n#include <fog_pars_fragment>\n\nvoid main() {\n    float alpha = opacity;\n    vec3 outputDiffuse = diffuse;\n\n    #ifdef USE_TILE_CLIP\n    tileClip(vPosition.xy, tileSize);\n    #endif\n\n    // Calculate distance to center (0.0: lineCenter, 1.0: lineEdge).\n    float distToCenter = roundEdgesAndAddCaps(vCoords, vRange);\n    // Calculate distance to edge (-1.0: lineCenter, 0.0: lineEdge).\n    float distToEdge = distToCenter - (extrusionWidth + outlineWidth) / extrusionWidth;\n\n    // Decrease the line opacity by the distToEdge, making the transition steeper when the slope\n    // of distToChange increases (i.e. the line is further away).\n    float width = fwidth(distToEdge);\n\n    float s = opacity < 0.98\n        ? clamp((distToEdge + width) / (2.0 * width), 0.0, 1.0) // prefer a boxstep\n        : smoothstep(-width, width, distToEdge);\n\n    if (opacity < 0.98 && 1.0 - s < opacity) {\n        // drop the fragment when the line is using opacity.\n        discard;\n    }\n\n    alpha *= 1.0 - s;\n\n    #ifdef USE_DASHED_LINE\n    // Compute the distance to the dash origin (0.0: dashOrigin, 1.0: dashEnd, (d+g)/d: gapEnd).\n    float d = dashSize / vRange.x;\n    float g = gapSize / vRange.x;\n    float distToDashOrigin = mod(vCoords.x, d + g) / d;\n\n    // Compute distance to dash edge (0.5: dashCenter, 0.0: dashEdge) and compute the\n    // dashBlendFactor similarly on how we did it for the line opacity.\n    float distToDashEdge = 0.5 - distance(distToDashOrigin, (d + g) / d * 0.5);\n    #if DASHES_MODE == DASHES_ROUND\n    distToDashEdge = 0.5 - distance(vec2(distToCenter * 0.5, distToDashEdge), vec2(0.0, 0.5));\n    #elif DASHES_MODE == DASHES_DIAMOND\n    distToDashEdge -= distToCenter * 0.5;\n    #endif\n    float dashWidth = fwidth(distToDashEdge);\n    float dashBlendFactor = 1.0 - smoothstep(-dashWidth, dashWidth, distToDashEdge);\n\n    #ifdef USE_DASH_COLOR\n    outputDiffuse = mix(diffuse, dashColor, dashBlendFactor);\n    #endif\n    #endif\n\n    #ifdef USE_OUTLINE\n    // Calculate distance to outline (0.0: lineEdge, outlineWidth/lineWidth: outlineEdge) and\n    // compute the outlineBlendFactor (used to mix line and outline colors).\n    float distToOutline = distToCenter - 1.0;\n    float outlineWidth = fwidth(distToOutline);\n    float outlineBlendFactor = smoothstep(-outlineWidth, outlineWidth, distToOutline);\n\n    // Mix the colors using the different computed factors.\n    #if defined(USE_DASHED_LINE) && !defined(USE_DASH_COLOR)\n    float colorBlendFactor = smoothstep(-1.0, 1.0, dashBlendFactor - outlineBlendFactor);\n    outputDiffuse = mix(\n      mix(\n        mix(outlineColor, diffuse, colorBlendFactor),\n        outputDiffuse,\n        dashBlendFactor\n      ),\n      outlineColor,\n      outlineBlendFactor\n    );\n    #else\n    outputDiffuse = mix(outputDiffuse, outlineColor, outlineBlendFactor);\n    #endif\n    #endif\n\n    #if defined(USE_DASHED_LINE) && !defined(USE_DASH_COLOR)\n    // Multiply the alpha by the dashBlendFactor.\n    #if defined(USE_OUTLINE)\n    alpha *= clamp(dashBlendFactor + outlineBlendFactor, 0.0, 1.0);\n    #else\n    alpha *= 1.0 - dashBlendFactor;\n    #endif\n    #endif\n\n    #ifdef USE_COLOR\n    gl_FragColor = vec4( outputDiffuse * vColor, alpha );\n    #else\n    gl_FragColor = vec4( outputDiffuse, alpha );\n    #endif\n\n    #include <fog_fragment>\n\n    #ifdef USE_FADING\n    #include <fading_fragment>\n    #endif\n}`;class m extends o.RawShaderMaterial{constructor(e){var t;Object.assign(i.ShaderChunk,s.default),n.FadingFeature.patchGlobalShaderChunks();const r={CAPS_MODE:s.LineCapsModes.CAPS_ROUND,DASHES_MODE:c.DASHES_SQUARE};let o,l,u=!0,h=1;e&&(u=!0===e.fog,u&&a.setShaderDefine(r,"USE_FOG",!0),h=void 0!==e.opacity?e.opacity:h,o=e.displacementMap,void 0!==o&&a.setShaderDefine(r,"USE_DISPLACEMENTMAP",!0),void 0!==e.outlineWidth&&e.outlineWidth>0&&a.setShaderDefine(r,"USE_OUTLINE",!0),l={name:"SolidLineMaterial",vertexShader:"\n#define SEGMENT_OFFSET 0.1\n\nattribute vec3 extrusionCoord;\nattribute vec3 position;\nattribute vec4 bitangent;\nattribute vec3 tangent;\nattribute vec2 uv;\nattribute vec3 normal;\n\nuniform mat4 modelViewMatrix;\nuniform mat4 projectionMatrix;\nuniform float extrusionWidth;\nuniform float outlineWidth;\nuniform float offset;\nuniform vec2 drawRange;\n\n#ifdef USE_DISPLACEMENTMAP\nuniform sampler2D displacementMap;\n#endif\n\n#ifdef USE_TILE_CLIP\nvarying vec3 vPosition;\n#endif\nvarying vec3 vRange;\nvarying vec4 vCoords;\n#ifdef USE_COLOR\nattribute vec3 color;\nvarying vec3 vColor;\n#endif\n\n#ifdef USE_FADING\n#include <fading_pars_vertex>\n#endif\n\n#include <fog_pars_vertex>\n\n#include <extrude_line_vert_func>\n\nvoid main() {\n    // Calculate the segment.\n    vec2 segment = abs(extrusionCoord.xy) - SEGMENT_OFFSET;\n    float segmentPos = sign(extrusionCoord.x) / 2.0 + 0.5;\n\n    // Calculate the vertex position inside the line (segment) and extrusion direction and factor.\n    float linePos = mix(segment.x, segment.y, segmentPos);\n    vec2 extrusionDir = sign(extrusionCoord.xy);\n    // Precompute to avoid computing multiple times\n    float tanHalfAngle = tan(bitangent.w / 2.0);\n    float extrusionFactor = extrusionDir.y * tanHalfAngle;\n\n    // Calculate the extruded vertex position (and scale the extrusion direction).\n    vec3 pos = extrudeLine(\n        position, linePos, extrusionWidth + outlineWidth, bitangent, tangent, tanHalfAngle,\n        extrusionDir);\n\n    // Store the normalized extrusion coordinates in vCoords (with their ranges in vRange).\n    vRange = vec3(extrusionCoord.z, extrusionWidth, extrusionFactor);\n    vCoords = vec4(extrusionDir / vRange.xy, segment / vRange.x);\n\n    // Adjust the segment to fit the drawRange.\n    float capDist = (extrusionWidth + outlineWidth) / extrusionCoord.z;\n    if ((vCoords.w + capDist) < drawRange.x || (vCoords.z - capDist) > drawRange.y) {\n        vCoords.zw += 1.0;\n    }\n    if (vCoords.z < drawRange.x) {\n        vCoords.zw += vec2(drawRange.x - vCoords.z, 0.0);\n    }\n    if (vCoords.w > drawRange.y) {\n        vCoords.zw -= vec2(0.0, vCoords.w - drawRange.y);\n    }\n\n    // Transform position.\n    #ifdef USE_DISPLACEMENTMAP\n    pos += normalize( normal ) * texture2D( displacementMap, uv ).x;\n    #endif\n\n    // Shift the line based on the offset, where the bitangent is the cross product of the average\n    // of the two direction vectors (the previous and next segment directions) and the normal of\n    // the line (facing into the sky). The w component is the angle between the two segments.\n    // Note, we need to take the angle into consideration, so we use trigonometry to calculate how\n    // much we need to extend the offset. Note, orthough this looks complicated we are doing this\n    // in the vertex shader, so it should not cause a performance issue.\n    pos += bitangent.xyz * offset * sqrt(1.0 + pow(abs(tanHalfAngle), 2.0));\n\n    vec4 mvPosition = modelViewMatrix * vec4(pos, 1.0);\n    gl_Position = projectionMatrix * mvPosition;\n\n    // Pass extruded position to fragment shader.\n    #ifdef USE_TILE_CLIP\n    vPosition = pos;\n    #endif\n\n    #ifdef USE_COLOR\n    // Pass vertex color to fragment shader.\n    vColor = color;\n    #endif\n\n    #ifdef USE_FADING\n    #include <fading_vertex>\n    #endif\n\n    #include <fog_vertex>\n}",fragmentShader:p,uniforms:i.UniformsUtils.merge([{diffuse:new i.Uniform(new i.Color(m.DEFAULT_COLOR)),dashColor:new i.Uniform(new i.Color(m.DEFAULT_COLOR)),outlineColor:new i.Uniform(new i.Color(m.DEFAULT_COLOR)),extrusionWidth:new i.Uniform(m.DEFAULT_WIDTH),outlineWidth:new i.Uniform(m.DEFAULT_OUTLINE_WIDTH),offset:new i.Uniform(m.DEFAULT_OFFSET),opacity:new i.Uniform(m.DEFAULT_OPACITY),tileSize:new i.Uniform(new i.Vector2),fadeNear:new i.Uniform(n.FadingFeature.DEFAULT_FADE_NEAR),fadeFar:new i.Uniform(n.FadingFeature.DEFAULT_FADE_FAR),displacementMap:new i.Uniform(void 0!==o?o:new i.Texture),drawRange:new i.Uniform(new i.Vector2(m.DEFAULT_DRAW_RANGE_START,m.DEFAULT_DRAW_RANGE_END)),dashSize:new i.Uniform(m.DEFAULT_DASH_SIZE),gapSize:new i.Uniform(m.DEFAULT_GAP_SIZE)},i.UniformsLib.fog]),defines:r,fog:u,opacity:h,rendererCapabilities:e.rendererCapabilities}),super(l),this.fog=u,this.setOpacity(h),this.stencilFunc=i.NotEqualStencilFunc,this.stencilZPass=i.ReplaceStencilOp,this.stencilRef=1,this.stencilWrite=!1,a.enforceBlending(this),this.extensions.derivatives=!0,e&&(void 0!==e.color&&(f.set(e.color),this.color=f),void 0!==e.outlineColor&&(f.set(e.outlineColor),this.outlineColor=f),void 0!==e.lineWidth&&(this.lineWidth=e.lineWidth),void 0!==e.outlineWidth&&(this.outlineWidth=e.outlineWidth),void 0!==e.opacity&&this.setOpacity(e.opacity),void 0!==e.depthTest&&(this.depthTest=e.depthTest),void 0!==e.depthWrite&&(this.depthWrite=e.depthWrite),void 0!==e.fadeNear&&(this.fadeNear=e.fadeNear),void 0!==e.fadeFar&&(this.fadeFar=e.fadeFar),void 0!==e.displacementMap&&(this.displacementMap=e.displacementMap),void 0!==e.caps&&(this.caps=e.caps),void 0!==e.drawRangeStart&&(this.drawRangeStart=e.drawRangeStart),void 0!==e.drawRangeEnd&&(this.drawRangeEnd=e.drawRangeEnd),void 0!==e.dashes&&(this.dashes=e.dashes),void 0!==e.dashColor&&(f.set(e.dashColor),this.dashColor=f),void 0!==e.dashSize&&(this.dashSize=e.dashSize),void 0!==e.gapSize&&(this.gapSize=e.gapSize),void 0!==e.fog&&(this.fog=e.fog,this.invalidateFog()),this.offset=null!==(t=e.offset)&&void 0!==t?t:0)}set offset(e){this.uniforms.offset.value=e}get offset(){return this.uniforms.offset.value}set outline(e){a.setShaderMaterialDefine(this,"USE_OUTLINE",e)}get outline(){return!0===a.getShaderMaterialDefine(this,"USE_OUTLINE")}setOpacity(e){super.setOpacity(e),void 0!==e&&(this.stencilWrite=e<.98)}get color(){return this.uniforms.diffuse.value}set color(e){this.uniforms.diffuse.value.copy(e)}get outlineColor(){return this.uniforms.outlineColor.value}set outlineColor(e){this.uniforms.outlineColor.value.copy(e)}get dashColor(){return this.uniforms.dashColor.value}set dashColor(e){this.uniforms.dashColor.value.copy(e),a.setShaderMaterialDefine(this,"USE_DASH_COLOR",!0)}get lineWidth(){return 2*this.uniforms.extrusionWidth.value}set lineWidth(e){this.uniforms.extrusionWidth.value=e/2}get outlineWidth(){return this.uniforms.outlineWidth.value}set outlineWidth(e){this.uniforms.outlineWidth.value=e,this.outline=e>0}get dashSize(){return this.uniforms.dashSize.value}set dashSize(e){this.uniforms.dashSize.value=e}get gapSize(){return this.uniforms.gapSize.value}set gapSize(e){var t,r;this.uniforms.gapSize.value=e,a.setShaderMaterialDefine(this,"USE_DASHED_LINE",e>0),0===(null===(r=null===(t=this.uniforms)||void 0===t?void 0:t.gapSize)||void 0===r?void 0:r.value)&&(this.stencilWrite=this.opacity<.98)}get caps(){let e="Round";const t=a.getShaderMaterialDefine(this,"CAPS_MODE");return"number"==typeof t&&u.hasOwnProperty(t)&&(e=u[t]),e}set caps(e){l.hasOwnProperty(e)&&a.setShaderMaterialDefine(this,"CAPS_MODE",l[e])}get dashes(){let e="Square";const t=a.getShaderMaterialDefine(this,"DASHES_MODE");return"number"==typeof t&&d.hasOwnProperty(t)&&(e=d[t]),e}set dashes(e){h.hasOwnProperty(e)&&a.setShaderMaterialDefine(this,"DASHES_MODE",h[e])}get fadeNear(){return this.uniforms.fadeNear.value}set fadeNear(e){this.uniforms.fadeNear.value=e}get fadeFar(){return this.uniforms.fadeFar.value}set fadeFar(e){this.uniforms.fadeFar.value=e,a.setShaderMaterialDefine(this,"USE_FADING",e>0)}get displacementMap(){return this.uniforms.displacementMap.value}set displacementMap(e){if(this.uniforms.displacementMap.value===e)return;this.uniforms.displacementMap.value=e;const t=null!==e;t&&(this.uniforms.displacementMap.value.needsUpdate=!0),a.setShaderMaterialDefine(this,"USE_DISPLACEMENTMAP",t)}get drawRangeStart(){return this.uniforms.drawRange.value.x}set drawRangeStart(e){this.uniforms.drawRange.value.x=e}get drawRangeEnd(){return this.uniforms.drawRange.value.y}set drawRangeEnd(e){this.uniforms.drawRange.value.y=e}set clipTileSize(e){this.uniforms.tileSize.value.copy(e);const t=e.x>0&&e.y>0;a.setShaderMaterialDefine(this,"USE_TILE_CLIP",t)}get clipTileSize(){return this.uniforms.tileSize.value}copy(e){return super.copy(e),this.invalidateFog(),this.setOpacity(e.opacity),this}}t.SolidLineMaterial=m,m.DEFAULT_COLOR=16711680,m.DEFAULT_WIDTH=1,m.DEFAULT_OUTLINE_WIDTH=0,m.DEFAULT_OPACITY=1,m.DEFAULT_DRAW_RANGE_START=0,m.DEFAULT_DRAW_RANGE_END=1,m.DEFAULT_DASH_SIZE=1,m.DEFAULT_GAP_SIZE=1,m.DEFAULT_OFFSET=0},1703:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getShaderDefine=t.setShaderDefine=t.getShaderMaterialDefine=t.setShaderMaterialDefine=t.disableBlending=t.enableBlending=t.enforceBlending=t.insertShaderInclude=t.DEFINE_BOOL_FALSE=t.DEFINE_BOOL_TRUE=void 0;const i=r(3333),n=r(4428);function o(e){!0!==e.transparent&&!0!==e.forcedBlending&&(e.blending=n.CustomBlending,!0===e.premultipliedAlpha?(e.blendSrc=n.OneFactor,e.blendDst=n.OneMinusSrcAlphaFactor,e.blendSrcAlpha=n.OneFactor,e.blendDstAlpha=n.OneMinusSrcAlphaFactor):(e.blendSrc=n.SrcAlphaFactor,e.blendDst=n.OneMinusSrcAlphaFactor,e.blendSrcAlpha=n.OneFactor,e.blendDstAlpha=n.OneMinusSrcAlphaFactor))}function s(e,t,r=!1){return void 0===e.defines?r:l(e.defines,t)}function a(e,r,i){let n=!1;return"number"==typeof i?(n=e[r]!==i,e[r]=i):!0===i?(n=e[r]!==t.DEFINE_BOOL_TRUE,e[r]=t.DEFINE_BOOL_TRUE):!1===i&&void 0!==e[r]&&(delete e[r],n=!0),n}function l(e,r){const i=e[r];return i!==t.DEFINE_BOOL_FALSE&&(i===t.DEFINE_BOOL_TRUE||i)}t.DEFINE_BOOL_TRUE="",t.DEFINE_BOOL_FALSE=void 0,t.insertShaderInclude=function(e,t,r,i){const n=!0===i?"\t":"";return e.replace(`#include <${t}>`,`#include <${t}>\n${n}#include <${r}>`)},t.enforceBlending=function(e){e.transparent||(o(e),e.forcedBlending=!0)},t.enableBlending=o,t.disableBlending=function(e){!0!==e.transparent&&!0!==e.forcedBlending&&(e.blending=n.NormalBlending)},t.setShaderMaterialDefine=function(e,t,r){i.assert(void 0!==e.defines,"Do not use this function in ShaderMaterial derived c-tor.");const n=r!==s(e,t);return!!n&&(a(e.defines,t,r),e.needsUpdate=n,!0)},t.getShaderMaterialDefine=s,t.setShaderDefine=a,t.getShaderDefine=l},9930:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.VignetteShader=void 0,t.VignetteShader={uniforms:{tDiffuse:{value:null},offset:{value:1},darkness:{value:1}},vertexShader:"\n        varying vec2 vUv;\n        void main() {\n            vUv = uv;\n            gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n        }",fragmentShader:"\n        uniform float offset;\n        uniform float darkness;\n        uniform sampler2D tDiffuse;\n        varying vec2 vUv;\n        void main() {\n            vec4 texel = texture2D( tDiffuse, vUv );\n            vec2 uv = ( vUv - vec2( 0.5 ) ) * vec2( offset );\n            gl_FragColor = vec4( mix( texel.rgb, vec3( 1.0 - darkness ), dot( uv, uv ) ), texel.a );\n        }"}},9826:function(e,t,r){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,r,i){void 0===i&&(i=r),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,i){void 0===i&&(i=r),e[i]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||i(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),n(r(274),t),n(r(5353),t),n(r(2230),t),n(r(5383),t),n(r(6780),t),n(r(2382),t),n(r(4216),t),n(r(2996),t),n(r(8051),t),n(r(8689),t),n(r(8819),t),n(r(6357),t),n(r(7436),t),n(r(9973),t),n(r(40),t),n(r(5433),t),n(r(2736),t),n(r(6615),t)},2736:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},4216:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},2996:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ContextLogger=void 0,t.ContextLogger=class{constructor(e,t){this.m_logger=e,this.headerMessage=t,this.context=[],this.m_headerLogged=!1,this.warn=this.createLogMethod("warn"),this.info=this.createLogMethod("info"),this.error=this.createLogMethod("error")}pushAttr(e){this.context.push(`${this.context.length>0?".":""}${e}`)}pushIndex(e){this.context.push(`[${e}]`)}pop(){this.context.pop()}createLogMethod(e){return(t,...r)=>{this.m_headerLogged||(this.m_logger.info(this.headerMessage),this.m_headerLogged=!0),this.m_logger[e](`${this.context.join("")}: ${t}`,...r)}}}},40:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.chainCallbacks=void 0,t.chainCallbacks=function(e,t){return function(...r){return e&&e.apply(this,r),t.apply(this,r)}}},6615:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.convertFragmentShaderToWebGL2=t.convertVertexShaderToWebGL2=void 0,t.convertVertexShaderToWebGL2=function(e){return["#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+e},t.convertFragmentShaderToWebGL2=function(e){return["#define varying in","out highp vec4 pc_fragColor;","#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+e}},274:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GroupedPriorityList=t.PriorityListGroup=void 0;class r{constructor(e,t=new Array){this.priority=e,this.elements=t}clone(){return new r(this.priority,this.elements.slice())}remove(e){const t=this.elements.indexOf(e);return-1!==t&&(this.elements.splice(t,1),!0)}}t.PriorityListGroup=r;class i{constructor(){this.groups=new Map}add(e){this.getGroup(e.priority).elements.push(e)}remove(e){const t=this.findGroup(e.priority);return!(void 0===t||!t.remove(e)||(0===t.elements.length&&this.groups.delete(t.priority),0))}clear(){this.groups.clear()}merge(e){for(const t of e.groups){const e=this.findGroup(t[1].priority);void 0!==e?e.elements=e.elements.concat(t[1].elements):this.groups.set(Math.floor(t[1].priority),t[1].clone())}return this}clone(){const e=new i;for(const[t,r]of this.groups)e.groups.set(t,r.clone());return e}forEach(e){for(const t of this.groups)t[1].elements.forEach(e)}count(){let e=0;for(const t of this.groups)e+=t[1].elements.length;return e}findGroup(e){const t=Math.floor(e);return this.groups.get(t)}getGroup(e){let t=this.findGroup(e);if(void 0===t){const i=Math.floor(e);t=new r(i),this.groups.set(t.priority,t)}return t}}t.GroupedPriorityList=i},98:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ConsoleChannel=void 0,t.ConsoleChannel=class{error(e,...t){console.error(e,...t)}debug(e,...t){console.debug(e,...t)}info(e,...t){console.info(e,...t)}log(e,...t){console.log(e,...t)}trace(e,...t){console.trace(e,...t)}warn(e,...t){console.warn(e,...t)}}},9984:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},4789:(e,t)=>{"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.LoggerOptions=t.LogLevel=void 0,(r=t.LogLevel||(t.LogLevel={}))[r.Trace=0]="Trace",r[r.Debug=1]="Debug",r[r.Log=2]="Log",r[r.Info=3]="Info",r[r.Warn=4]="Warn",r[r.Error=5]="Error",r[r.None=6]="None",t.LoggerOptions=class{}},289:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Logger=void 0;const i=r(4789);t.Logger=class{constructor(e,t,r){this.name=e,this.m_channel=t,this.enabled=!0,this.level=i.LogLevel.Trace,void 0!==r&&this.update(r)}error(e,...t){this.enabled&&this.level<=i.LogLevel.Error&&this.m_channel.error(this.prefix,e,...t)}debug(e,...t){this.enabled&&this.level<=i.LogLevel.Debug&&this.m_channel.debug(this.prefix,e,...t)}info(e,...t){this.enabled&&this.level<=i.LogLevel.Info&&this.m_channel.info(this.prefix,e,...t)}log(e,...t){this.enabled&&this.level<=i.LogLevel.Log&&this.m_channel.log(this.prefix,e,...t)}trace(e,...t){this.enabled&&this.level<=i.LogLevel.Trace&&this.m_channel.trace(this.prefix,e,...t)}warn(e,...t){this.enabled&&this.level<=i.LogLevel.Warn&&this.m_channel.warn(this.prefix,e,...t)}update(e){this.enabled=void 0===e.enabled?this.enabled:e.enabled,this.level=void 0===e.level?this.level:e.level}get prefix(){return this.name+":"}}},7857:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LoggerManager=void 0;const i=r(2314);t.LoggerManager=class{static get instance(){return this.m_instance||(this.m_instance=new i.LoggerManagerImpl)}}},2314:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LoggerManagerImpl=void 0;const i=r(98),n=r(289),o=r(9773);t.LoggerManagerImpl=class{constructor(){this.m_loggers=[],this.channel="undefined"==typeof self||void 0!==self.document?new i.ConsoleChannel:new o.WorkerChannel}getLoggerNames(){return this.m_loggers.map((e=>e.name))}getLogger(e){return this.m_loggers.find((t=>t.name===e))}create(e,t={}){void 0!==this.m_levelSetForAll&&(void 0===t.level||t.level<this.m_levelSetForAll)&&(t.level=this.m_levelSetForAll);const r=new n.Logger(e,this.channel,t);return this.m_loggers.push(r),r}dispose(e){const t=this.m_loggers.indexOf(e);if(t<0)throw new Error(`Cannot unregister "${e}" : no such logger registered.`);this.m_loggers.splice(t,1)}updateAll(e){for(const t of this.m_loggers)t.update(e)}update(e,t){for(const r of this.m_loggers)r.name===e&&r.update(t)}enableAll(e){for(const t of this.m_loggers)t.enabled=e}enable(e,t){this.update(e,{enabled:t})}setLogLevelForAll(e){this.m_levelSetForAll=e;for(const t of this.m_loggers)t.level=e}setLogLevel(e,t){this.update(e,{level:t})}setChannel(e){this.channel=e}}},44:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MultiChannel=void 0,t.MultiChannel=class{constructor(...e){this.channels=[],this.channels=e}error(e,...t){for(const r of this.channels)r.error(e,...t)}debug(e,...t){for(const r of this.channels)r.debug(e,...t)}info(e,...t){for(const r of this.channels)r.info(e,...t)}log(e,...t){for(const r of this.channels)r.log(e,...t)}trace(e,...t){for(const r of this.channels)r.trace(e,...t)}warn(e,...t){for(const r of this.channels)r.warn(e,...t)}}},9773:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WorkerChannel=t.WORKERCHANNEL_MSG_TYPE=void 0;const i=r(4789);t.WORKERCHANNEL_MSG_TYPE="worker-channel-message",t.WorkerChannel=class{error(e,...r){const n={message:[e,...r],type:t.WORKERCHANNEL_MSG_TYPE,level:i.LogLevel.Error};self.postMessage(n)}debug(e,...r){const n={message:[e,...r],type:t.WORKERCHANNEL_MSG_TYPE,level:i.LogLevel.Debug};self.postMessage(n)}info(e,...r){const n={message:[e,...r],type:t.WORKERCHANNEL_MSG_TYPE,level:i.LogLevel.Info};self.postMessage(n)}log(e,...r){const n={message:[e,...r],type:t.WORKERCHANNEL_MSG_TYPE,level:i.LogLevel.Log};self.postMessage(n)}trace(e,...r){const n={message:[e,...r],type:t.WORKERCHANNEL_MSG_TYPE,level:i.LogLevel.Trace};self.postMessage(n)}warn(e,...r){const n={message:[e,...r],type:t.WORKERCHANNEL_MSG_TYPE,level:i.LogLevel.Warn};self.postMessage(n)}}},5353:function(e,t,r){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,r,i){void 0===i&&(i=r),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,i){void 0===i&&(i=r),e[i]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||i(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),n(r(98),t),n(r(9984),t),n(r(4789),t),n(r(289),t),n(r(7857),t),n(r(44),t),n(r(9773),t)},2230:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Math2D=void 0,function(e){function t(e,t,r,i){return(e-r)*(e-r)+(t-i)*(t-i)}e.Box=class{constructor(e=0,t=0,r=0,i=0){this.x=e,this.y=t,this.w=r,this.h=i}set(e,t,r,i){this.x=e,this.y=t,this.w=r,this.h=i}copy(e){this.x=e.x,this.y=e.y,this.w=e.w,this.h=e.h}contains(e,t){return this.x<=e&&this.x+this.w>=e&&this.y<=t&&this.y+this.h>=t}containsBox(e){const t=e.x+e.w,r=e.y+e.h;return this.contains(e.x,e.y)&&this.contains(t,e.y)&&this.contains(e.x,r)&&this.contains(t,r)}intersects(e){return this.x<=e.x+e.w&&this.x+this.w>=e.x&&this.y<=e.y+e.h&&this.y+this.h>=e.y}},e.distSquared=t,e.computeSquaredLineLength=function(e){let t=0;const r=e.length-4;for(let i=0;i<r;i+=3){const r=e[i+3]-e[i],n=e[i+4]-e[i+1];t+=r*r+n*n}return t},e.distToSegmentSquared=function(e,r,i,n,o,s){const a=t(i,n,o,s);if(0===a)return t(e,r,i,n);let l=((e-i)*(o-i)+(r-n)*(s-n))/a;return l=Math.max(0,Math.min(1,l)),t(e,r,i+l*(o-i),n+l*(s-n))},e.intersectLineAndCircle=function(e,t,r,i,n,o=0,s=0){const a=r-e,l=i-t,u=a*a+l*l,c=e*i-r*t-l*o+a*s,h=n*n*u-c*c;if(h<-1e-10)return;const d=c*l,f=-c*a;if(h<1e-10)return{x1:o+d/u,y1:s+f/u};const p=Math.sqrt(h),m=(l<0?-1:1)*a*p,g=Math.abs(l)*p;return{x1:o+(d+m)/u,y1:s+(f+g)/u,x2:o+(d-m)/u,y2:s+(f-g)/u}},e.intersectLines=function(e,t,r,i,n,o,s,a,l={x:0,y:0}){const u=(e-r)*(o-a)-(t-i)*(n-s);if(0===u)return;const c=((e*i-t*r)*(n-s)-(e-r)*(n*a-o*s))/u,h=((e*i-t*r)*(o-a)-(t-i)*(n*a-o*s))/u;return l.x=c,l.y=h,l}}(t.Math2D||(t.Math2D={}))},5383:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MathUtils=void 0,function(e){function t(e,t,r){return e<t?t:e>r?r:e}e.clamp=t,e.smoothStep=function(e,r,i){return(i=t((i-e)/(r-e),0,1))*i*(3-2*i)},e.smootherStep=function(e,r,i){return(i=t((i-e)/(r-e),0,1))*i*i*(i*(6*i-15)+10)},e.map=function(e,t,r,i,n){return(e-t)*(n-i)/(r-t)+i},e.min2=function(e,t){let r;return void 0!==e&&(r=e),void 0!==t&&(r=void 0===r?t:Math.min(r,t)),r},e.max2=function(e,t){let r;return void 0!==e&&(r=e),void 0!==t&&(r=void 0===r?t:Math.max(r,t)),r},e.isClamped=function(e,t,r){return!(void 0!==t&&e<t||void 0!==r&&e>r)},e.easeInOutCubic=function(e,t,r){return e+(t-e)*(r<.5?4*r*r*r:(r-1)*(2*r-2)*(2*r-2)+1)}}(t.MathUtils||(t.MathUtils={}))},6780:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.applyMixinsWithoutProperties=t.applyMixins=void 0,t.applyMixins=function(e,t){t.forEach((t=>{Object.getOwnPropertyNames(t.prototype).forEach((r=>{e.prototype[r]=t.prototype[r]}))}))},t.applyMixinsWithoutProperties=function(e,t){t.forEach((t=>{Object.getOwnPropertyNames(t.prototype).forEach((r=>{const i=Object.getOwnPropertyDescriptor(t.prototype,r);void 0!==i&&void 0===i.get&&"constructor"!==r&&(e.prototype[r]=t.prototype[r])}))}))}},8689:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.pick=t.cloneDeep=void 0,t.cloneDeep=function(e){const t=new Map,r=function e(r){if(null===r)return null;if("object"==typeof r){const i=t.get(r);if(void 0!==i)return i;if(Array.isArray(r)){const i=[];t.set(r,i),i.length=r.length;for(let t=0;t<i.length;++t)i[t]=e(r[t]);return i}if(r instanceof Date){const e=new Date(r.getTime());return t.set(r,e),e}if(r instanceof RegExp){const e=new RegExp(r.source,r.flags);return t.set(r,e),e}if(r.constructor!==Object)throw new Error("cloneDeep doesn't support objects with custom prototypes");{const i={};t.set(r,i);for(const t in r)r.hasOwnProperty(t)&&(i[t]=e(r[t]));return i}}return r}(e);return t.clear(),r},t.pick=function(e,t){const r={};for(const i of t)e.hasOwnProperty(i)&&(r[i]=e[i]);return r}},8819:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getOptionValue=void 0,t.getOptionValue=function(...e){for(const t of e)if(null!=t)return t}},8051:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PerformanceTimer=void 0;class r{static now(){return r.nowFunc()}static getNowFunc(){return"undefined"!=typeof performance&&void 0!==performance.now?()=>performance.now():()=>(new Date).getTime()}}t.PerformanceTimer=r,r.instance=new r,r.nowFunc=r.getNowFunc()},5433:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.sampleBilinear=void 0,t.sampleBilinear=function(e,t,r,i,n){const o=t-1,s=r-1,a=i*o,l=Math.floor(a),u=n*s,c=Math.floor(u),h=c*t+l,d=l<o?h+1:h,f=c<s?h+t:h,p=l<o?f+1:f,m=e[h],g=e[d],v=e[f],y=e[p],x=Number.isInteger(a)?0:a-l,_=1-x,b=Number.isInteger(u)?0:u-c,w=1-b;return m*_*w+g*x*w+v*_*b+y*x*b}},6357:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TaskQueue=void 0,t.TaskQueue=class{constructor(e){var t;this.m_options=e,this.m_taskLists=new Map,null===(t=this.m_options.groups)||void 0===t||t.forEach((e=>{this.m_taskLists.set(e,[])})),this.m_options.prioSortFn&&(this.sort=this.m_options.prioSortFn)}update(e){if(void 0===e)this.m_taskLists.forEach((e=>{this.updateTaskList(e)}));else{const t=this.getTaskList(e);t&&this.updateTaskList(t)}}add(e){var t;if(this.m_taskLists.has(e.group)){const r=this.m_taskLists.get(e.group);if(!(null==r?void 0:r.includes(e)))return null===(t=this.m_taskLists.get(e.group))||void 0===t||t.push(e),!0}return!1}remove(e){var t,r;if(this.m_taskLists.has(e.group)){const i=null===(t=this.m_taskLists.get(e.group))||void 0===t?void 0:t.indexOf(e);if(-1!==i)return null===(r=this.m_taskLists.get(e.group))||void 0===r||r.splice(i,1),!0}return!1}numItemsLeft(e){var t,r;let i=0;return void 0===e?this.m_taskLists.forEach((e=>{i+=e.length})):i+=null!==(r=null===(t=this.getTaskList(e))||void 0===t?void 0:t.length)&&void 0!==r?r:0,i}processNext(e,t,r=1){if(!this.getTaskList(e)||this.numItemsLeft(e)<=0)return!1;for(let i=0;i<r&&this.numItemsLeft(e)>0;i++){const r=this.pull(e,!0);void 0!==r&&(!t||(null==t?void 0:t(r))?r.execute():this.add(r))}return!0}clear(){this.m_taskLists.clear()}pull(e,t=!1){var r,i;let n;return this.getTaskList(e)&&(n=null===(r=this.getTaskList(e))||void 0===r?void 0:r.pop(),t&&n&&(null===(i=n.isExpired)||void 0===i?void 0:i.call(n)))?this.pull(e,t):n}sort(e,t){return t.getPriority()-e.getPriority()}getTaskList(e){return this.m_taskLists.get(e)}updateTaskList(e){var t;for(let r=0;r<e.length;r++){const i=e[r];(null===(t=null==i?void 0:i.isExpired)||void 0===t?void 0:t.call(i))&&(e.splice(r,1),r--)}e.sort(this.sort)}}},7436:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.composeUriResolvers=t.RelativeUriResolver=t.PrefixMapUriResolver=void 0;const i=r(9973);t.PrefixMapUriResolver=class{constructor(e){this.definitions=e}resolveUri(e){return Object.keys(this.definitions).reduce(((e,t)=>t.endsWith("/")&&e.startsWith(t)?this.definitions[t]+e.substr(t.length):e===t?this.definitions[t]:e),e)}},t.RelativeUriResolver=class{constructor(e){this.parentUri=e}resolveUri(e){return i.resolveReferenceUri(this.parentUri,e)}},t.composeUriResolvers=function(...e){return{resolveUri:t=>e.reduce(((e,t)=>void 0!==t?t.resolveUri(e):e),t)}}},1060:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getAppBaseUrl=void 0;const i=r(9973);t.getAppBaseUrl=function(){return"undefined"==typeof window?`file://${process.cwd()}/`:i.baseUrl(window.location.href)}},9973:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getUrlHostAndProtocol=t.getUrlOrigin=t.baseUrl=t.resolveReferenceUri=void 0,t.resolveReferenceUri=function(e,t){return r.test(t)?t:t.startsWith("/")?n(e)+t:(t.startsWith("./")&&(t=t.substr(2)),i(e)+t)};const r=new RegExp("^(((?:[a-z]+:)?//)|(file:/)|(data:))","i");function i(e){if(void 0===e)return"./";let t=e.indexOf("#");return-1!==t&&(e=e.slice(0,t)),t=e.indexOf("?"),-1!==t&&(e=e.slice(0,t)),t=e.lastIndexOf("/"),-1===t?"./":e.substring(0,t+1)}function n(e){if(void 0===e)return"";const t=o(e);return"file:"===t.protocol?"file://":t.host&&t.protocol?t.protocol+"//"+t.host:t.host?"//"+t.host:t.protocol?t.protocol+"//":""}function o(e){const t=new RegExp(/^(?:([a-z]+:))?\/\/([^\/]*)/,"i"),r=e.match(t);if(!r)throw new Error(`getUrlHostAndProtocol: unable to parse URL '${e}'`);return{protocol:r[1],host:r[2]}}t.baseUrl=i,t.getUrlOrigin=n,t.getUrlHostAndProtocol=o},2382:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.assertExists=t.assert=void 0,t.assert=function(e,t){},t.assertExists=function(e,t){return e}},4607:function(e,t,r){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,r,i){void 0===i&&(i=r),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,i){void 0===i&&(i=r),e[i]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||i(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),n(r(976),t),n(r(4050),t),n(r(1173),t),n(r(6506),t)},6506:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},7707:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DecodeInfo=void 0;const i=r(3139),n=r(4428);t.DecodeInfo=class{constructor(e,t,r=0){this.targetProjection=e,this.tileKey=t,this.storageLevelOffset=r,this.projectedBoundingBox=new i.OrientedBox3,this.tileBounds=new n.Box3,this.tileSize=new n.Vector3,this.center=new n.Vector3,this.geoBox=this.tilingScheme.getGeoBox(t),this.targetProjection.projectBox(this.geoBox,this.projectedBoundingBox),this.projectedBoundingBox.getCenter(this.center),this.tilingScheme.getWorldBox(t,this.tileBounds),this.tileBounds.getSize(this.tileSize),this.tileSizeOnScreen=256*Math.pow(2,-this.storageLevelOffset),this.columnCount=i.webMercatorTilingScheme.subdivisionScheme.getLevelDimensionX(this.tileKey.level),this.rowCount=i.webMercatorTilingScheme.subdivisionScheme.getLevelDimensionY(this.tileKey.level)}get tilingScheme(){return i.webMercatorTilingScheme}get sourceProjection(){return this.tilingScheme.projection}}},4050:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GeoJsonTilerService=void 0;const i=r(2851),n=r(1173);t.GeoJsonTilerService=class{static start(){i.WorkerServiceManager.getInstance().register({serviceType:n.GEOJSON_TILER_SERVICE_TYPE,factory:e=>i.TilerService.start(e)})}}},1047:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OmvGenericFeatureModifier=t.ComposedDataFilter=t.OmvGenericFeatureFilter=t.OmvFeatureFilterDescriptionBuilder=void 0;const i=r(3187),n=r(1173);t.OmvFeatureFilterDescriptionBuilder=class{constructor(e){this.m_processLayersDefault=!0,this.m_processPointsDefault=!0,this.m_processLinesDefault=!0,this.m_processPolygonsDefault=!0,this.m_layersToProcess=new Array,this.m_layersToIgnore=new Array,this.m_pointsToProcess=new Array,this.m_ignoredPoints=new Array,this.m_linesToProcess=new Array,this.m_linesToIgnore=new Array,this.m_polygonsToProcess=new Array,this.m_polygonsToIgnore=new Array,this.m_kindsToProcess=[],this.m_kindsToIgnore=[],e&&(this.m_processLayersDefault=void 0===e.processLayersDefault||e.processLayersDefault,this.m_processPointsDefault=void 0===e.processPointsDefault||e.processPointsDefault,this.m_processLinesDefault=void 0===e.processLinesDefault||e.processLinesDefault,this.m_processPolygonsDefault=void 0===e.processPolygonsDefault||e.processPolygonsDefault)}processLayer(e,t=n.OmvFilterString.StringMatch.Match,r=0,i=1/0){this.m_layersToProcess.push({name:{value:e,match:t},minLevel:r,maxLevel:i})}ignoreLayer(e,t=n.OmvFilterString.StringMatch.Match,r=0,i=1/0){this.m_layersToIgnore.push({name:{value:e,match:t},minLevel:r,maxLevel:i})}processPoint(e){this.addItem(this.m_pointsToProcess,e)}processPoints(e){this.addItems(this.m_pointsToProcess,e)}ignorePoint(e){this.addItem(this.m_ignoredPoints,e)}ignorePoints(e){this.addItems(this.m_ignoredPoints,e)}processLine(e){this.addItem(this.m_linesToProcess,e)}processLines(e){this.addItems(this.m_linesToProcess,e)}ignoreLine(e){this.addItem(this.m_linesToIgnore,e)}ignoreLines(e){this.addItems(this.m_linesToIgnore,e)}processPolygon(e){this.addItem(this.m_polygonsToProcess,e)}processPolygons(e){this.addItems(this.m_polygonsToProcess,e)}ignorePolygon(e){this.addItem(this.m_polygonsToIgnore,e)}ignorePolygons(e){this.addItems(this.m_polygonsToIgnore,e)}processKinds(e){this.m_kindsToProcess=this.m_kindsToProcess.concat(e)}ignoreKinds(e){this.m_kindsToIgnore=this.m_kindsToIgnore.concat(e)}createDescription(){return{processLayersDefault:this.m_processLayersDefault,processPointsDefault:this.m_processPointsDefault,processLinesDefault:this.m_processLinesDefault,processPolygonsDefault:this.m_processPolygonsDefault,layersToProcess:this.m_layersToProcess,layersToIgnore:this.m_layersToIgnore,pointsToProcess:this.m_pointsToProcess,pointsToIgnore:this.m_ignoredPoints,linesToProcess:this.m_linesToProcess,linesToIgnore:this.m_linesToIgnore,polygonsToProcess:this.m_polygonsToProcess,polygonsToIgnore:this.m_polygonsToIgnore,kindsToProcess:this.m_kindsToProcess,kindsToIgnore:this.m_kindsToIgnore}}addItem(e,t){(void 0===t.minLevel||isNaN(t.minLevel))&&(t.minLevel=0),(void 0===t.maxLevel||isNaN(t.maxLevel))&&(t.maxLevel=1/0);const r={layerName:{value:t.layer,match:void 0===t.matchLayer?n.OmvFilterString.StringMatch.Match:t.matchLayer},geometryTypes:void 0!==t.geomType?Array.isArray(t.geomType)?t.geomType:[t.geomType]:void 0,classes:[{value:t.featureClass,match:void 0===t.matchClass?n.OmvFilterString.StringMatch.Match:t.matchClass}],minLevel:t.minLevel,maxLevel:t.maxLevel,featureAttribute:t.featureAttribute};e.push(r)}addItems(e,t){(void 0===t.minLevel||isNaN(t.minLevel))&&(t.minLevel=0),(void 0===t.maxLevel||isNaN(t.maxLevel))&&(t.maxLevel=1/0);const r={layerName:{value:t.layer,match:void 0===t.matchLayer?n.OmvFilterString.StringMatch.Match:t.matchLayer},geometryTypes:void 0!==t.geomTypes?Array.isArray(t.geomTypes)?t.geomTypes:[t.geomTypes]:void 0,classes:t.featureClasses,minLevel:t.minLevel,maxLevel:t.maxLevel,featureAttribute:t.featureAttribute};e.push(r)}};class o{constructor(e){this.description=e,this.description.kindsToProcess.length>0&&(this.enabledKinds=new i.GeometryKindSet(this.description.kindsToProcess)),this.description.kindsToIgnore.length>0&&(this.disabledKinds=new i.GeometryKindSet(this.description.kindsToIgnore))}static matchLayer(e,t,r){for(const i of t)if(!(r<i.minLevel||r>i.maxLevel)&&n.OmvFilterString.matchString(e,i.name))return!0;return!1}wantsLayer(e,t){return!!o.matchLayer(e,this.description.layersToProcess,t)||!o.matchLayer(e,this.description.layersToIgnore,t)&&this.description.processLayersDefault}wantsPointFeature(e,t,r){return this.wantsFeature(this.description.pointsToProcess,this.description.pointsToIgnore,e,t,r,this.description.processPointsDefault)}wantsLineFeature(e,t,r){return this.wantsFeature(this.description.linesToProcess,this.description.linesToIgnore,e,t,r,this.description.processLinesDefault)}wantsPolygonFeature(e,t,r){return this.wantsFeature(this.description.polygonsToProcess,this.description.polygonsToIgnore,e,t,r,this.description.processPolygonsDefault)}wantsKind(e){return void 0===e||!(void 0!==this.disabledKinds&&this.disabledKinds.hasOrIntersects(e))||void 0!==this.enabledKinds&&this.enabledKinds.hasOrIntersects(e)}get hasKindFilter(){return void 0!==this.enabledKinds||void 0!==this.disabledKinds}wantsFeature(e,t,r,i,o,s){for(const t of e)if(!(o<t.minLevel||o>t.maxLevel)&&n.OmvFilterString.matchString(r,t.layerName)&&void 0!==t.geometryTypes&&t.geometryTypes.includes(i))return!0;for(const e of t)if(n.OmvFilterString.matchString(r,e.layerName)&&void 0!==e.geometryTypes&&e.geometryTypes.includes(i))return!1;return s}}t.OmvGenericFeatureFilter=o,t.ComposedDataFilter=class{constructor(e){this.filters=e}get hasKindFilter(){return this.filters.reduce(((e,t)=>e||t.hasKindFilter),!0)}wantsLayer(e,t){return this.filters.reduce(((r,i)=>r&&i.wantsLayer(e,t)),!0)}wantsPointFeature(e,t,r){return this.filters.reduce(((i,n)=>i&&n.wantsPointFeature(e,t,r)),!0)}wantsLineFeature(e,t,r){return this.filters.reduce(((i,n)=>i&&n.wantsLineFeature(e,t,r)),!0)}wantsPolygonFeature(e,t,r){return this.filters.reduce(((i,n)=>i&&n.wantsPolygonFeature(e,t,r)),!0)}wantsKind(e){return this.filters.reduce(((t,r)=>t&&r.wantsKind(e)),!0)}};class s{constructor(e){this.description=e}static matchItems(e,t,r){for(const i of r)if(void 0!==i.classes){if(!n.OmvFilterString.matchString(e,i.layerName))continue;for(const e of i.classes)if(n.OmvFilterString.matchString(t,e))return!0}return!1}static matchAttribute(e,t,r){for(const i of r)if(void 0!==i.featureAttribute&&n.OmvFilterString.matchString(e,i.layerName)&&t.lookup(i.featureAttribute.key)===i.featureAttribute.value)return!0;return!1}doProcessPointFeature(e,t){return this.doProcessFeature(this.description.pointsToProcess,this.description.pointsToIgnore,e,t,this.description.processPointsDefault)}doProcessLineFeature(e,t){return this.doProcessFeature(this.description.linesToProcess,this.description.linesToIgnore,e,t,this.description.processLinesDefault)}doProcessPolygonFeature(e,t){return this.doProcessFeature(this.description.polygonsToProcess,this.description.polygonsToIgnore,e,t,this.description.processPolygonsDefault)}doProcessFeature(e,t,r,i,n){if(void 0===r||0===e.length&&0===t.length)return n;let o;const a=i.lookup("class");return null!=a&&(o=a.toString()),!(!o||!s.matchItems(r,o,e))||(!o||!s.matchItems(r,o,t))&&(!!s.matchAttribute(r,i,e)||!s.matchAttribute(r,i,t)&&n)}}t.OmvGenericFeatureModifier=s},1173:(e,t)=>{"use strict";var r,i;Object.defineProperty(t,"__esModule",{value:!0}),t.GEOJSON_TILER_SERVICE_TYPE=t.VECTOR_TILE_DECODER_SERVICE_TYPE=t.OmvGeometryType=t.OmvFilterString=t.FeatureModifierId=void 0,(i=t.FeatureModifierId||(t.FeatureModifierId={}))[i.default=0]="default",function(e){let t;!function(e){e[e.Any=0]="Any",e[e.Match=1]="Match",e[e.StartsWith=2]="StartsWith",e[e.Contains=3]="Contains",e[e.EndsWith=4]="EndsWith"}(t=e.StringMatch||(e.StringMatch={})),e.matchString=function(t,r){switch(r.match){case e.StringMatch.Any:return!0;case e.StringMatch.Match:return t===r.value;case e.StringMatch.StartsWith:return r.value.startsWith(t);case e.StringMatch.EndsWith:return r.value.endsWith(t);default:return t.includes(r.value)}}}(t.OmvFilterString||(t.OmvFilterString={})),(r=t.OmvGeometryType||(t.OmvGeometryType={}))[r.UNKNOWN=0]="UNKNOWN",r[r.POINT=1]="POINT",r[r.LINESTRING=2]="LINESTRING",r[r.POLYGON=3]="POLYGON",t.VECTOR_TILE_DECODER_SERVICE_TYPE="vector-tile-decoder",t.GEOJSON_TILER_SERVICE_TYPE="geojson-tiler"},1834:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OmvPoliticalViewFeatureModifier=void 0;const i=r(3333).LoggerManager.instance.create("OmvPoliticalViewFeatureModifier");t.OmvPoliticalViewFeatureModifier=class{constructor(e){this.m_countryCode=e}doProcessPointFeature(e,t,r){return!0}doProcessLineFeature(e,t,r){return this.rewriteEnvironment(e,t),!0}doProcessPolygonFeature(e,t,r){return!0}rewriteEnvironment(e,t){this.isPoliticalViewLayer(e)&&this.updateEnvironment(t,this.m_countryCode,"kind")}updateEnvironment(e,t,r){const i=this.getAlternativePov(e,t,r);void 0!==i&&(e.entries[r]=i)}getAlternativePov(e,t,r){i.log("Get alternate POV: ",JSON.stringify(e));const n=t,o=e.lookup(`${r}:${n}`);return i.log("Lookup POV: ",`${r}:${n}`,o),"string"==typeof o&&o.length>0?(i.log("Found POV: ",`${r}:${n}`,o),o):void 0}isPoliticalViewLayer(e){return"boundaries"===e}}},8544:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.webMercatorTile2TargetTile=t.webMercatorTile2TargetWorld=t.world2tile=t.tile2world=t.createWorldTileTransformationCookie=t.tile2lat=t.lat2tile=t.isArrayBufferLike=void 0;const i=r(3139),n=r(4428);function o(e,t){return Math.round((1-Math.log(Math.tan(e*Math.PI/180)+1/Math.cos(e*Math.PI/180))/Math.PI)/2*Math.pow(2,t))}function s(e,t){const{north:r,west:i}=t.geoBox,n=Math.log2(e),s=Math.pow(2,t.tileKey.level+n);return{extents:e,scale:s,top:o(r,t.tileKey.level+n),left:Math.round((i+180)/360*s)}}function a(e,t,r,n=!1,o){void 0!==t.worldTileProjectionCookie&&t.worldTileProjectionCookie.extents===e||(t.worldTileProjectionCookie=s(e,t));const{top:a,left:l,scale:u}=t.worldTileProjectionCookie,c=i.EarthConstants.EQUATORIAL_CIRCUMFERENCE;return o.x=(l+r.x)/u*c,o.y=(a+(n?-r.y:r.y))/u*c,o.z=i.isVector3Like(r)?r.z:0,o}function l(e,t,r,o,s,l=!1){a(e,t,r,l,o),t.targetProjection.reprojectPoint(i.webMercatorProjection,o,o),r instanceof n.Vector3&&s&&(o.z*=t.targetProjection.getScaleFactor(o))}t.isArrayBufferLike=function(e){return"undefined"!=typeof SharedArrayBuffer?e instanceof ArrayBuffer||e instanceof SharedArrayBuffer:e instanceof ArrayBuffer},t.lat2tile=o,t.tile2lat=function(e,t){const r=Math.PI-2*Math.PI*e/Math.pow(2,t);return 180/Math.PI*Math.atan(.5*(Math.exp(r)-Math.exp(-r)))},t.createWorldTileTransformationCookie=s,t.tile2world=a,t.world2tile=function(e,t,r,n=!1,o){void 0!==t.worldTileProjectionCookie&&t.worldTileProjectionCookie.extents===e||(t.worldTileProjectionCookie=s(e,t));const{top:a,left:l,scale:u}=t.worldTileProjectionCookie,c=i.EarthConstants.EQUATORIAL_CIRCUMFERENCE;return o.x=Math.round(r.x/c*u-l),o.y=Math.round((n?-1:1)*(r.y/c*u-a)),i.isVector3Like(o)&&(o.z=r.z),o},t.webMercatorTile2TargetWorld=l,t.webMercatorTile2TargetTile=function(e,t,r,i,n,o=!1){l(e,t,r,i,n,o),i.sub(t.center)}},1892:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Ring=void 0;const i=r(4428);t.Ring=class{constructor(e,t,r=4096,n=!1){if(this.points=e,this.textureCoords=t,this.extents=r,this.hasClipInfo=n,void 0!==t&&t.length!==e.length)throw new Error("the array of texture coordinates must have the same number of elements of the array of points");this.vertexStride=2,void 0!==t&&(this.vertexStride=this.vertexStride+2),this.area=i.ShapeUtils.area(this.points),this.winding=this.area<0}toArray(e=[],t=0){var r;return this.points.forEach(((r,i)=>r.toArray(e,t+this.vertexStride*i))),null===(r=this.textureCoords)||void 0===r||r.forEach(((r,i)=>r.toArray(e,t+this.vertexStride*i+2))),e}isProperEdge(e){const t=this.extents,r=(e+1)%this.points.length,i=this.points[e],n=this.points[r];if(this.hasClipInfo){if(i.x!==n.x&&i.y!==n.y)return!0;if(i.x%this.extents!=0&&i.y%this.extents!=0)return!0;if(n.x%this.extents!=0&&n.y%this.extents!=0)return!0;const e=!0===i.isClipped,t=!0===n.isClipped;return!e&&!t}return!(i.x<=0&&n.x<=0||i.x>=t&&n.x>=t||i.y<=0&&n.y<=0||i.y>=t&&n.y>=t)}}},4312:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StyleSetDataFilter=void 0,t.StyleSetDataFilter=class{constructor(e){this.styleSetEvaluator=e,this.hasKindFilter=!1}wantsLayer(e,t){return this.styleSetEvaluator.wantsLayer(e)}wantsPointFeature(e){return this.styleSetEvaluator.wantsFeature(e,"point")}wantsLineFeature(e){return this.styleSetEvaluator.wantsFeature(e,"line")}wantsPolygonFeature(e){return this.styleSetEvaluator.wantsFeature(e,"polygon")}wantsKind(){return!0}}},8640:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.VectorTileDataEmitter=void 0;const i=r(3187),n=r(3024),o=r(2635),s=r(7771),a=r(7478),l=r(3139),u=r(6155),c=r(8655),h=r(8136),d=r(3333),f=r(9502),p=r(4428),m=r(8544),g=r(1892),v=d.LoggerManager.instance.create("OmvDecodedTileEmitter"),y=new p.Vector3,x=new p.Vector3,_=new p.Vector3,b=new p.Vector3,w=new p.Vector2,E=new p.Vector2,S=new p.Vector3,M=new p.Vector3,T=new p.Vector3,P=new p.Vector2,A=new p.Vector2,L=new p.Vector2,C=new p.Vector3,O=new p.Vector3,R=new p.Vector3,D=new p.Vector3,I=new p.Vector3,F=new p.Line3,N=Math.PI/8;function U(e,t,r="index"){const i=t>65535?"uint32":"uint16";return{itemCount:1,name:r,buffer:("uint32"===i?new Uint32Array(e):new Uint16Array(e)).buffer,type:i}}class j{constructor(e){this.type=e,this.positions=[],this.normals=[],this.textureCoordinates=[],this.colors=[],this.extrusionAxis=[],this.indices=[],this.edgeIndices=[],this.groups=[],this.texts=[],this.pathLengths=[],this.stringCatalog=[],this.imageTextures=[],this.featureStarts=[],this.edgeFeatureStarts=[],this.objInfos=[],this.offsetDirections=[]}addText(e){let t=this.stringCatalog.indexOf(e);return t<0&&(t=this.stringCatalog.length,this.stringCatalog.push(e)),t}}var k;!function(e){e[e.Simple=0]="Simple",e[e.Complex=1]="Complex"}(k||(k={}));const z=new p.Color;t.VectorTileDataEmitter=class{constructor(e,t,r={}){var i,n,o;this.m_decodeInfo=e,this.m_styleSetEvaluator=t,this.m_options=r,this.m_meshBuffers=new Map,this.m_geometries=[],this.m_textGeometries=[],this.m_textPathGeometries=[],this.m_pathGeometries=[],this.m_poiGeometries=[],this.m_simpleLines=[],this.m_solidLines=[],this.m_sources=[],this.m_maxGeometryHeight=0,this.m_minGeometryHeight=0,this.m_options.gatherFeatureAttributes=null!==(i=r.gatherFeatureAttributes)&&void 0!==i&&i,this.m_options.skipShortLabels=null===(n=r.skipShortLabels)||void 0===n||n,this.m_options.enableElevationOverlay=null!==(o=r.enableElevationOverlay)&&void 0!==o&&o}get projection(){return this.m_decodeInfo.targetProjection}get center(){return this.m_decodeInfo.center}processPointFeature(e,t,r,o,s){var a;const l=o.env;this.processFeatureCommon(l);const{tileKey:u,columnCount:c,rowCount:h}=this.m_decodeInfo,d=u.column+1<c?t-1:t,f=u.row+1<h?t-1:t,p=r.filter((e=>e.x>=0&&e.x<=d&&e.y>=0&&e.y<=f));if(0!==p.length)for(const e of s){if(void 0===e)continue;const r=e._index,s=this.findOrCreateMeshBuffers(r,i.GeometryType.Point);if(void 0===s)continue;const{positions:u,texts:c,imageTextures:h,objInfos:d,offsetDirections:f}=s,g=i.isTextTechnique(e)||i.isPoiTechnique(e);let v;const y=i.isPoiTechnique(e);if(y){const t=e;if(v=n.evaluateTechniqueAttr(o,t.imageTexture),void 0!==t.poiName)v=n.evaluateTechniqueAttr(o,t.poiName);else if("string"==typeof t.poiNameField)v=l.lookup(t.poiNameField);else if("string"==typeof t.imageTextureField){const e=l.lookup(t.imageTextureField);v=i.composeTechniqueTextureName(e,t)}}const x=i.scaleHeight(o,e,this.m_decodeInfo.tileKey.level),_=i.getFeatureId(l.entries);for(const r of p){if(g){const t=e,r=i.getFeatureText(o,t,this.m_options.languages);void 0!==r&&r.length>0?c.push(s.addText(r)):c.push(-1)}g?m.webMercatorTile2TargetWorld(t,this.m_decodeInfo,r,S,x):m.webMercatorTile2TargetTile(t,this.m_decodeInfo,r,S,x),u.push(S.x,S.y,S.z),d.push(this.m_options.gatherFeatureAttributes?l.entries:_),f.push(null!==(a=l.lookup("offset_direction"))&&void 0!==a?a:0),y&&(void 0===v?h.push(-1):h.push(s.addText(v)))}}}processLineFeature(e,t,r,o,s){const a=o.env;this.processFeatureCommon(a);const l=[],u=[],h=[],f=[],g=this.m_decodeInfo.projectedBoundingBox;let y;const x=2*g.extents.x,_=2*g.extents.y,b=Math.max(x,_);let w,E;const P=void 0!==r[0].untiledPositions,A=!1;let L=!1,C=!1;for(const e of s)if(void 0!==e){if(w){const t=this.getTextureCoordinateType(e);d.assert(void 0===t||E===t)}else w=this.getComputeTexCoordsFunc(e),E=this.getTextureCoordinateType(e);L=L||i.isSpecialDashesLineTechnique(e),C=C||!L}for(const e of r){const r=[];let i=0;if(P&&(this.m_decodeInfo.targetProjection.projectPoint(e.untiledPositions[0],M),e.untiledPositions.forEach((e=>{this.m_decodeInfo.targetProjection.projectPoint(e,S),i+=S.distanceTo(M),M.copy(S),this.m_decodeInfo.targetProjection.projectPoint(e.normalized(),S),r.push(S.x,S.y,S.z,i)}))),L){y=[];let n=0;const o=e.positions.length;if(o>1){let s=0;for(let a=0;a<o-1;a++){const o=[],l=[],c=[],d=[],p=e.positions[a],g=e.positions[a+1];if(m.webMercatorTile2TargetWorld(t,this.m_decodeInfo,p,S,A),l.push(S.x,S.y,S.z),m.webMercatorTile2TargetWorld(t,this.m_decodeInfo,g,T,A),l.push(T.x,T.y,T.z),w&&(w(p,t).toArray(c,c.length),w(g,t).toArray(c,c.length)),P){let e=this.findRelativePositionInLine(S,r)/i;d.push(e),e=this.findRelativePositionInLine(T,r)/i,d.push(e)}else{d.push(s);const e=S.distanceTo(T);n+=e,s+=e,d.push(s)}S.sub(this.m_decodeInfo.center),o.push(S.x,S.y,S.z),T.sub(this.m_decodeInfo.center),o.push(T.x,T.y,T.z),y.push(o),u.push(l),h.push(c),f.push(d)}}if(!P&&n>0)for(const e of f)e.forEach(((t,r)=>{e[r]=t/n}))}if(C){const n=[],o=[],s=[],a=[];e.positions.forEach((e=>{if(m.webMercatorTile2TargetWorld(t,this.m_decodeInfo,e,S,A),o.push(S.x,S.y,S.z),w&&w(e,t).toArray(s,s.length),P){const e=this.findRelativePositionInLine(S,r)/i;a.push(e)}S.sub(this.m_decodeInfo.center),n.push(S.x,S.y,S.z)})),l.push(n),u.push(o),h.push(s),f.push(a)}}const O=this.m_decodeInfo.tileKey.level>=11;for(const e of s){if(void 0===e)continue;const t=e._index,r=e.name;if(i.isLineTechnique(e)||i.isSolidLineTechnique(e)){const r=i.isLineTechnique(e)?this.m_simpleLines:this.m_solidLines,n=i.isLineTechnique(e)?k.Simple:k.Complex;L&&(d.assert(void 0!==y,"OmvDecodedTileEmitter#processLineFeature: Internal error - No localLineSegments"),this.applyLineTechnique(r,e,t,n,a.entries,y,o,this.getTextureCoordinateType(e)?h:void 0,f)),l.length>0&&this.applyLineTechnique(r,e,t,n,a.entries,l,o,this.getTextureCoordinateType(e)?h:void 0,P?f:void 0)}else if(i.isTextTechnique(e)||i.isPoiTechnique(e)||i.isLineMarkerTechnique(e)){const r=e,s=i.getFeatureText(o,r,this.m_options.languages);if(void 0===s||0===s.length)continue;let l=[];if(this.m_options.skipShortLabels){const e=b/this.m_decodeInfo.tileSizeOnScreen,t=5*s.length*e*.5,r=t*t;l=this.splitJaggyLines(u,r,N)}else l=u;if(0===l.length)continue;if(i.isTextTechnique(e)){if(void 0===s)continue;for(const e of l){const r=d.Math2D.computeSquaredLineLength(e);this.m_textPathGeometries.push({technique:t,path:e,pathLengthSqr:r,text:String(s),objInfos:this.m_options.gatherFeatureAttributes?a.entries:i.getFeatureId(a.entries)})}}else{const r=e;let u=n.evaluateTechniqueAttr(o,r.imageTexture);"string"==typeof r.imageTextureField&&(u=a.lookup(r.imageTextureField),"string"==typeof r.imageTexturePrefix&&(u=r.imageTexturePrefix+u),"string"==typeof r.imageTexturePostfix&&(u+=r.imageTexturePostfix));for(const e of l)this.m_poiGeometries.push({technique:t,positions:{name:"position",type:"float",buffer:new Float64Array(e).buffer,itemCount:3},texts:[0],stringCatalog:[s,u],imageTextures:[1],objInfos:this.m_options.gatherFeatureAttributes?[a.entries]:[i.getFeatureId(a.entries)]})}}else if(i.isLabelRejectionLineTechnique(e))for(const e of u){const t=[];for(let r=0;r<e.length;r+=3)t.push((new p.Vector3).fromArray(e,r));this.m_pathGeometries.push({path:t})}else if(i.isExtrudedLineTechnique(e)){const r=this.findOrCreateMeshBuffers(t,i.GeometryType.ExtrudedLine);if(void 0===r)continue;const{positions:s,indices:u,groups:h,featureStarts:d,objInfos:f}=r,p=u.length,m=n.evaluateTechniqueAttr(o,e.lineWidth);if(void 0===m)continue;const g=n.evaluateTechniqueAttr(o,e.caps,"Circle"),v=O&&"Circle"===g;l.forEach((e=>{c.triangulateLine(e,m,s,u,v),d.push(p),f.push(this.m_options.gatherFeatureAttributes?a.entries:i.getFeatureId(a.entries))}));const y=u.length-p;h.push({start:p,count:y,technique:t})}else v.warn(`OmvDecodedTileEmitter#processLineFeature: Invalid line technique\n                     ${r} for layer: ${a.entries.$layer} `)}}processPolygonFeature(e,t,r,n,s){const a=n.env;this.processFeatureCommon(a);const u=!1;s.forEach((e=>{if(void 0===e)return;const s=e._index;if(void 0===s)throw new Error("OmvDecodedTileEmitter#processPolygonFeature: Internal error - No technique index");let c;const h=a.lookup("bbox");if(Array.isArray(h)){const[e,t,r,i]=h,n=new l.GeoBox(new l.GeoCoordinates(t,e),new l.GeoCoordinates(i,r));c=new p.Box3,l.webMercatorProjection.projectBox(n,c)}const d=[],f=i.isExtrudedPolygonTechnique(e),v=i.isFillTechnique(e),y=i.isStandardTechnique(e),x=f||v||y||i.isShaderTechnique(e)&&"mesh"===e.primitive,_=this.getComputeTexCoordsFunc(e,c),b=x&&!f;for(const e of r){const r=[];for(let i=0;i<e.rings.length;i++){const n=0===i;let s=e.rings[i];b&&s.some((e=>e.x<0||e.x>t||e.y<0||e.y>t))&&(s=o.clipPolygon(s,t));const a=p.ShapeUtils.area(s);if(n&&0===a)break;if(0!==a){let e;void 0!==_&&(e=s.map((e=>_(e,t)))),r.push(new g.Ring(s,e,t,b))}}r.length>0&&d.push(r)}const E=i.isSolidLineTechnique(e)||i.isLineTechnique(e);if(x)this.applyPolygonTechnique(d,e,s,n,t);else if(E){const r="line"===e.name?this.m_simpleLines:this.m_solidLines,o="line"===e.name?k.Simple:k.Complex,l=i.isSpecialDashesLineTechnique(e);d.forEach((i=>{const c=[],h=l?[]:void 0;i.forEach((e=>{const r=e.points.length;let i=[],n=0,o=0,s=l?[]:void 0;for(let a=0;a<r;++a){l&&i.length>0&&(i=[],s=[]);const d=(a+1)%r,f=e.points[a],p=e.points[d],g=e.isProperEdge(a);if(g||0===i.length){if(g&&0===i.length&&(m.webMercatorTile2TargetTile(t,this.m_decodeInfo,w.copy(f),S,u),i.push(S.x,S.y,S.z),l)){m.webMercatorTile2TargetTile(t,this.m_decodeInfo,w.copy(p),T,u),i.push(T.x,T.y,T.z),s.push(o);const e=S.distanceTo(T);n+=e,o+=e,s.push(o)}}else c.push(i),i=[];g&&!l&&(m.webMercatorTile2TargetTile(t,this.m_decodeInfo,w.copy(p),S,u),i.push(S.x,S.y,S.z)),l&&i.length>0&&n>0&&(s.forEach(((e,t)=>{s[t]=e/n})),c.push(i),h.push(s))}!l&&i.length>0&&c.push(i)})),0!==c.length&&this.applyLineTechnique(r,e,s,o,a.entries,c,n,void 0,h)}))}}))}getDecodedTile(){this.createGeometries(),this.processSimpleLines(this.m_simpleLines),this.processLines(this.m_solidLines);const e={techniques:this.m_styleSetEvaluator.decodedTechniques,geometries:this.m_geometries,decodeTime:void 0};return this.m_textGeometries.length>0&&(e.textGeometries=this.m_textGeometries),this.m_poiGeometries.length>0&&(e.poiGeometries=this.m_poiGeometries),this.m_textPathGeometries.length>0&&(e.textPathGeometries=this.m_textPathGeometries),this.m_pathGeometries.length>0&&(e.pathGeometries=this.m_pathGeometries),0!==this.m_sources.length&&(e.copyrightHolderIds=this.m_sources),e.maxGeometryHeight=this.m_maxGeometryHeight,e.minGeometryHeight=this.m_minGeometryHeight,e}splitJaggyLines(e,t,r){const i=[],n=(e,t,r)=>{let i=Number.MAX_SAFE_INTEGER,n=Number.MIN_SAFE_INTEGER,o=Number.MAX_SAFE_INTEGER,s=Number.MIN_SAFE_INTEGER;for(let a=t;a<r;a+=3){const t=e[a],r=e[a+1];t<i&&(i=t),t>n&&(n=t),r<o&&(o=r),r>s&&(s=r)}return(n-i)*(n-i)+(s-o)*(s-o)},o=e.slice();for(;o.length>0;){const e=o.pop();if(void 0===e||e.length<6)continue;let s=-1;for(let t=0;t<e.length-3;t+=3){P.set(e[t],e[t+1]),A.set(e[t+3],e[t+4]);const i=A.sub(P).normalize();if(t>0){const e=Math.atan2(L.x*i.y-i.x*L.y,i.dot(L));if(Math.abs(e)>r){s=t;break}}L.set(i.x,i.y)}if(s>0){const r=n(e,0,s+3),a=n(e,s,e.length);r>t&&i.push(e.slice(0,s+3)),a>t&&o.push(e.slice(s))}else n(e,0,e.length)>t&&i.push(e)}return i}getTextureCoordinateType(e){return(i.isFillTechnique(e)||i.isSolidLineTechnique(e)||i.isExtrudedPolygonTechnique(e))&&this.m_options.enableElevationOverlay?i.TextureCoordinateType.TileSpace:i.textureCoordinateType(e)}getComputeTexCoordsFunc(e,t){switch(this.getTextureCoordinateType(e)){case i.TextureCoordinateType.TileSpace:return(e,t)=>{const r=e.clone().divideScalar(t);return r.y=1-r.y,r};case i.TextureCoordinateType.EquirectangularSpace:return(e,t)=>{const r=m.tile2world(t,this.m_decodeInfo,e,!1,M),i=l.normalizedEquirectangularProjection.reprojectPoint(l.webMercatorProjection,r);return new p.Vector2(i.x,i.y)};case i.TextureCoordinateType.FeatureSpace:if(!t)return;return(e,r)=>{const i=m.tile2world(r,this.m_decodeInfo,e,!1,M),n=new p.Vector2(i.x,i.y);return t&&(n.x-=t.min.x,n.y-=t.min.y,n.x/=t.max.x-t.min.x,n.y/=t.max.y-t.min.y),n.y=1-n.y,n};default:return}}applyLineTechnique(e,t,r,n=k.Complex,o,s,a,l,c){let h;const d=e.find((e=>e.technique===r)),f=void 0!==l;if(void 0===d){h=new u.LineGroup(f,void 0,n===k.Simple);const t={type:n===k.Complex?i.GeometryType.SolidLine:i.GeometryType.Line,technique:r,lines:h};this.m_options.gatherFeatureAttributes&&(t.objInfos=[o],t.featureStarts=[0]),e.push(t)}else h=d.lines,this.m_options.gatherFeatureAttributes&&d.objInfos&&d.featureStarts&&(d.objInfos.push(o),d.featureStarts.push(h.indices.length));let p=0;s.forEach((e=>{h.add(this.m_decodeInfo.center,e,this.projection,c?c[p]:void 0,l?l[p]:void 0),p++}))}applyPolygonTechnique(e,t,r,o,u){var c,g;if(0===e.length)return;const T=i.isExtrudedPolygonTechnique(t),P=T?i.GeometryType.ExtrudedPolygon:i.GeometryType.Polygon,A=this.findOrCreateMeshBuffers(r,P);if(void 0===A)return;const L=t,C=t,O=!0===L.boundaryWalls,R=i.isFillTechnique(t),D=this.getTextureCoordinateType(t);let I=n.evaluateTechniqueAttr(o,L.height),F=n.evaluateTechniqueAttr(o,L.floorHeight);if(void 0===I){const e=o.env.lookup("height"),t=n.evaluateTechniqueAttr(o,L.defaultHeight);I=void 0!==e?e:void 0!==t?t:0}if(void 0===F){const e=o.env.lookup("min_height");F=void 0===e||R?0:e}I=Math.max(F+h.ExtrusionFeatureDefs.MIN_BUILDING_HEIGHT,I);const N=this.m_decodeInfo.tileKey.level,j=T&&i.scaleHeight(o,L,N);this.m_decodeInfo.tileBounds.getCenter(y);const{positions:k,normals:V,textureCoordinates:G,colors:q,extrusionAxis:B,indices:W,edgeIndices:H,groups:$}=A,K=this.m_decodeInfo.targetProjection.type===l.ProjectionType.Spherical,X=T?null!==(c=L.lineWidth)&&void 0!==c?c:0:R&&null!==(g=C.lineWidth)&&void 0!==g?g:0,Y="number"!=typeof X||X>0;let Z;if(i.isExtrudedPolygonTechnique(t)&&d.getOptionValue(t.vertexColors,!1)){let e=n.evaluateTechniqueAttr(o,t.color);if(void 0===e){const t=o.env.lookup("color");this.isColorStringValid(t)&&(e=String(t))}void 0===e&&(e=n.evaluateTechniqueAttr(o,t.defaultColor,0)),void 0===e&&(e=0),z.set(e),Z=z}for(const t of e){const e=W.length,i=H.length,n=[],c=k.length/3,h=t[0],d=h.vertexStride,g=d+2;for(let e=0;e<h.points.length;++e){const t=h.points[e];n.push(t.x,-t.y),void 0!==h.textureCoords&&n.push(h.textureCoords[e].x,h.textureCoords[e].y);const r=(e+1)%h.points.length,i=h.isProperEdge(e);n.push(i?r:-1,O||i?r:-1)}const y=[];let P=1;for(;P<t.length;){const e=n.length/g;y.push(e);const r=t[P++];for(let t=0;t<r.points.length;++t){const i=(t+1)%r.points.length,o=r.points[t];n.push(o.x,-o.y),void 0!==r.textureCoords&&n.push(r.textureCoords[t].x,r.textureCoords[t].y);const s=r.isProperEdge(t);n.push(s?e+i:-1,O||s?e+i:-1)}}try{const e=f.default(n,y,g),t=n.length/g;if(K){const t=new p.BufferGeometry,r=[],i=[],o=[],c=[];for(let e=0;e<n.length;e+=g){const t=m.tile2world(u,this.m_decodeInfo,w.set(n[e],n[e+1]),!0,M);r.push(t.x,t.y,0),void 0!==D&&i.push(n[e+2],n[e+3]),o.push(n[e+d]),c.push(n[e+d+1])}const h=new p.BufferAttribute(new Float32Array(r),3);let f;t.setAttribute("position",h),void 0!==D&&(f=new p.BufferAttribute(new Float32Array(i),2),t.setAttribute("uv",f));const v=new p.BufferAttribute(new Float32Array(o),1);t.setAttribute("edge",v);const y=new p.BufferAttribute(new Float32Array(c),1);t.setAttribute("wall",v);const x=U(e,h.count-1),_="uint32"===x.type?new p.Uint32BufferAttribute(x.buffer,1):new p.Uint16BufferAttribute(x.buffer,1);t.setIndex(_);const b=this.m_decodeInfo.tileKey.level;if(b>=3&&b<9){const e=Math.pow(2,9-b),{geoBox:r}=this.m_decodeInfo;new s.EdgeLengthGeometrySubdivisionModifier(e,r,s.SubdivisionMode.NoDiagonals,l.webMercatorProjection).modify(t)}new a.SphericalGeometrySubdivisionModifier(p.MathUtils.degToRad(10),l.webMercatorProjection).modify(t),n.length=0,e.length=0;for(let e=0;e<h.array.length;e+=3){const t=m.world2tile(u,this.m_decodeInfo,S.set(h.array[e],h.array[e+1],0),!0,E);n.push(t.x,t.y),void 0!==D&&(n.push(f.array[e/3*2]),n.push(f.array[e/3*2+1])),n.push(v.array[e/3]),n.push(y.array[e/3])}const T=t.getIndex();null!==T&&e.push(...T.array)}x.set(0,0,1);for(let e=0;e<n.length;e+=g){m.webMercatorTile2TargetWorld(u,this.m_decodeInfo,w.set(n[e],n[e+1]),S,!1,!0);const t=j?this.m_decodeInfo.targetProjection.getScaleFactor(S):1;this.m_maxGeometryHeight=Math.max(this.m_maxGeometryHeight,t*I),this.m_minGeometryHeight=Math.min(this.m_minGeometryHeight,t*I),K&&x.set(S.x,S.y,S.z).normalize(),S.sub(this.center),_.copy(x).multiplyScalar(F*t),k.push(S.x+_.x,S.y+_.y,S.z+_.z),void 0!==D&&G.push(n[e+2],n[e+3]),this.m_options.enableElevationOverlay&&V.push(...x.toArray()),T&&(b.copy(x).multiplyScalar(I*t),k.push(S.x+b.x,S.y+b.y,S.z+b.z),B.push(0,0,0,0,b.x-_.x,b.y-_.y,b.z-_.z,1),void 0!==D&&G.push(n[e+2],n[e+3]),this.m_options.enableElevationOverlay&&V.push(...x.toArray()),void 0!==Z&&q.push(Z.r,Z.g,Z.b,Z.r,Z.g,Z.b))}for(let t=0;t<e.length;t+=3)if(T){const r=c+2*e[t+0]+1,i=c+2*e[t+1]+1,n=c+2*e[t+2]+1;W.push(r,i,n)}else{const r=c+e[t+0],i=c+e[t+1],n=c+e[t+2];W.push(r,i,n)}Y&&this.addEdges(c,t,g,d,k,n,H,T,L.footprint,L.maxSlope),T&&this.addWalls(c,t,g,d,n,W)}catch(e){v.error("cannot triangulate geometry",e)}this.m_options.gatherFeatureAttributes&&(A.objInfos.push(o.env.entries),A.featureStarts.push(e),A.edgeFeatureStarts.push(i));const C=W.length-e;C>0&&$.push({start:e,count:C,technique:r})}}createGeometries(){this.m_meshBuffers.forEach(((e,t)=>{if(0===e.positions.length)return;if(!this.m_styleSetEvaluator.techniques||this.m_styleSetEvaluator.techniques.length<=t)throw new Error("Invalid technique index");const r=this.m_styleSetEvaluator.techniques[t];if(void 0===r)return;if(e.texts.length>0){const n={positions:{name:"position",type:"float",buffer:new Float64Array(e.positions).buffer,itemCount:3},texts:e.texts,technique:t,stringCatalog:e.stringCatalog,objInfos:e.objInfos};if(i.isTextTechnique(r))this.m_textGeometries.push(n);else{d.assert(i.isPoiTechnique(r));const t=n;t.imageTextures=e.imageTextures,t.offsetDirections=e.offsetDirections,this.m_poiGeometries.push(t)}return}const n=new Float32Array(e.positions);0===e.groups.length&&e.groups.push({start:0,count:n.length/3,technique:t});const o=[{name:"position",buffer:n.buffer,itemCount:3,type:"float"}],s={type:e.type,vertexAttributes:o,groups:e.groups};if(e.normals.length>0){const t=new Float32Array(e.normals);d.assert(t.length===n.length,"length of normals buffer is different than the length of the position buffer"),o.push({name:"normal",buffer:t.buffer,itemCount:3,type:"float"})}if(e.colors.length>0){const t=new Float32Array(e.colors);d.assert(t.length===n.length,"length of colors buffer is different than the length of the position buffer"),o.push({name:"color",buffer:t.buffer,itemCount:3,type:"float"})}const a=e.positions.length/3;if(e.textureCoordinates.length>0){const t=e.textureCoordinates.length/2;d.assert(t===a,"length of textureCoordinates buffer is different than the length of theposition buffer");const r=new Float32Array(e.textureCoordinates);o.push({name:"uv",buffer:r.buffer,itemCount:2,type:"float"})}if(e.extrusionAxis.length>0){const t=new Float32Array(e.extrusionAxis);d.assert(t.length/4==n.length/3,"length of extrusionAxis buffer is different than the length of the position buffer"),o.push({name:"extrusionAxis",buffer:t.buffer,itemCount:4,type:"float"})}e.indices.length>0&&(s.index=U(e.indices,a-1)),e.edgeIndices.length>0&&(s.edgeIndex=U(e.edgeIndices,a-1,"edgeIndex")),s.featureStarts=e.featureStarts,s.edgeFeatureStarts=e.edgeFeatureStarts,s.objInfos=e.objInfos,this.m_geometries.push(s)}))}processLines(e){e.forEach((e=>{const{vertices:t,indices:r}=e.lines,n=e.technique,o=new Float32Array(t).buffer,s=U(r,t.length/e.lines.stride-1),a={type:"float",stride:e.lines.stride,buffer:o,attributes:e.lines.vertexAttributes},l={type:i.GeometryType.SolidLine,index:s,interleavedVertexAttributes:[a],groups:[{start:0,count:r.length,technique:n}],vertexAttributes:[],featureStarts:e.featureStarts,objInfos:e.objInfos};this.m_geometries.push(l)}))}processSimpleLines(e){e.forEach((e=>{const{vertices:t,indices:r}=e.lines,n=e.technique,o={buffer:new Float32Array(t).buffer,itemCount:3,type:"float",name:"position"},s={type:i.GeometryType.Line,index:U(r,t.length/o.itemCount-1),vertexAttributes:[o],groups:[{start:0,count:r.length,technique:n}],featureStarts:e.featureStarts,objInfos:e.objInfos};this.m_geometries.push(s)}))}findOrCreateMeshBuffers(e,t){let r=this.m_meshBuffers.get(e);return void 0!==r?r.type!==t?void v.error(`MeshBuffer has been created with wrong type "${i.GeometryType[t]}"\n                instead of "${i.GeometryType[r.type]}"`):r:(r=new j(t),this.m_meshBuffers.set(e,r),r)}processFeatureCommon(e){const t=e.lookup("source");"string"==typeof t&&""!==t&&(this.m_sources.includes(t)||this.m_sources.push(t))}isColorStringValid(e){return"string"==typeof e&&e.length>0}addEdges(e,t,r,i,n,o,s,a,l,u){const c=new p.Vector3,h=new p.Vector3;let d,f,m=0,g=0;for(;m<t;){for(;m!==d;){void 0===d&&(d=m),m<t&&(g=Math.max(g,m));const p=o[m*r+i];if(p<0)break;if(a)if(!0===l&&s.push(e+2*m,e+2*p),s.push(e+2*m+1,e+2*p+1),void 0!==u){if(void 0!==f){const t=3*(e+2*f),r=3*(e+2*m),i=3*(e+2*p);c.set(n[r]-n[t],n[r+1]-n[t+1],n[r+2]-n[t+2]).normalize(),h.set(n[i]-n[r],n[i+1]-n[r+1],n[i+2]-n[r+2]).normalize(),c.dot(h)<=u&&s.push(e+2*m,e+2*m+1)}}else s.push(e+2*m,e+2*m+1);else s.push(e+m,e+p);f=m,m=p}m=g+1,d=void 0,f=void 0}}addWalls(e,t,r,i,n,o){let s,a=0,l=0;for(;a<t;){for(;a!==s;){void 0===s&&(s=a),a<t&&(l=Math.max(l,a));const u=n[a*r+i+1];if(u<0)break;o.push(e+2*a,e+2*a+1,e+2*u+1,e+2*u+1,e+2*u,e+2*a),a=u}a=l+1,s=void 0}}findRelativePositionInLine(e,t){let r=1/0,i=0;for(let n=0;n<t.length;n+=4){F.set(C.set(t[n],t[n+1],t[n+2]),O.set(t[n+4],t[n+5],t[n+6])),F.closestPointToPoint(e,!0,R);const o=R.distanceTo(e);o<r&&(D.copy(R),I.copy(C),r=o,i=t[n+3])}return i+D.distanceTo(I)}}},976:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.VectorTileDecoderService=t.VectorTileDecoder=t.VectorTileDataProcessor=void 0;const i=r(3187),n=r(5263),o=r(2851),s=r(3333),a=r(1191),l=r(5021),u=r(3070),c=r(7707),h=r(1173),d=r(8640),f=s.LoggerManager.instance.create("VectorTileDecoder",{enabled:!1});class p{constructor(e,t,r,i,n={},o){var s,a;this.m_tileKey=e,this.m_projection=t,this.m_styleSetEvaluator=r,this.m_dataAdapter=i,this.m_options=n,this.m_dataFilter=o,n.storageLevelOffset=null!==(s=n.storageLevelOffset)&&void 0!==s?s:0,n.showMissingTechniques=null!==(a=n.showMissingTechniques)&&void 0!==a&&a}getDecodedTile(e){this.m_styleSetEvaluator.resetTechniques();const t=new c.DecodeInfo(this.m_projection,this.m_tileKey,this.m_options.storageLevelOffset);return this.m_decodedTileEmitter=new d.VectorTileDataEmitter(t,this.m_styleSetEvaluator,this.m_options),this.m_dataAdapter.process(e,t,this),this.m_decodedTileEmitter.getDecodedTile()}processPointFeature(e,t,r,n,o){s.assert(void 0!==this.m_decodedTileEmitter),this.processFeature(e,t,r,"point",n,o,this.m_decodedTileEmitter.processPointFeature,i.GeometryKind.Label)}processLineFeature(e,t,r,n,o){s.assert(void 0!==this.m_decodedTileEmitter),this.processFeature(e,t,r,"line",n,o,this.m_decodedTileEmitter.processLineFeature,i.GeometryKind.Line)}processPolygonFeature(e,t,r,n,o){s.assert(void 0!==this.m_decodedTileEmitter),this.processFeature(e,t,r,"polygon",n,o,this.m_decodedTileEmitter.processPolygonFeature,i.GeometryKind.Area)}processFeature(e,t,r,i,n,o,s,a){const l=this.createMapEnv(n,o,e,i),u=this.applyKindFilter(this.m_styleSetEvaluator.getMatchingTechniques(l,e,i),a);if(0===u.length)return void(this.m_options.showMissingTechniques&&f.log("VectorTileDataProcessor#processFeature: no techniques for object:",JSON.stringify(l.unmap())));const c={env:l,cachedExprResults:new Map};this.m_decodedTileEmitter&&s.apply(this.m_decodedTileEmitter,[e,t,r,c,u])}createMapEnv(e,t,r,i){const o=this.m_tileKey.level;return new n.MapEnv(Object.assign({$layer:r,$id:null!=t?t:null,$level:o,$zoom:Math.max(0,o-this.m_options.storageLevelOffset),$geometryType:i},e))}applyKindFilter(e,t){return void 0!==this.m_dataFilter&&this.m_dataFilter.hasKindFilter&&(e=e.filter((e=>{const r=void 0===e.kind?t:e.kind;return this.m_dataFilter.wantsKind(r)}))),e}}t.VectorTileDataProcessor=p;class m extends o.ThemedTileDecoder{constructor(){super(),this.m_roundUpCoordinatesIfNeeded=!1,this.m_options={map:{},changed:!1},this.m_defaultDataAdapters=[],this.m_defaultDataAdapters.push(new u.OmvDataAdapter,new l.GeoJsonVtDataAdapter,new a.GeoJsonDataAdapter)}connect(){return Promise.resolve()}decodeThemedTile(e,t,r,i){const n=s.PerformanceTimer.now();if(!this.m_dataAdapter&&(this.m_dataAdapter=this.getDataAdapter(e),!this.m_dataAdapter))return Promise.reject(new Error("Unsupported data format."));const o=this.m_dataAdapter;if(s.assert(o.canProcess(e)),this.m_options.changed){if(o instanceof u.OmvDataAdapter){const e=this.m_options.map;o.configure(e,r),this.m_featureFilter=o.dataFilter}this.m_options.changed=!1}const a=new p(t,i,r,o,this.m_options.map,this.m_featureFilter).getDecodedTile(e);return a.decodeTime=s.PerformanceTimer.now()-n,Promise.resolve(a)}configure(e,t){super.configure(e,t),this.m_options.map=Object.assign(Object.assign(Object.assign({},this.m_options.map),e),t),this.m_options.changed=!0}getDataAdapter(e){for(const t of this.m_defaultDataAdapters)if(t.canProcess(e))return t}}t.VectorTileDecoder=m,t.VectorTileDecoderService=class{static start(){o.WorkerServiceManager.getInstance().register({serviceType:h.VECTOR_TILE_DECODER_SERVICE_TYPE,factory:e=>o.TileDecoderService.start(e,new m)})}}},5021:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GeoJsonVtDataAdapter=void 0;const i=r(3139),n=r(4428),o=r(8544),s=4096;var a;!function(e){e[e.Unknown=0]="Unknown",e[e.Point=1]="Point",e[e.LineString=2]="LineString",e[e.Polygon=3]="Polygon"}(a||(a={}));const l=new n.Vector3;t.GeoJsonVtDataAdapter=class{canProcess(e){if(o.isArrayBufferLike(e))return!1;const t=e;return void 0!==t.features&&void 0!==t.source&&void 0!==t.x&&void 0!==t.y&&void 0!==t.z}process(e,t,r){for(const u of e.features)switch(u.type){case a.Point:for(const t of u.geometry){const i=t[0],o=t[1],a=new n.Vector3(i,o,0);r.processPointFeature(e.layer,s,[a],u.tags,u.id)}break;case a.LineString:{const a=u.geometry;let c;const h=[];a.forEach((e=>{const t=null==c?void 0:c.positions[c.positions.length-1],[r,i]=e[0];if((null==t?void 0:t.x)===r&&(null==t?void 0:t.y)===i)for(let t=1;t<e.length;++t){const[r,i]=e[t];null==c||c.positions.push(new n.Vector2(r,i))}else{const t=e.map((([e,t])=>new n.Vector2(e,t)));h.push({positions:t}),c=h[h.length-1]}})),h.forEach((e=>{e.untiledPositions=e.positions.map((e=>(o.tile2world(s,t,e,!1,l),i.webMercatorProjection.unprojectPoint(l))))})),r.processLineFeature(e.layer,s,h,u.tags,u.id);break}case a.Polygon:{const t=[];let i;for(const e of u.geometry){const r=[];for(const[t,i]of e){const e=new n.Vector2(t,i);r.push(e)}n.ShapeUtils.area(r)>0&&(i={rings:[]},t.push(i)),null==i||i.rings.push(r)}r.processPolygonFeature(e.layer,s,t,u.tags,u.id);break}case a.Unknown:}}}},1191:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GeoJsonDataAdapter=void 0;const i=r(6290),n=r(3139),o=r(4428),s=r(8544),a=4096,l=new o.Vector3;function u(e,t,r){return n.webMercatorProjection.projectPoint(n.GeoCoordinates.fromGeoPoint(e),l),s.world2tile(a,t,l,!1,r)}function c(e,t){return{untiledPositions:e.map((e=>n.GeoCoordinates.fromGeoPoint(e))),positions:e.map((e=>u(e,t,new o.Vector2)))}}function h(e,t){return"LineString"===e.type?[c(e.coordinates,t)]:e.coordinates.map((e=>c(e,t)))}function d(e,t){return{rings:e.map(((e,r)=>{const i=0===r,{positions:n}=c(e,t),s=o.ShapeUtils.area(n)>0;return(i&&!s||!i&&s)&&n.reverse(),n}))}}function f(e,t){return"Polygon"===e.type?[d(e.coordinates,t)]:e.coordinates.map((e=>d(e,t)))}function p(e,t){return"Point"===e.type?[u(e.coordinates,t,new o.Vector3)]:e.coordinates.map((e=>u(e,t,new o.Vector3)))}t.GeoJsonDataAdapter=class{canProcess(e){return e&&"FeatureCollection"===e.type&&Array.isArray(e.features)}process(e,t,r){if(!Array.isArray(e.features)||0===e.features.length)return;const n="geojson";for(const o of e.features)switch(o.geometry.type){case"LineString":case"MultiLineString":{let e=h(o.geometry,t);const s=[],l=100;e.forEach((e=>{i.clipLineString(e.positions,-l,-l,a+l,a+l).forEach((e=>{s.push({positions:e})}))})),e=s,e.length>0&&r.processLineFeature(n,a,s,o.properties,o.id);break}case"Polygon":case"MultiPolygon":{const e=f(o.geometry,t);r.processPolygonFeature(n,a,e,o.properties,o.id);break}case"Point":case"MultiPoint":{const e=p(o.geometry,t);r.processPointFeature(n,a,e,o.properties,o.id);break}}}}},5202:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GeometryCommands=t.FeatureAttributes=t.visitOmvLayer=t.visitOmv=t.isClosePathCommand=t.isLineToCommand=t.isMoveToCommand=t.CommandKind=void 0;const i=r(4428),n=r(4417);var o;function s(e,t){if((!t.visitLayer||t.visitLayer(e))&&e.features)for(const r of e.features)switch(r.type){case n.com.mapbox.pb.Tile.GeomType.UNKNOWN:break;case n.com.mapbox.pb.Tile.GeomType.POINT:t.visitPointFeature&&t.visitPointFeature(r);break;case n.com.mapbox.pb.Tile.GeomType.LINESTRING:t.visitLineFeature&&t.visitLineFeature(r);break;case n.com.mapbox.pb.Tile.GeomType.POLYGON:t.visitPolygonFeature&&t.visitPolygonFeature(r)}t.endVisitLayer&&t.endVisitLayer(e)}!function(e){e[e.MoveTo=1]="MoveTo",e[e.LineTo=2]="LineTo",e[e.ClosePath=7]="ClosePath"}(o=t.CommandKind||(t.CommandKind={})),t.isMoveToCommand=function(e){return e.kind===o.MoveTo},t.isLineToCommand=function(e){return e.kind===o.LineTo},t.isClosePathCommand=function(e){return e.kind===o.ClosePath},t.visitOmv=function(e,t){if(e.layers)for(const r of e.layers)t.visitLayer&&!t.visitLayer(r)||s(r,t),t.endVisitLayer&&t.endVisitLayer(r)},t.visitOmvLayer=s,t.FeatureAttributes=class{accept(e,t,r){const{keys:i,values:n}=e,o=t.tags;if(o&&i&&n)for(let e=0;e<o.length;e+=2){const t=i[o[e]],s=n[o[e+1]];if(!r.visitAttribute(t,s))break}}},t.GeometryCommands=class{accept(e,t){if(!e)return;const r=e.length;let n=0,s=0;const a=[],l=[],u=[];for(let c=0;c<r;){const r=7&e[c],h=e[c]>>3;if(++c,r===o.MoveTo||r===o.LineTo)for(let o=0;o<h;++o){const o=e[c++],h=e[c++];n+=o>>1^-(1&o),s+=h>>1^-(1&h),"Polygon"===t.type&&(a.push(n),l.push(s));const d=new i.Vector2(n,s);u.push({kind:r,position:d})}else{for(const e of u)t.visitCommand(e);t.visitCommand({kind:r}),a.length=0,l.length=0,u.length=0}}if(u.length>0)for(const e of u)t.visitCommand(e)}}},3070:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OmvDataAdapter=t.asGeometryType=void 0;const i=r(5263),n=r(3333),o=r(7808),s=r(4428),a=r(1047),l=r(1173),u=r(1834),c=r(8544),h=r(4312),d=r(5202),f=r(4417),p=["stringValue","floatValue","doubleValue","intValue","uintValue","sintValue","boolValue"],m=n.LoggerManager.instance.create("OmvDataAdapter",{enabled:!1});function g(e,t,r){if(void 0!==t.id&&null!==t.id)return t.id;if(e.hasOwnProperty("id")){const t=e.id;if("number"==typeof t)return t;if(t)return void 0!==r&&t.greaterThan(Number.MAX_SAFE_INTEGER)&&r.error("Invalid ID: Larger than largest available Number in feature: ",e),t.toNumber()}}function v(e){if(void 0===e)return l.OmvGeometryType.UNKNOWN;switch(e.type){case f.com.mapbox.pb.Tile.GeomType.UNKNOWN:return l.OmvGeometryType.UNKNOWN;case f.com.mapbox.pb.Tile.GeomType.POINT:return l.OmvGeometryType.POINT;case f.com.mapbox.pb.Tile.GeomType.LINESTRING:return l.OmvGeometryType.LINESTRING;case f.com.mapbox.pb.Tile.GeomType.POLYGON:return l.OmvGeometryType.POLYGON;default:return l.OmvGeometryType.UNKNOWN}}function y(e,t){e.forEach((e=>{e.x===t-1&&(e.x=t)}))}function x(e,t){switch(t){case l.FeatureModifierId.default:return new a.OmvGenericFeatureModifier(e);default:return n.assert(!1),new a.OmvGenericFeatureModifier(e)}}t.asGeometryType=v,t.OmvDataAdapter=class{constructor(){this.m_geometryCommands=new d.GeometryCommands,this.m_roundUpCoordinatesIfNeeded=!1}get dataFilter(){return this.m_dataFilter}configure(e,t){var r;if(void 0!==e.filterDescription){if(null!==e.filterDescription){const t=e.filterDescription,r=e.featureModifiers;this.m_dataFilter=new a.OmvGenericFeatureFilter(t);const i=[];void 0!==r?r.forEach((e=>{i.push(x(t,e))})):i.push(x(t,l.FeatureModifierId.default)),this.m_featureModifiers=i}else this.m_dataFilter=void 0,this.m_featureModifiers=void 0;const r=new h.StyleSetDataFilter(t);this.m_dataFilter=this.m_dataFilter?new a.ComposedDataFilter([r,this.m_dataFilter]):r}if(void 0!==e.politicalView){const t=e.politicalView;let r=this.m_featureModifiers;if(r&&(r=r.filter((e=>!(e instanceof u.OmvPoliticalViewFeatureModifier)))),0!==t.length){n.assert(2===t.length,"The political view must be specified as two letters ISO 3166-1 standard!");const e=new u.OmvPoliticalViewFeatureModifier(t);r?r.push(e):r=[e]}this.m_featureModifiers=r&&r.length>0?r:void 0}this.m_roundUpCoordinatesIfNeeded=null!==(r=e.roundUpCoordinatesIfNeeded)&&void 0!==r&&r}canProcess(e){return c.isArrayBufferLike(e)}process(e,t,r){const{tileKey:i}=t,n=new Uint8Array(e),o=f.com.mapbox.pb.Tile.decode(n);this.m_tileKey=i,this.m_processor=r,d.visitOmv(o,this)}visitLayer(e){this.m_layer=e;const t=this.m_tileKey.level,r=e.name;return!(void 0!==this.m_dataFilter&&!this.m_dataFilter.wantsLayer(r,t))}visitPointFeature(e){var t,r,i;if(void 0===e.geometry)return;const n=null===(t=this.m_featureModifiers)||void 0===t?void 0:t[0].doProcessPointFeature,o=this.filterAndModifyFeature(e,null===(r=this.m_dataFilter)||void 0===r?void 0:r.wantsPointFeature,n);if(!o)return;const a=this.m_layer.name,l=null!==(i=this.m_layer.extent)&&void 0!==i?i:4096,u=[];this.m_geometryCommands.accept(e.geometry,{type:"Point",visitCommand:e=>{d.isMoveToCommand(e)&&u.push(new s.Vector3(e.position.x,e.position.y,0))}}),0!==u.length&&this.m_processor.processPointFeature(a,l,u,o,g(e,o,m))}visitLineFeature(e){var t,r,i;if(void 0===e.geometry)return;const n=null===(t=this.m_featureModifiers)||void 0===t?void 0:t[0].doProcessLineFeature,o=this.filterAndModifyFeature(e,null===(r=this.m_dataFilter)||void 0===r?void 0:r.wantsLineFeature,n);if(!o)return;const s=this.m_layer.name,a=null!==(i=this.m_layer.extent)&&void 0!==i?i:4096,l=[];let u;this.m_geometryCommands.accept(e.geometry,{type:"Line",visitCommand:e=>{d.isMoveToCommand(e)?(u=[e.position],l.push({positions:u})):d.isLineToCommand(e)&&u.push(e.position)}}),0!==l.length&&(this.mustRoundUpCoordinates&&function(e,t){e.forEach((e=>y(e.positions,t)))}(l,a),this.m_processor.processLineFeature(s,a,l,o,g(e,o,m)))}visitPolygonFeature(e){var t,r,i;if(void 0===e.geometry)return;const n=null===(t=this.m_featureModifiers)||void 0===t?void 0:t[0].doProcessPolygonFeature,o=this.filterAndModifyFeature(e,null===(r=this.m_dataFilter)||void 0===r?void 0:r.wantsPolygonFeature,n);if(!o)return;const a=this.m_layer.name,l=null!==(i=this.m_layer.extent)&&void 0!==i?i:4096,u=[];let c,h,f;this.m_geometryCommands.accept(e.geometry,{type:"Polygon",visitCommand:e=>{if(d.isMoveToCommand(e))h=[e.position];else if(d.isLineToCommand(e))h.push(e.position);else if(d.isClosePathCommand(e)&&void 0!==h&&h.length>0){const e=Math.sign(s.ShapeUtils.area(h));void 0===f&&(f=e),e===f&&(c={rings:[]},u.push(c)),h.push(h[0].clone()),null==c||c.rings.push(h)}}}),0!==u.length&&(this.mustRoundUpCoordinates&&function(e,t){e.forEach((e=>e.rings.forEach((e=>y(e,t)))))}(u,l),function(e){const t=e[0];if(void 0!==t&&0!==t.rings.length&&!(s.ShapeUtils.area(t.rings[0])>0))for(const t of e)for(const e of t.rings)e.reverse()}(u),this.m_processor.processPolygonFeature(a,l,u,o,g(e,o,m)))}filterAndModifyFeature(e,t,r){var s;const a=this.m_tileKey.level,l=this.m_layer.name,u=v(e);if(this.m_dataFilter&&!1===t.apply(this.m_dataFilter,[l,u,a]))return;const c=function(e,t){const r=new d.FeatureAttributes,i={};return r.accept(e,t,{visitAttribute:(e,t)=>(i[e]=function(e){const t=Object.prototype.hasOwnProperty;for(const r of p)if(t.call(e,r)){const t=e[r];if(void 0===t)throw new Error("unpexted undefined value");return o.isLong(t)?t.toNumber():t}throw new Error("not happening")}(t),!0)}),i}(this.m_layer,e),h=new i.MapEnv(c);return void 0===(null===(s=this.m_featureModifiers)||void 0===s?void 0:s.find((e=>(n.assert(void 0!==r),!r.apply(e,[l,h,this.m_tileKey.level])))))?c:void 0}get mustRoundUpCoordinates(){return this.m_roundUpCoordinatesIfNeeded&&this.m_tileKey.level<5&&this.m_tileKey.column===this.m_tileKey.columnCount()-1}}},4428:e=>{"use strict";e.exports=THREE}},__webpack_module_cache__={};function __webpack_require__(e){if(__webpack_module_cache__[e])return __webpack_module_cache__[e].exports;var t=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e].call(t.exports,t,t.exports,__webpack_require__),t.exports}__webpack_require__.d=(e,t)=>{for(var r in t)__webpack_require__.o(t,r)&&!__webpack_require__.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},__webpack_require__.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),__webpack_require__.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),__webpack_require__.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},__webpack_require__(8611)})();
//# sourceMappingURL=decoder.bundle.js.map